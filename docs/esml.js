!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).esml={})}(this,(function(t){"use strict";const n=["context","actor","aggregate","system","projector","policy","process","schema"],e=[...n,"invokes","handles","emits","includes","reads","requires","optional"],r={context:"white",actor:"#ffc107",aggregate:"#fffabb",system:"#eca0c3",projector:"#d5f694",policy:"#c595cd",process:"#c595cd",command:"#7adcfb",event:"#ffaa61",schema:"transparent"},o=["string","number","boolean","uuid","date"];class i{constructor(t,n,e,r){this.name=t,this.required=n,this.type=e,this.size=r}}let u=class extends Map{constructor(t){super(),this.id=t}toString(){return this.id}};const a={grammar:{handles:{type:"event"},invokes:{type:"command"},reads:{type:"projector"}},rel:(t,n)=>"event"===n.visual?{source:t.ctx===n.ctx?n:{...n,id:n.id+"*"},target:t,edge:!0,color:r.event,arrow:!1}:"projector"===n.visual?{source:t,target:n}:t.ctx===n.ctx?{source:t,target:n,edge:!0,color:r.command,arrow:!1}:{source:n,target:t}},c={grammar:{handles:{type:"command",owns:!0},emits:{type:"event",owns:!0}},rel:(t,n)=>"command"===n.visual?{source:n,target:t,edge:!0}:{source:t,target:n,edge:!0}},s={context:{grammar:{includes:{owns:!0}},rel:(t,n,e)=>"event"===n.visual?{source:e.nodes.get(n.ctx),target:e.nodes.get(t.ctx),edge:!0,color:r.event,arrow:!0}:"command"===n.visual?{source:e.nodes.get(t.ctx),target:e.nodes.get(n.ctx),edge:!0,color:r.command,arrow:!0}:"projector"===n.visual?{source:e.nodes.get(t.ctx),target:e.nodes.get(n.ctx),edge:!0,color:r.projector,arrow:!0}:void 0},actor:{grammar:{invokes:{type:"command"},reads:{type:"projector"}},rel:(t,n)=>"command"===n.visual?{source:n,target:t}:{source:t,target:n}},aggregate:c,system:c,policy:a,process:a,projector:{grammar:{handles:{type:"event"}},rel:(t,n)=>({source:t.ctx===n.ctx?n:{...n,id:n.id+"*"},target:t,edge:!0,color:r.event,arrow:!1})},schema:{grammar:{requires:{type:"field",owns:!0},optional:{type:"field",owns:!0}},rel:()=>{}}};class f extends Error{constructor(t,n,e){super(`Compiler error at line ${t.from.line}: Expected ${n} but got ${e}`),this.source=t,this.expected=n,this.actual=e}}const h=(t,n,e)=>{throw new f(t.source,n,e)},d=(t="",n=!1)=>({id:t,visual:"context",ctx:"root",color:n?void 0:r.context,nodes:new Map,edges:new Map,refs:new Map,x:0,y:0}),l=["context","actor"];var v,p,g,y,m,b,w,_,x,E,j,k,N,O,M,I,z,S,C,A,L,T,$,P,B,F,R,D,G,U,H,V,q,W,Y,Z,K,X,J,Q,tt,nt,et,rt,ot,it,ut,at,ct,st,ft,ht,dt,lt,vt,pt,gt,yt,mt,bt,wt,_t,xt,Et,jt,kt,Nt,Ot,Mt,It,zt,St,Ct,At,Lt,Tt,$t,Pt,Bt,Ft,Rt,Dt,Gt,Ut,Ht,Vt,qt,Wt,Yt,Zt,Kt,Xt,Jt,Qt,tn,nn,en,rn,on,un,an,cn,sn,fn,hn,dn,ln,vn,pn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function gn(){if(y)return g;return y=1,g=function(t,n){return t===n||t!=t&&n!=n}}function yn(){if(b)return m;b=1;var t=gn();return m=function(n,e){for(var r=n.length;r--;)if(t(n[r][0],e))return r;return-1}}function mn(){if(I)return M;I=1;var t=p?v:(p=1,v=function(){this.__data__=[],this.size=0}),n=function(){if(_)return w;_=1;var t=yn(),n=Array.prototype.splice;return w=function(e){var r=this.__data__,o=t(r,e);return!(o<0||(o==r.length-1?r.pop():n.call(r,o,1),--this.size,0))}}(),e=function(){if(E)return x;E=1;var t=yn();return x=function(n){var e=this.__data__,r=t(e,n);return r<0?void 0:e[r][1]}}(),r=function(){if(k)return j;k=1;var t=yn();return j=function(n){return t(this.__data__,n)>-1}}(),o=function(){if(O)return N;O=1;var t=yn();return N=function(n,e){var r=this.__data__,o=t(r,n);return o<0?(++this.size,r.push([n,e])):r[o][1]=e,this}}();function i(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=e,i.prototype.has=r,i.prototype.set=o,M=i}function bn(){if(F)return B;F=1;var t="object"==typeof pn&&pn&&pn.Object===Object&&pn;return B=t}function wn(){if(D)return R;D=1;var t=bn(),n="object"==typeof self&&self&&self.Object===Object&&self,e=t||n||Function("return this")();return R=e}function _n(){if(U)return G;U=1;var t=wn().Symbol;return G=t}function xn(){if(Z)return Y;Z=1;var t=_n(),n=function(){if(V)return H;V=1;var t=_n(),n=Object.prototype,e=n.hasOwnProperty,r=n.toString,o=t?t.toStringTag:void 0;return H=function(t){var n=e.call(t,o),i=t[o];try{t[o]=void 0;var u=!0}catch(t){}var a=r.call(t);return u&&(n?t[o]=i:delete t[o]),a}}(),e=function(){if(W)return q;W=1;var t=Object.prototype.toString;return q=function(n){return t.call(n)}}(),r=t?t.toStringTag:void 0;return Y=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?n(t):e(t)}}function En(){if(X)return K;return X=1,K=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}}function jn(){if(Q)return J;Q=1;var t=xn(),n=En();return J=function(e){if(!n(e))return!1;var r=t(e);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}}function kn(){if(rt)return et;rt=1;var t,n=function(){if(nt)return tt;nt=1;var t=wn()["__core-js_shared__"];return tt=t}(),e=(t=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return et=function(t){return!!e&&e in t}}function Nn(){if(it)return ot;it=1;var t=Function.prototype.toString;return ot=function(n){if(null!=n){try{return t.call(n)}catch(t){}try{return n+""}catch(t){}}return""}}function On(){if(ht)return ft;ht=1;var t=function(){if(at)return ut;at=1;var t=jn(),n=kn(),e=En(),r=Nn(),o=/^\[object .+?Constructor\]$/,i=Function.prototype,u=Object.prototype,a=i.toString,c=u.hasOwnProperty,s=RegExp("^"+a.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return ut=function(i){return!(!e(i)||n(i))&&(t(i)?s:o).test(r(i))}}(),n=st?ct:(st=1,ct=function(t,n){return null==t?void 0:t[n]});return ft=function(e,r){var o=n(e,r);return t(o)?o:void 0}}function Mn(){if(lt)return dt;lt=1;var t=On()(wn(),"Map");return dt=t}function In(){if(pt)return vt;pt=1;var t=On()(Object,"create");return vt=t}function zn(){if(Ot)return Nt;Ot=1;var t=function(){if(yt)return gt;yt=1;var t=In();return gt=function(){this.__data__=t?t(null):{},this.size=0}}(),n=bt?mt:(bt=1,mt=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}),e=function(){if(_t)return wt;_t=1;var t=In(),n=Object.prototype.hasOwnProperty;return wt=function(e){var r=this.__data__;if(t){var o=r[e];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(r,e)?r[e]:void 0}}(),r=function(){if(Et)return xt;Et=1;var t=In(),n=Object.prototype.hasOwnProperty;return xt=function(e){var r=this.__data__;return t?void 0!==r[e]:n.call(r,e)}}(),o=function(){if(kt)return jt;kt=1;var t=In();return jt=function(n,e){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=t&&void 0===e?"__lodash_hash_undefined__":e,this}}();function i(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=e,i.prototype.has=r,i.prototype.set=o,Nt=i}function Sn(){if(At)return Ct;At=1;var t=St?zt:(St=1,zt=function(t){var n=typeof t;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t});return Ct=function(n,e){var r=n.__data__;return t(e)?r["string"==typeof e?"string":"hash"]:r.map}}function Cn(){if(Ut)return Gt;Ut=1;var t=function(){if(It)return Mt;It=1;var t=zn(),n=mn(),e=Mn();return Mt=function(){this.size=0,this.__data__={hash:new t,map:new(e||n),string:new t}}}(),n=function(){if(Tt)return Lt;Tt=1;var t=Sn();return Lt=function(n){var e=t(this,n).delete(n);return this.size-=e?1:0,e}}(),e=function(){if(Pt)return $t;Pt=1;var t=Sn();return $t=function(n){return t(this,n).get(n)}}(),r=function(){if(Ft)return Bt;Ft=1;var t=Sn();return Bt=function(n){return t(this,n).has(n)}}(),o=function(){if(Dt)return Rt;Dt=1;var t=Sn();return Rt=function(n,e){var r=t(this,n),o=r.size;return r.set(n,e),this.size+=r.size==o?0:1,this}}();function i(t){var n=-1,e=null==t?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=e,i.prototype.has=r,i.prototype.set=o,Gt=i}function An(){if(Wt)return qt;Wt=1;var t=mn(),n=function(){if(S)return z;S=1;var t=mn();return z=function(){this.__data__=new t,this.size=0}}(),e=A?C:(A=1,C=function(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}),r=T?L:(T=1,L=function(t){return this.__data__.get(t)}),o=P?$:(P=1,$=function(t){return this.__data__.has(t)}),i=function(){if(Vt)return Ht;Vt=1;var t=mn(),n=Mn(),e=Cn();return Ht=function(r,o){var i=this.__data__;if(i instanceof t){var u=i.__data__;if(!n||u.length<199)return u.push([r,o]),this.size=++i.size,this;i=this.__data__=new e(u)}return i.set(r,o),this.size=i.size,this}}();function u(n){var e=this.__data__=new t(n);this.size=e.size}return u.prototype.clear=n,u.prototype.delete=e,u.prototype.get=r,u.prototype.has=o,u.prototype.set=i,qt=u}function Ln(){if(Zt)return Yt;return Zt=1,Yt=function(t,n){for(var e=-1,r=null==t?0:t.length;++e<r&&!1!==n(t[e],e,t););return t}}function Tn(){if(Xt)return Kt;Xt=1;var t=On(),n=function(){try{var n=t(Object,"defineProperty");return n({},"",{}),n}catch(t){}}();return Kt=n}function $n(){if(Qt)return Jt;Qt=1;var t=Tn();return Jt=function(n,e,r){"__proto__"==e&&t?t(n,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):n[e]=r}}function Pn(){if(nn)return tn;nn=1;var t=$n(),n=gn(),e=Object.prototype.hasOwnProperty;return tn=function(r,o,i){var u=r[o];e.call(r,o)&&n(u,i)&&(void 0!==i||o in r)||t(r,o,i)}}function Bn(){if(rn)return en;rn=1;var t=Pn(),n=$n();return en=function(e,r,o,i){var u=!o;o||(o={});for(var a=-1,c=r.length;++a<c;){var s=r[a],f=i?i(o[s],e[s],s,o,e):void 0;void 0===f&&(f=e[s]),u?n(o,s,f):t(o,s,f)}return o}}function Fn(){if(cn)return an;return cn=1,an=function(t){return null!=t&&"object"==typeof t}}function Rn(){if(dn)return hn;dn=1;var t=function(){if(fn)return sn;fn=1;var t=xn(),n=Fn();return sn=function(e){return n(e)&&"[object Arguments]"==t(e)}}(),n=Fn(),e=Object.prototype,r=e.hasOwnProperty,o=e.propertyIsEnumerable,i=t(function(){return arguments}())?t:function(t){return n(t)&&r.call(t,"callee")&&!o.call(t,"callee")};return hn=i}function Dn(){if(vn)return ln;vn=1;var t=Array.isArray;return ln=t}var Gn,Un,Hn,Vn,qn,Wn,Yn,Zn,Kn,Xn,Jn,Qn={exports:{}};function te(){return Hn||(Hn=1,function(t,n){var e=wn(),r=Un?Gn:(Un=1,Gn=function(){return!1}),o=n&&!n.nodeType&&n,i=o&&t&&!t.nodeType&&t,u=i&&i.exports===o?e.Buffer:void 0,a=(u?u.isBuffer:void 0)||r;t.exports=a}(Qn,Qn.exports)),Qn.exports}function ne(){if(qn)return Vn;qn=1;var t=/^(?:0|[1-9]\d*)$/;return Vn=function(n,e){var r=typeof n;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&t.test(n))&&n>-1&&n%1==0&&n<e}}function ee(){if(Yn)return Wn;Yn=1;return Wn=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function re(){if(Jn)return Xn;return Jn=1,Xn=function(t){return function(n){return t(n)}}}Qn.exports;var oe,ie,ue,ae,ce,se,fe,he,de,le,ve,pe,ge,ye,me,be,we,_e,xe,Ee,je,ke,Ne,Oe,Me,Ie,ze,Se={exports:{}};function Ce(){return oe||(oe=1,function(t,n){var e=bn(),r=n&&!n.nodeType&&n,o=r&&t&&!t.nodeType&&t,i=o&&o.exports===r&&e.process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}(Se,Se.exports)),Se.exports}function Ae(){if(ue)return ie;ue=1;var t=function(){if(Kn)return Zn;Kn=1;var t=xn(),n=ee(),e=Fn(),r={};return r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,Zn=function(o){return e(o)&&n(o.length)&&!!r[t(o)]}}(),n=re(),e=Ce(),r=e&&e.isTypedArray,o=r?n(r):t;return ie=o}function Le(){if(ce)return ae;ce=1;var t=un?on:(un=1,on=function(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r}),n=Rn(),e=Dn(),r=te(),o=ne(),i=Ae(),u=Object.prototype.hasOwnProperty;return ae=function(a,c){var s=e(a),f=!s&&n(a),h=!s&&!f&&r(a),d=!s&&!f&&!h&&i(a),l=s||f||h||d,v=l?t(a.length,String):[],p=v.length;for(var g in a)!c&&!u.call(a,g)||l&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||o(g,p))||v.push(g);return v}}function Te(){if(fe)return se;fe=1;var t=Object.prototype;return se=function(n){var e=n&&n.constructor;return n===("function"==typeof e&&e.prototype||t)}}function $e(){if(de)return he;return de=1,he=function(t,n){return function(e){return t(n(e))}}}function Pe(){if(ge)return pe;ge=1;var t=Te(),n=function(){if(ve)return le;ve=1;var t=$e()(Object.keys,Object);return le=t}(),e=Object.prototype.hasOwnProperty;return pe=function(r){if(!t(r))return n(r);var o=[];for(var i in Object(r))e.call(r,i)&&"constructor"!=i&&o.push(i);return o}}function Be(){if(me)return ye;me=1;var t=jn(),n=ee();return ye=function(e){return null!=e&&n(e.length)&&!t(e)}}function Fe(){if(we)return be;we=1;var t=Le(),n=Pe(),e=Be();return be=function(r){return e(r)?t(r):n(r)}}function Re(){if(Ne)return ke;Ne=1;var t=En(),n=Te(),e=je?Ee:(je=1,Ee=function(t){var n=[];if(null!=t)for(var e in Object(t))n.push(e);return n}),r=Object.prototype.hasOwnProperty;return ke=function(o){if(!t(o))return e(o);var i=n(o),u=[];for(var a in o)("constructor"!=a||!i&&r.call(o,a))&&u.push(a);return u}}function De(){if(Me)return Oe;Me=1;var t=Le(),n=Re(),e=Be();return Oe=function(r){return e(r)?t(r,!0):n(r)}}Se.exports;var Ge,Ue,He,Ve,qe,We,Ye,Ze,Ke,Xe,Je,Qe,tr,nr,er,rr,or,ir,ur,ar,cr,sr,fr,hr,dr,lr,vr,pr,gr,yr,mr,br,wr,_r,xr,Er,jr,kr,Nr,Or,Mr,Ir,zr,Sr,Cr,Ar,Lr,Tr,$r,Pr,Br,Fr,Rr,Dr,Gr,Ur,Hr,Vr,qr,Wr,Yr,Zr,Kr,Xr,Jr,Qr,to,no,eo,ro,oo,io,uo,ao,co,so,fo,ho,lo,vo,po,go,yo,mo,bo,wo,_o,xo,Eo,jo,ko,No,Oo,Mo,Io,zo,So,Co,Ao,Lo,To,$o,Po,Bo,Fo,Ro,Do,Go,Uo,Ho,Vo,qo,Wo,Yo,Zo,Ko,Xo,Jo,Qo,ti,ni,ei,ri,oi,ii,ui,ai,ci,si,fi,hi,di,li,vi,pi,gi,yi,mi,bi,wi,_i,xi,Ei,ji,ki,Ni,Oi,Mi,Ii,zi,Si,Ci,Ai,Li,Ti,$i,Pi,Bi,Fi,Ri,Di,Gi,Ui,Hi,Vi,qi,Wi,Yi,Zi,Ki,Xi,Ji,Qi,tu,nu,eu,ru,ou,iu,uu,au,cu,su,fu,hu,du,lu,vu,pu,gu,yu,mu,bu,wu,_u,xu,Eu,ju,ku,Nu,Ou,Mu,Iu,zu,Su,Cu,Au,Lu,Tu,$u,Pu,Bu,Fu,Ru,Du,Gu,Uu,Hu,Vu,qu,Wu,Yu,Zu,Ku,Xu,Ju,Qu,ta,na,ea,ra,oa,ia,ua,aa,ca,sa,fa,ha,da,la,va,pa,ga,ya,ma,ba,wa,_a,xa,Ea,ja,ka,Na,Oa,Ma,Ia,za,Sa,Ca,Aa,La,Ta,$a,Pa,Ba,Fa,Ra,Da,Ga,Ua,Ha,Va,qa,Wa,Ya,Za,Ka,Xa,Ja,Qa={exports:{}};function tc(){return Ge||(Ge=1,function(t,n){var e=wn(),r=n&&!n.nodeType&&n,o=r&&t&&!t.nodeType&&t,i=o&&o.exports===r?e.Buffer:void 0,u=i?i.allocUnsafe:void 0;t.exports=function(t,n){if(n)return t.slice();var e=t.length,r=u?u(e):new t.constructor(e);return t.copy(r),r}}(Qa,Qa.exports)),Qa.exports}function nc(){if(He)return Ue;return He=1,Ue=function(t,n){var e=-1,r=t.length;for(n||(n=Array(r));++e<r;)n[e]=t[e];return n}}function ec(){if(qe)return Ve;return qe=1,Ve=function(t,n){for(var e=-1,r=null==t?0:t.length,o=0,i=[];++e<r;){var u=t[e];n(u,e,t)&&(i[o++]=u)}return i}}function rc(){if(Ye)return We;return Ye=1,We=function(){return[]}}function oc(){if(Ke)return Ze;Ke=1;var t=ec(),n=rc(),e=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols;return Ze=r?function(n){return null==n?[]:(n=Object(n),t(r(n),(function(t){return e.call(n,t)})))}:n}function ic(){if(tr)return Qe;return tr=1,Qe=function(t,n){for(var e=-1,r=n.length,o=t.length;++e<r;)t[o+e]=n[e];return t}}function uc(){if(er)return nr;er=1;var t=$e()(Object.getPrototypeOf,Object);return nr=t}function ac(){if(or)return rr;or=1;var t=ic(),n=uc(),e=oc(),r=rc(),o=Object.getOwnPropertySymbols;return rr=o?function(r){for(var o=[];r;)t(o,e(r)),r=n(r);return o}:r}function cc(){if(cr)return ar;cr=1;var t=ic(),n=Dn();return ar=function(e,r,o){var i=r(e);return n(e)?i:t(i,o(e))}}function sc(){if(fr)return sr;fr=1;var t=cc(),n=oc(),e=Fe();return sr=function(r){return t(r,e,n)}}function fc(){if(mr)return yr;mr=1;var t=On()(wn(),"Set");return yr=t}function hc(){if(xr)return _r;xr=1;var t=function(){if(vr)return lr;vr=1;var t=On()(wn(),"DataView");return lr=t}(),n=Mn(),e=function(){if(gr)return pr;gr=1;var t=On()(wn(),"Promise");return pr=t}(),r=fc(),o=function(){if(wr)return br;wr=1;var t=On()(wn(),"WeakMap");return br=t}(),i=xn(),u=Nn(),a="[object Map]",c="[object Promise]",s="[object Set]",f="[object WeakMap]",h="[object DataView]",d=u(t),l=u(n),v=u(e),p=u(r),g=u(o),y=i;return(t&&y(new t(new ArrayBuffer(1)))!=h||n&&y(new n)!=a||e&&y(e.resolve())!=c||r&&y(new r)!=s||o&&y(new o)!=f)&&(y=function(t){var n=i(t),e="[object Object]"==n?t.constructor:void 0,r=e?u(e):"";if(r)switch(r){case d:return h;case l:return a;case v:return c;case p:return s;case g:return f}return n}),_r=y}function dc(){if(Nr)return kr;Nr=1;var t=wn().Uint8Array;return kr=t}function lc(){if(Mr)return Or;Mr=1;var t=dc();return Or=function(n){var e=new n.constructor(n.byteLength);return new t(e).set(new t(n)),e}}function vc(){if($r)return Tr;$r=1;var t=lc();return Tr=function(n,e){var r=e?t(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.length)}}function pc(){if(Br)return Pr;Br=1;var t=lc(),n=function(){if(zr)return Ir;zr=1;var t=lc();return Ir=function(n,e){var r=e?t(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.byteLength)}}(),e=function(){if(Cr)return Sr;Cr=1;var t=/\w*$/;return Sr=function(n){var e=new n.constructor(n.source,t.exec(n));return e.lastIndex=n.lastIndex,e}}(),r=function(){if(Lr)return Ar;Lr=1;var t=_n(),n=t?t.prototype:void 0,e=n?n.valueOf:void 0;return Ar=function(t){return e?Object(e.call(t)):{}}}(),o=vc();return Pr=function(i,u,a){var c=i.constructor;switch(u){case"[object ArrayBuffer]":return t(i);case"[object Boolean]":case"[object Date]":return new c(+i);case"[object DataView]":return n(i,a);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return o(i,a);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(i);case"[object RegExp]":return e(i);case"[object Symbol]":return r(i)}}}function gc(){if(Rr)return Fr;Rr=1;var t=En(),n=Object.create,e=function(){function e(){}return function(r){if(!t(r))return{};if(n)return n(r);e.prototype=r;var o=new e;return e.prototype=void 0,o}}();return Fr=e}function yc(){if(Gr)return Dr;Gr=1;var t=gc(),n=uc(),e=Te();return Dr=function(r){return"function"!=typeof r.constructor||e(r)?{}:t(n(r))}}function mc(){if(qr)return Vr;qr=1;var t=function(){if(Hr)return Ur;Hr=1;var t=hc(),n=Fn();return Ur=function(e){return n(e)&&"[object Map]"==t(e)}}(),n=re(),e=Ce(),r=e&&e.isMap,o=r?n(r):t;return Vr=o}function bc(){if(Kr)return Zr;Kr=1;var t=function(){if(Yr)return Wr;Yr=1;var t=hc(),n=Fn();return Wr=function(e){return n(e)&&"[object Set]"==t(e)}}(),n=re(),e=Ce(),r=e&&e.isSet,o=r?n(r):t;return Zr=o}function wc(){if(Jr)return Xr;Jr=1;var t=An(),n=Ln(),e=Pn(),r=function(){if(xe)return _e;xe=1;var t=Bn(),n=Fe();return _e=function(e,r){return e&&t(r,n(r),e)}}(),o=function(){if(ze)return Ie;ze=1;var t=Bn(),n=De();return Ie=function(e,r){return e&&t(r,n(r),e)}}(),i=tc(),u=nc(),a=function(){if(Je)return Xe;Je=1;var t=Bn(),n=oc();return Xe=function(e,r){return t(e,n(e),r)}}(),c=function(){if(ur)return ir;ur=1;var t=Bn(),n=ac();return ir=function(e,r){return t(e,n(e),r)}}(),s=sc(),f=function(){if(dr)return hr;dr=1;var t=cc(),n=ac(),e=De();return hr=function(r){return t(r,e,n)}}(),h=hc(),d=function(){if(jr)return Er;jr=1;var t=Object.prototype.hasOwnProperty;return Er=function(n){var e=n.length,r=new n.constructor(e);return e&&"string"==typeof n[0]&&t.call(n,"index")&&(r.index=n.index,r.input=n.input),r}}(),l=pc(),v=yc(),p=Dn(),g=te(),y=mc(),m=En(),b=bc(),w=Fe(),_=De(),x="[object Arguments]",E="[object Function]",j="[object Object]",k={};return k[x]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k[j]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k[E]=k["[object WeakMap]"]=!1,Xr=function N(O,M,I,z,S,C){var A,L=1&M,T=2&M,$=4&M;if(I&&(A=S?I(O,z,S,C):I(O)),void 0!==A)return A;if(!m(O))return O;var P=p(O);if(P){if(A=d(O),!L)return u(O,A)}else{var B=h(O),F=B==E||"[object GeneratorFunction]"==B;if(g(O))return i(O,L);if(B==j||B==x||F&&!S){if(A=T||F?{}:v(O),!L)return T?c(O,o(A,O)):a(O,r(A,O))}else{if(!k[B])return S?O:{};A=l(O,B,L)}}C||(C=new t);var R=C.get(O);if(R)return R;C.set(O,A),b(O)?O.forEach((function(t){A.add(N(t,M,I,t,O,C))})):y(O)&&O.forEach((function(t,n){A.set(n,N(t,M,I,n,O,C))}));var D=P?void 0:($?T?f:s:T?_:w)(O);return n(D||O,(function(t,n){D&&(t=O[n=t]),e(A,n,N(t,M,I,n,O,C))})),A},Xr}function _c(){if(to)return Qr;to=1;var t=wc();return Qr=function(n){return t(n,4)}}function xc(){if(eo)return no;return eo=1,no=function(t){return function(){return t}}}function Ec(){if(uo)return io;uo=1;var t=(oo?ro:(oo=1,ro=function(t){return function(n,e,r){for(var o=-1,i=Object(n),u=r(n),a=u.length;a--;){var c=u[t?a:++o];if(!1===e(i[c],c,i))break}return n}}))();return io=t}function jc(){if(co)return ao;co=1;var t=Ec(),n=Fe();return ao=function(e,r){return e&&t(e,r,n)}}function kc(){if(lo)return ho;lo=1;var t=jc(),n=function(){if(fo)return so;fo=1;var t=Be();return so=function(n,e){return function(r,o){if(null==r)return r;if(!t(r))return n(r,o);for(var i=r.length,u=e?i:-1,a=Object(r);(e?u--:++u<i)&&!1!==o(a[u],u,a););return r}}}()(t);return ho=n}function Nc(){if(po)return vo;return po=1,vo=function(t){return t}}function Oc(){if(yo)return go;yo=1;var t=Nc();return go=function(n){return"function"==typeof n?n:t}}function Mc(){if(bo)return mo;bo=1;var t=Ln(),n=kc(),e=Oc(),r=Dn();return mo=function(o,i){return(r(o)?t:n)(o,e(i))}}function Ic(){return _o?wo:(_o=1,wo=Mc())}function zc(){if(Io)return Mo;Io=1;var t=Cn(),n=ko?jo:(ko=1,jo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),e=Oo?No:(Oo=1,No=function(t){return this.__data__.has(t)});function r(n){var e=-1,r=null==n?0:n.length;for(this.__data__=new t;++e<r;)this.add(n[e])}return r.prototype.add=r.prototype.push=n,r.prototype.has=e,Mo=r}function Sc(){if(Ao)return Co;return Ao=1,Co=function(t,n){return t.has(n)}}function Cc(){if(To)return Lo;To=1;var t=zc(),n=So?zo:(So=1,zo=function(t,n){for(var e=-1,r=null==t?0:t.length;++e<r;)if(n(t[e],e,t))return!0;return!1}),e=Sc();return Lo=function(r,o,i,u,a,c){var s=1&i,f=r.length,h=o.length;if(f!=h&&!(s&&h>f))return!1;var d=c.get(r),l=c.get(o);if(d&&l)return d==o&&l==r;var v=-1,p=!0,g=2&i?new t:void 0;for(c.set(r,o),c.set(o,r);++v<f;){var y=r[v],m=o[v];if(u)var b=s?u(m,y,v,o,r,c):u(y,m,v,r,o,c);if(void 0!==b){if(b)continue;p=!1;break}if(g){if(!n(o,(function(t,n){if(!e(g,n)&&(y===t||a(y,t,i,u,c)))return g.push(n)}))){p=!1;break}}else if(y!==m&&!a(y,m,i,u,c)){p=!1;break}}return c.delete(r),c.delete(o),p}}function Ac(){if(Fo)return Bo;return Fo=1,Bo=function(t){var n=-1,e=Array(t.size);return t.forEach((function(t){e[++n]=t})),e}}function Lc(){if(Do)return Ro;Do=1;var t=_n(),n=dc(),e=gn(),r=Cc(),o=Po?$o:(Po=1,$o=function(t){var n=-1,e=Array(t.size);return t.forEach((function(t,r){e[++n]=[r,t]})),e}),i=Ac(),u=t?t.prototype:void 0,a=u?u.valueOf:void 0;return Ro=function(t,u,c,s,f,h,d){switch(c){case"[object DataView]":if(t.byteLength!=u.byteLength||t.byteOffset!=u.byteOffset)return!1;t=t.buffer,u=u.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=u.byteLength||!h(new n(t),new n(u)));case"[object Boolean]":case"[object Date]":case"[object Number]":return e(+t,+u);case"[object Error]":return t.name==u.name&&t.message==u.message;case"[object RegExp]":case"[object String]":return t==u+"";case"[object Map]":var l=o;case"[object Set]":var v=1&s;if(l||(l=i),t.size!=u.size&&!v)return!1;var p=d.get(t);if(p)return p==u;s|=2,d.set(t,u);var g=r(l(t),l(u),s,f,h,d);return d.delete(t),g;case"[object Symbol]":if(a)return a.call(t)==a.call(u)}return!1}}function Tc(){if(Vo)return Ho;Vo=1;var t=An(),n=Cc(),e=Lc(),r=function(){if(Uo)return Go;Uo=1;var t=sc(),n=Object.prototype.hasOwnProperty;return Go=function(e,r,o,i,u,a){var c=1&o,s=t(e),f=s.length;if(f!=t(r).length&&!c)return!1;for(var h=f;h--;){var d=s[h];if(!(c?d in r:n.call(r,d)))return!1}var l=a.get(e),v=a.get(r);if(l&&v)return l==r&&v==e;var p=!0;a.set(e,r),a.set(r,e);for(var g=c;++h<f;){var y=e[d=s[h]],m=r[d];if(i)var b=c?i(m,y,d,r,e,a):i(y,m,d,e,r,a);if(!(void 0===b?y===m||u(y,m,o,i,a):b)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var w=e.constructor,_=r.constructor;w==_||!("constructor"in e)||!("constructor"in r)||"function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(e),a.delete(r),p}}(),o=hc(),i=Dn(),u=te(),a=Ae(),c="[object Arguments]",s="[object Array]",f="[object Object]",h=Object.prototype.hasOwnProperty;return Ho=function(d,l,v,p,g,y){var m=i(d),b=i(l),w=m?s:o(d),_=b?s:o(l),x=(w=w==c?f:w)==f,E=(_=_==c?f:_)==f,j=w==_;if(j&&u(d)){if(!u(l))return!1;m=!0,x=!1}if(j&&!x)return y||(y=new t),m||a(d)?n(d,l,v,p,g,y):e(d,l,w,v,p,g,y);if(!(1&v)){var k=x&&h.call(d,"__wrapped__"),N=E&&h.call(l,"__wrapped__");if(k||N){var O=k?d.value():d,M=N?l.value():l;return y||(y=new t),g(O,M,v,p,y)}}return!!j&&(y||(y=new t),r(d,l,v,p,g,y))}}function $c(){if(Wo)return qo;Wo=1;var t=Tc(),n=Fn();return qo=function e(r,o,i,u,a){return r===o||(null==r||null==o||!n(r)&&!n(o)?r!=r&&o!=o:t(r,o,i,u,e,a))},qo}function Pc(){if(Xo)return Ko;Xo=1;var t=En();return Ko=function(n){return n==n&&!t(n)}}function Bc(){if(ni)return ti;return ni=1,ti=function(t,n){return function(e){return null!=e&&(e[t]===n&&(void 0!==n||t in Object(e)))}}}function Fc(){if(ri)return ei;ri=1;var t=function(){if(Zo)return Yo;Zo=1;var t=An(),n=$c();return Yo=function(e,r,o,i){var u=o.length,a=u,c=!i;if(null==e)return!a;for(e=Object(e);u--;){var s=o[u];if(c&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++u<a;){var f=(s=o[u])[0],h=e[f],d=s[1];if(c&&s[2]){if(void 0===h&&!(f in e))return!1}else{var l=new t;if(i)var v=i(h,d,f,e,r,l);if(!(void 0===v?n(d,h,3,i,l):v))return!1}}return!0}}(),n=function(){if(Qo)return Jo;Qo=1;var t=Pc(),n=Fe();return Jo=function(e){for(var r=n(e),o=r.length;o--;){var i=r[o],u=e[i];r[o]=[i,u,t(u)]}return r}}(),e=Bc();return ei=function(r){var o=n(r);return 1==o.length&&o[0][2]?e(o[0][0],o[0][1]):function(n){return n===r||t(n,r,o)}}}function Rc(){if(ii)return oi;ii=1;var t=xn(),n=Fn();return oi=function(e){return"symbol"==typeof e||n(e)&&"[object Symbol]"==t(e)}}function Dc(){if(ai)return ui;ai=1;var t=Dn(),n=Rc(),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;return ui=function(o,i){if(t(o))return!1;var u=typeof o;return!("number"!=u&&"symbol"!=u&&"boolean"!=u&&null!=o&&!n(o))||(r.test(o)||!e.test(o)||null!=i&&o in Object(i))}}function Gc(){if(hi)return fi;hi=1;var t=function(){if(si)return ci;si=1;var t=Cn();function n(e,r){if("function"!=typeof e||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var o=function(){var t=arguments,n=r?r.apply(this,t):t[0],i=o.cache;if(i.has(n))return i.get(n);var u=e.apply(this,t);return o.cache=i.set(n,u)||i,u};return o.cache=new(n.Cache||t),o}return n.Cache=t,ci=n}();return fi=function(n){var e=t(n,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}}function Uc(){if(pi)return vi;return pi=1,vi=function(t,n){for(var e=-1,r=null==t?0:t.length,o=Array(r);++e<r;)o[e]=n(t[e],e,t);return o}}function Hc(){if(bi)return mi;bi=1;var t=function(){if(yi)return gi;yi=1;var t=_n(),n=Uc(),e=Dn(),r=Rc(),o=t?t.prototype:void 0,i=o?o.toString:void 0;return gi=function t(o){if("string"==typeof o)return o;if(e(o))return n(o,t)+"";if(r(o))return i?i.call(o):"";var u=o+"";return"0"==u&&1/o==-1/0?"-0":u},gi}();return mi=function(n){return null==n?"":t(n)}}function Vc(){if(_i)return wi;_i=1;var t=Dn(),n=Dc(),e=function(){if(li)return di;li=1;var t=Gc(),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,r=t((function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(n,(function(t,n,o,i){r.push(o?i.replace(e,"$1"):n||t)})),r}));return di=r}(),r=Hc();return wi=function(o,i){return t(o)?o:n(o,i)?[o]:e(r(o))}}function qc(){if(Ei)return xi;Ei=1;var t=Rc();return xi=function(n){if("string"==typeof n||t(n))return n;var e=n+"";return"0"==e&&1/n==-Infinity?"-0":e}}function Wc(){if(ki)return ji;ki=1;var t=Vc(),n=qc();return ji=function(e,r){for(var o=0,i=(r=t(r,e)).length;null!=e&&o<i;)e=e[n(r[o++])];return o&&o==i?e:void 0}}function Yc(){if(Si)return zi;Si=1;var t=Vc(),n=Rn(),e=Dn(),r=ne(),o=ee(),i=qc();return zi=function(u,a,c){for(var s=-1,f=(a=t(a,u)).length,h=!1;++s<f;){var d=i(a[s]);if(!(h=null!=u&&c(u,d)))break;u=u[d]}return h||++s!=f?h:!!(f=null==u?0:u.length)&&o(f)&&r(d,f)&&(e(u)||n(u))}}function Zc(){if(Ai)return Ci;Ai=1;var t=Ii?Mi:(Ii=1,Mi=function(t,n){return null!=t&&n in Object(t)}),n=Yc();return Ci=function(e,r){return null!=e&&n(e,r,t)}}function Kc(){if(Ti)return Li;Ti=1;var t=$c(),n=function(){if(Oi)return Ni;Oi=1;var t=Wc();return Ni=function(n,e,r){var o=null==n?void 0:t(n,e);return void 0===o?r:o}}(),e=Zc(),r=Dc(),o=Pc(),i=Bc(),u=qc();return Li=function(a,c){return r(a)&&o(c)?i(u(a),c):function(r){var o=n(r,a);return void 0===o&&o===c?e(r,a):t(c,o,3)}}}function Xc(){if(Pi)return $i;return Pi=1,$i=function(t){return function(n){return null==n?void 0:n[t]}}}function Jc(){if(Di)return Ri;Di=1;var t=Xc(),n=function(){if(Fi)return Bi;Fi=1;var t=Wc();return Bi=function(n){return function(e){return t(e,n)}}}(),e=Dc(),r=qc();return Ri=function(o){return e(o)?t(r(o)):n(o)}}function Qc(){if(Ui)return Gi;Ui=1;var t=Fc(),n=Kc(),e=Nc(),r=Dn(),o=Jc();return Gi=function(i){return"function"==typeof i?i:null==i?e:"object"==typeof i?r(i)?n(i[0],i[1]):t(i):o(i)}}function ts(){if(Vi)return Hi;Vi=1;var t=ec(),n=function(){if(Eo)return xo;Eo=1;var t=kc();return xo=function(n,e){var r=[];return t(n,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}}(),e=Qc(),r=Dn();return Hi=function(o,i){return(r(o)?t:n)(o,e(i,3))}}function ns(){if(Zi)return Yi;Zi=1;var t=function(){if(Wi)return qi;Wi=1;var t=Object.prototype.hasOwnProperty;return qi=function(n,e){return null!=n&&t.call(n,e)}}(),n=Yc();return Yi=function(e,r){return null!=e&&n(e,r,t)}}function es(){if(Xi)return Ki;Xi=1;var t=Pe(),n=hc(),e=Rn(),r=Dn(),o=Be(),i=te(),u=Te(),a=Ae(),c=Object.prototype.hasOwnProperty;return Ki=function(s){if(null==s)return!0;if(o(s)&&(r(s)||"string"==typeof s||"function"==typeof s.splice||i(s)||a(s)||e(s)))return!s.length;var f=n(s);if("[object Map]"==f||"[object Set]"==f)return!s.size;if(u(s))return!t(s).length;for(var h in s)if(c.call(s,h))return!1;return!0}}function rs(){if(Qi)return Ji;return Qi=1,Ji=function(t){return void 0===t}}function os(){if(nu)return tu;nu=1;var t=kc(),n=Be();return tu=function(e,r){var o=-1,i=n(e)?Array(e.length):[];return t(e,(function(t,n,e){i[++o]=r(t,n,e)})),i}}function is(){if(ru)return eu;ru=1;var t=Uc(),n=Qc(),e=os(),r=Dn();return eu=function(o,i){return(r(o)?t:e)(o,n(i,3))}}function us(){if(su)return cu;su=1;var t=iu?ou:(iu=1,ou=function(t,n,e,r){var o=-1,i=null==t?0:t.length;for(r&&i&&(e=t[++o]);++o<i;)e=n(e,t[o],o,t);return e}),n=kc(),e=Qc(),r=au?uu:(au=1,uu=function(t,n,e,r,o){return o(t,(function(t,o,i){e=r?(r=!1,t):n(e,t,o,i)})),e}),o=Dn();return cu=function(i,u,a){var c=o(i)?t:r,s=arguments.length<3;return c(i,e(u,4),a,s,n)},cu}function as(){if(bu)return mu;bu=1;var t=function(){if(lu)return du;lu=1;var t=Xc()("length");return du=t}(),n=function(){if(pu)return vu;pu=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return vu=function(n){return t.test(n)}}(),e=function(){if(yu)return gu;yu=1;var t="\\ud800-\\udfff",n="["+t+"]",e="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",a="(?:"+e+"|"+r+")?",c="[\\ufe0e\\ufe0f]?",s=c+a+"(?:\\u200d(?:"+[o,i,u].join("|")+")"+c+a+")*",f="(?:"+[o+e+"?",e,i,u,n].join("|")+")",h=RegExp(r+"(?="+r+")|"+f+s,"g");return gu=function(t){for(var n=h.lastIndex=0;h.test(t);)++n;return n}}();return mu=function(r){return n(r)?e(r):t(r)}}function cs(){if(_u)return wu;_u=1;var t=Pe(),n=hc(),e=Be(),r=function(){if(hu)return fu;hu=1;var t=xn(),n=Dn(),e=Fn();return fu=function(r){return"string"==typeof r||!n(r)&&e(r)&&"[object String]"==t(r)}}(),o=as();return wu=function(i){if(null==i)return 0;if(e(i))return r(i)?o(i):i.length;var u=n(i);return"[object Map]"==u||"[object Set]"==u?i.size:t(i).length}}function ss(){if(Eu)return xu;Eu=1;var t=Ln(),n=gc(),e=jc(),r=Qc(),o=uc(),i=Dn(),u=te(),a=jn(),c=En(),s=Ae();return xu=function(f,h,d){var l=i(f),v=l||u(f)||s(f);if(h=r(h,4),null==d){var p=f&&f.constructor;d=v?l?new p:[]:c(f)&&a(p)?n(o(f)):{}}return(v?t:e)(f,(function(t,n,e){return h(d,t,n,e)})),d}}function fs(){if(Ou)return Nu;Ou=1;var t=ic(),n=function(){if(ku)return ju;ku=1;var t=_n(),n=Rn(),e=Dn(),r=t?t.isConcatSpreadable:void 0;return ju=function(t){return e(t)||n(t)||!!(r&&t&&t[r])}}();return Nu=function e(r,o,i,u,a){var c=-1,s=r.length;for(i||(i=n),a||(a=[]);++c<s;){var f=r[c];o>0&&i(f)?o>1?e(f,o-1,i,u,a):t(a,f):u||(a[a.length]=f)}return a},Nu}function hs(){if(Su)return zu;Su=1;var t=Iu?Mu:(Iu=1,Mu=function(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2])}return t.apply(n,e)}),n=Math.max;return zu=function(e,r,o){return r=n(void 0===r?e.length-1:r,0),function(){for(var i=arguments,u=-1,a=n(i.length-r,0),c=Array(a);++u<a;)c[u]=i[r+u];u=-1;for(var s=Array(r+1);++u<r;)s[u]=i[u];return s[r]=o(c),t(e,this,s)}},zu}function ds(){if(Pu)return $u;Pu=1;var t=function(){if(Au)return Cu;Au=1;var t=xc(),n=Tn(),e=Nc();return Cu=n?function(e,r){return n(e,"toString",{configurable:!0,enumerable:!1,value:t(r),writable:!0})}:e}(),n=function(){if(Tu)return Lu;Tu=1;var t=Date.now;return Lu=function(n){var e=0,r=0;return function(){var o=t(),i=16-(o-r);if(r=o,i>0){if(++e>=800)return arguments[0]}else e=0;return n.apply(void 0,arguments)}},Lu}(),e=n(t);return $u=e}function ls(){if(Fu)return Bu;Fu=1;var t=Nc(),n=hs(),e=ds();return Bu=function(r,o){return e(n(r,o,t),r+"")}}function vs(){if(Du)return Ru;return Du=1,Ru=function(t,n,e,r){for(var o=t.length,i=e+(r?1:-1);r?i--:++i<o;)if(n(t[i],i,t))return i;return-1}}function ps(){if(Wu)return qu;Wu=1;var t=vs(),n=Uu?Gu:(Uu=1,Gu=function(t){return t!=t}),e=Vu?Hu:(Vu=1,Hu=function(t,n,e){for(var r=e-1,o=t.length;++r<o;)if(t[r]===n)return r;return-1});return qu=function(r,o,i){return o==o?e(r,o,i):t(r,n,i)}}function gs(){if(na)return ta;na=1;var t=fc(),n=Qu?Ju:(Qu=1,Ju=function(){}),e=Ac(),r=t&&1/e(new t([,-0]))[1]==1/0?function(n){return new t(n)}:n;return ta=r}function ys(){if(ra)return ea;ra=1;var t=zc(),n=function(){if(Zu)return Yu;Zu=1;var t=ps();return Yu=function(n,e){return!(null==n||!n.length)&&t(n,e,0)>-1}}(),e=Xu?Ku:(Xu=1,Ku=function(t,n,e){for(var r=-1,o=null==t?0:t.length;++r<o;)if(e(n,t[r]))return!0;return!1}),r=Sc(),o=gs(),i=Ac();return ea=function(u,a,c){var s=-1,f=n,h=u.length,d=!0,l=[],v=l;if(c)d=!1,f=e;else if(h>=200){var p=a?null:o(u);if(p)return i(p);d=!1,f=r,v=new t}else v=a?[]:l;t:for(;++s<h;){var g=u[s],y=a?a(g):g;if(g=c||0!==g?g:0,d&&y==y){for(var m=v.length;m--;)if(v[m]===y)continue t;a&&v.push(y),l.push(g)}else f(v,y,c)||(v!==l&&v.push(y),l.push(g))}return l}}function ms(){if(ia)return oa;ia=1;var t=Be(),n=Fn();return oa=function(e){return n(e)&&t(e)}}function bs(){if(aa)return ua;aa=1;var t=fs(),n=ls(),e=ys(),r=ms(),o=n((function(n){return e(t(n,1,r,!0))}));return ua=o}function ws(){if(ha)return fa;ha=1;var t=function(){if(sa)return ca;sa=1;var t=Uc();return ca=function(n,e){return t(e,(function(t){return n[t]}))}}(),n=Fe();return fa=function(e){return null==e?[]:t(e,n(e))}}function _s(){if(la)return da;var t;la=1;try{t={clone:_c(),constant:xc(),each:Ic(),filter:ts(),has:ns(),isArray:Dn(),isEmpty:es(),isFunction:jn(),isUndefined:rs(),keys:Fe(),map:is(),reduce:us(),size:cs(),transform:ss(),union:bs(),values:ws()}}catch(t){}return t||(t=window._),da=t}function xs(){if(pa)return va;pa=1;var t=_s();va=o;var n="\0",e="\0",r="";function o(n){this._isDirected=!t.has(n,"directed")||n.directed,this._isMultigraph=!!t.has(n,"multigraph")&&n.multigraph,this._isCompound=!!t.has(n,"compound")&&n.compound,this._label=void 0,this._defaultNodeLabelFn=t.constant(void 0),this._defaultEdgeLabelFn=t.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function i(t,n){t[n]?t[n]++:t[n]=1}function u(t,n){--t[n]||delete t[n]}function a(e,o,i,u){var a=""+o,c=""+i;if(!e&&a>c){var s=a;a=c,c=s}return a+r+c+r+(t.isUndefined(u)?n:u)}function c(t,n){return a(t,n.v,n.w,n.name)}return o.prototype._nodeCount=0,o.prototype._edgeCount=0,o.prototype.isDirected=function(){return this._isDirected},o.prototype.isMultigraph=function(){return this._isMultigraph},o.prototype.isCompound=function(){return this._isCompound},o.prototype.setGraph=function(t){return this._label=t,this},o.prototype.graph=function(){return this._label},o.prototype.setDefaultNodeLabel=function(n){return t.isFunction(n)||(n=t.constant(n)),this._defaultNodeLabelFn=n,this},o.prototype.nodeCount=function(){return this._nodeCount},o.prototype.nodes=function(){return t.keys(this._nodes)},o.prototype.sources=function(){var n=this;return t.filter(this.nodes(),(function(e){return t.isEmpty(n._in[e])}))},o.prototype.sinks=function(){var n=this;return t.filter(this.nodes(),(function(e){return t.isEmpty(n._out[e])}))},o.prototype.setNodes=function(n,e){var r=arguments,o=this;return t.each(n,(function(t){r.length>1?o.setNode(t,e):o.setNode(t)})),this},o.prototype.setNode=function(n,r){return t.has(this._nodes,n)?(arguments.length>1&&(this._nodes[n]=r),this):(this._nodes[n]=arguments.length>1?r:this._defaultNodeLabelFn(n),this._isCompound&&(this._parent[n]=e,this._children[n]={},this._children[e][n]=!0),this._in[n]={},this._preds[n]={},this._out[n]={},this._sucs[n]={},++this._nodeCount,this)},o.prototype.node=function(t){return this._nodes[t]},o.prototype.hasNode=function(n){return t.has(this._nodes,n)},o.prototype.removeNode=function(n){var e=this;if(t.has(this._nodes,n)){var r=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[n],this._isCompound&&(this._removeFromParentsChildList(n),delete this._parent[n],t.each(this.children(n),(function(t){e.setParent(t)})),delete this._children[n]),t.each(t.keys(this._in[n]),r),delete this._in[n],delete this._preds[n],t.each(t.keys(this._out[n]),r),delete this._out[n],delete this._sucs[n],--this._nodeCount}return this},o.prototype.setParent=function(n,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(t.isUndefined(r))r=e;else{for(var o=r+="";!t.isUndefined(o);o=this.parent(o))if(o===n)throw new Error("Setting "+r+" as parent of "+n+" would create a cycle");this.setNode(r)}return this.setNode(n),this._removeFromParentsChildList(n),this._parent[n]=r,this._children[r][n]=!0,this},o.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},o.prototype.parent=function(t){if(this._isCompound){var n=this._parent[t];if(n!==e)return n}},o.prototype.children=function(n){if(t.isUndefined(n)&&(n=e),this._isCompound){var r=this._children[n];if(r)return t.keys(r)}else{if(n===e)return this.nodes();if(this.hasNode(n))return[]}},o.prototype.predecessors=function(n){var e=this._preds[n];if(e)return t.keys(e)},o.prototype.successors=function(n){var e=this._sucs[n];if(e)return t.keys(e)},o.prototype.neighbors=function(n){var e=this.predecessors(n);if(e)return t.union(e,this.successors(n))},o.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},o.prototype.filterNodes=function(n){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var r=this;t.each(this._nodes,(function(t,r){n(r)&&e.setNode(r,t)})),t.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,r.edge(t))}));var o={};function i(t){var n=r.parent(t);return void 0===n||e.hasNode(n)?(o[t]=n,n):n in o?o[n]:i(n)}return this._isCompound&&t.each(e.nodes(),(function(t){e.setParent(t,i(t))})),e},o.prototype.setDefaultEdgeLabel=function(n){return t.isFunction(n)||(n=t.constant(n)),this._defaultEdgeLabelFn=n,this},o.prototype.edgeCount=function(){return this._edgeCount},o.prototype.edges=function(){return t.values(this._edgeObjs)},o.prototype.setPath=function(n,e){var r=this,o=arguments;return t.reduce(n,(function(t,n){return o.length>1?r.setEdge(t,n,e):r.setEdge(t,n),n})),this},o.prototype.setEdge=function(){var n,e,r,o,u=!1,c=arguments[0];"object"==typeof c&&null!==c&&"v"in c?(n=c.v,e=c.w,r=c.name,2===arguments.length&&(o=arguments[1],u=!0)):(n=c,e=arguments[1],r=arguments[3],arguments.length>2&&(o=arguments[2],u=!0)),n=""+n,e=""+e,t.isUndefined(r)||(r=""+r);var s=a(this._isDirected,n,e,r);if(t.has(this._edgeLabels,s))return u&&(this._edgeLabels[s]=o),this;if(!t.isUndefined(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(n),this.setNode(e),this._edgeLabels[s]=u?o:this._defaultEdgeLabelFn(n,e,r);var f=function(t,n,e,r){var o=""+n,i=""+e;if(!t&&o>i){var u=o;o=i,i=u}var a={v:o,w:i};r&&(a.name=r);return a}(this._isDirected,n,e,r);return n=f.v,e=f.w,Object.freeze(f),this._edgeObjs[s]=f,i(this._preds[e],n),i(this._sucs[n],e),this._in[e][s]=f,this._out[n][s]=f,this._edgeCount++,this},o.prototype.edge=function(t,n,e){var r=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,t,n,e);return this._edgeLabels[r]},o.prototype.hasEdge=function(n,e,r){var o=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,n,e,r);return t.has(this._edgeLabels,o)},o.prototype.removeEdge=function(t,n,e){var r=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,t,n,e),o=this._edgeObjs[r];return o&&(t=o.v,n=o.w,delete this._edgeLabels[r],delete this._edgeObjs[r],u(this._preds[n],t),u(this._sucs[t],n),delete this._in[n][r],delete this._out[t][r],this._edgeCount--),this},o.prototype.inEdges=function(n,e){var r=this._in[n];if(r){var o=t.values(r);return e?t.filter(o,(function(t){return t.v===e})):o}},o.prototype.outEdges=function(n,e){var r=this._out[n];if(r){var o=t.values(r);return e?t.filter(o,(function(t){return t.w===e})):o}},o.prototype.nodeEdges=function(t,n){var e=this.inEdges(t,n);if(e)return e.concat(this.outEdges(t,n))},va}function Es(){return ba?ma:(ba=1,ma={Graph:xs(),version:ya?ga:(ya=1,ga="2.1.8")})}function js(){if(_a)return wa;_a=1;var t=_s(),n=xs();function e(n){return t.map(n.nodes(),(function(e){var r=n.node(e),o=n.parent(e),i={v:e};return t.isUndefined(r)||(i.value=r),t.isUndefined(o)||(i.parent=o),i}))}function r(n){return t.map(n.edges(),(function(e){var r=n.edge(e),o={v:e.v,w:e.w};return t.isUndefined(e.name)||(o.name=e.name),t.isUndefined(r)||(o.value=r),o}))}return wa={write:function(n){var o={options:{directed:n.isDirected(),multigraph:n.isMultigraph(),compound:n.isCompound()},nodes:e(n),edges:r(n)};t.isUndefined(n.graph())||(o.value=t.clone(n.graph()));return o},read:function(e){var r=new n(e.options).setGraph(e.value);return t.each(e.nodes,(function(t){r.setNode(t.v,t.value),t.parent&&r.setParent(t.v,t.parent)})),t.each(e.edges,(function(t){r.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),r}}}function ks(){if(Ea)return xa;Ea=1;var t=_s();return xa=function(n){var e,r={},o=[];function i(o){t.has(r,o)||(r[o]=!0,e.push(o),t.each(n.successors(o),i),t.each(n.predecessors(o),i))}return t.each(n.nodes(),(function(t){e=[],i(t),e.length&&o.push(e)})),o},xa}function Ns(){if(ka)return ja;ka=1;var t=_s();function n(){this._arr=[],this._keyIndices={}}return ja=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},n.prototype.has=function(n){return t.has(this._keyIndices,n)},n.prototype.priority=function(t){var n=this._keyIndices[t];if(void 0!==n)return this._arr[n].priority},n.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(n,e){var r=this._keyIndices;if(n=String(n),!t.has(r,n)){var o=this._arr,i=o.length;return r[n]=i,o.push({key:n,priority:e}),this._decrease(i),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},n.prototype.decrease=function(t,n){var e=this._keyIndices[t];if(n>this._arr[e].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[e].priority+" New: "+n);this._arr[e].priority=n,this._decrease(e)},n.prototype._heapify=function(t){var n=this._arr,e=2*t,r=e+1,o=t;e<n.length&&(o=n[e].priority<n[o].priority?e:o,r<n.length&&(o=n[r].priority<n[o].priority?r:o),o!==t&&(this._swap(t,o),this._heapify(o)))},n.prototype._decrease=function(t){for(var n,e=this._arr,r=e[t].priority;0!==t&&!(e[n=t>>1].priority<r);)this._swap(t,n),t=n},n.prototype._swap=function(t,n){var e=this._arr,r=this._keyIndices,o=e[t],i=e[n];e[t]=i,e[n]=o,r[i.key]=t,r[o.key]=n},ja}function Os(){if(Oa)return Na;Oa=1;var t=_s(),n=Ns();Na=function(t,r,o,i){return function(t,e,r,o){var i,u,a={},c=new n,s=function(t){var n=t.v!==i?t.v:t.w,e=a[n],o=r(t),s=u.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+o);s<e.distance&&(e.distance=s,e.predecessor=i,c.decrease(n,s))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;a[t]={distance:n},c.add(t,n)}));for(;c.size()>0&&(i=c.removeMin(),(u=a[i]).distance!==Number.POSITIVE_INFINITY);)o(i).forEach(s);return a}(t,String(r),o||e,i||function(n){return t.outEdges(n)})};var e=t.constant(1);return Na}function Ms(){if(Ia)return Ma;Ia=1;var t=Os(),n=_s();return Ma=function(e,r,o){return n.transform(e.nodes(),(function(n,i){n[i]=t(e,i,r,o)}),{})}}function Is(){if(Sa)return za;Sa=1;var t=_s();return za=function(n){var e=0,r=[],o={},i=[];function u(a){var c=o[a]={onStack:!0,lowlink:e,index:e++};if(r.push(a),n.successors(a).forEach((function(n){t.has(o,n)?o[n].onStack&&(c.lowlink=Math.min(c.lowlink,o[n].index)):(u(n),c.lowlink=Math.min(c.lowlink,o[n].lowlink))})),c.lowlink===c.index){var s,f=[];do{s=r.pop(),o[s].onStack=!1,f.push(s)}while(a!==s);i.push(f)}}return n.nodes().forEach((function(n){t.has(o,n)||u(n)})),i},za}function zs(){if(Aa)return Ca;Aa=1;var t=_s(),n=Is();return Ca=function(e){return t.filter(n(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}}function Ss(){if(Ta)return La;Ta=1;var t=_s();La=function(t,e,r){return function(t,n,e){var r={},o=t.nodes();return o.forEach((function(t){r[t]={},r[t][t]={distance:0},o.forEach((function(n){t!==n&&(r[t][n]={distance:Number.POSITIVE_INFINITY})})),e(t).forEach((function(e){var o=e.v===t?e.w:e.v,i=n(e);r[t][o]={distance:i,predecessor:t}}))})),o.forEach((function(t){var n=r[t];o.forEach((function(e){var i=r[e];o.forEach((function(e){var r=i[t],o=n[e],u=i[e],a=r.distance+o.distance;a<u.distance&&(u.distance=a,u.predecessor=o.predecessor)}))}))})),r}(t,e||n,r||function(n){return t.outEdges(n)})};var n=t.constant(1);return La}function Cs(){if(Pa)return $a;Pa=1;var t=_s();function n(n){var r={},o={},i=[];if(t.each(n.sinks(),(function u(a){if(t.has(o,a))throw new e;t.has(r,a)||(o[a]=!0,r[a]=!0,t.each(n.predecessors(a),u),delete o[a],i.push(a))})),t.size(r)!==n.nodeCount())throw new e;return i}function e(){}return $a=n,n.CycleException=e,e.prototype=new Error,$a}function As(){if(Fa)return Ba;Fa=1;var t=Cs();return Ba=function(n){try{t(n)}catch(n){if(n instanceof t.CycleException)return!1;throw n}return!0}}function Ls(){if(Da)return Ra;Da=1;var t=_s();function n(e,r,o,i,u,a){t.has(i,r)||(i[r]=!0,o||a.push(r),t.each(u(r),(function(t){n(e,t,o,i,u,a)})),o&&a.push(r))}return Ra=function(e,r,o){t.isArray(r)||(r=[r]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),u=[],a={};return t.each(r,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);n(e,t,"post"===o,a,i,u)})),u},Ra}function Ts(){if(Ua)return Ga;Ua=1;var t=Ls();return Ga=function(n,e){return t(n,e,"post")}}function $s(){if(Va)return Ha;Va=1;var t=Ls();return Ha=function(n,e){return t(n,e,"pre")}}function Ps(){if(Wa)return qa;Wa=1;var t=_s(),n=xs(),e=Ns();return qa=function(r,o){var i,u=new n,a={},c=new e;function s(t){var n=t.v===i?t.w:t.v,e=c.priority(n);if(void 0!==e){var r=o(t);r<e&&(a[n]=i,c.decrease(n,r))}}if(0===r.nodeCount())return u;t.each(r.nodes(),(function(t){c.add(t,Number.POSITIVE_INFINITY),u.setNode(t)})),c.decrease(r.nodes()[0],0);var f=!1;for(;c.size()>0;){if(i=c.removeMin(),t.has(a,i))u.setEdge(i,a[i]);else{if(f)throw new Error("Input graph is not connected: "+r);f=!0}r.nodeEdges(i).forEach(s)}return u}}Qa.exports;try{Ja=function(){if(Xa)return Ka;Xa=1;var t=Es();return Ka={Graph:t.Graph,json:js(),alg:Za?Ya:(Za=1,Ya={components:ks(),dijkstra:Os(),dijkstraAll:Ms(),findCycles:zs(),floydWarshall:Ss(),isAcyclic:As(),postorder:Ts(),preorder:$s(),prim:Ps(),tarjan:Is(),topsort:Cs()}),version:t.version}}()}catch(t){}Ja||(Ja=window.graphlib);var Bs,Fs,Rs,Ds,Gs,Us,Hs,Vs,qs,Ws,Ys,Zs,Ks,Xs,Js,Qs,tf,nf,ef,rf,of,uf,af,cf,sf,ff,hf,df,lf,vf,pf,gf,yf,mf,bf,wf,_f,xf,Ef,jf,kf,Nf,Of,Mf,If,zf,Sf,Cf,Af,Lf,Tf,$f,Pf,Bf,Ff,Rf,Df,Gf,Uf,Hf,Vf,qf,Wf,Yf,Zf,Kf,Xf,Jf,Qf,th,nh,eh,rh,oh,ih,uh,ah,ch,sh,fh,hh,dh,lh,vh,ph,gh,yh,mh,bh,wh,_h,xh,Eh,jh=Ja;function kh(){if(Ds)return Rs;Ds=1;var t=gn(),n=Be(),e=ne(),r=En();return Rs=function(o,i,u){if(!r(u))return!1;var a=typeof i;return!!("number"==a?n(u)&&e(i,u.length):"string"==a&&i in u)&&t(u[i],o)}}function Nh(){if(Zs)return Ys;Zs=1;var t=function(){if(Ws)return qs;Ws=1;var t=/\s/;return qs=function(n){for(var e=n.length;e--&&t.test(n.charAt(e)););return e}}(),n=/^\s+/;return Ys=function(e){return e?e.slice(0,t(e)+1).replace(n,""):e}}function Oh(){if(Qs)return Js;Qs=1;var t=function(){if(Xs)return Ks;Xs=1;var t=Nh(),n=En(),e=Rc(),r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,u=parseInt;return Ks=function(a){if("number"==typeof a)return a;if(e(a))return NaN;if(n(a)){var c="function"==typeof a.valueOf?a.valueOf():a;a=n(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=t(a);var s=o.test(a);return s||i.test(a)?u(a.slice(2),s?2:8):r.test(a)?NaN:+a}}(),n=1/0;return Js=function(e){return e?(e=t(e))===n||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}}function Mh(){if(rf)return ef;rf=1;var t=vs(),n=Qc(),e=function(){if(nf)return tf;nf=1;var t=Oh();return tf=function(n){var e=t(n),r=e%1;return e==e?r?e-r:e:0}}(),r=Math.max;return ef=function(o,i,u){var a=null==o?0:o.length;if(!a)return-1;var c=null==u?0:e(u);return c<0&&(c=r(a+c,0)),t(o,n(i,3),c)}}function Ih(){if(cf)return af;cf=1;var t=fs();return af=function(n){return(null==n?0:n.length)?t(n,1):[]}}function zh(){if(gf)return pf;gf=1;var t=Rc();return pf=function(n,e,r){for(var o=-1,i=n.length;++o<i;){var u=n[o],a=e(u);if(null!=a&&(void 0===c?a==a&&!t(a):r(a,c)))var c=a,s=u}return s}}function Sh(){if(xf)return _f;xf=1;var t=$n(),n=gn();return _f=function(e,r,o){(void 0!==o&&!n(e[r],o)||void 0===o&&!(r in e))&&t(e,r,o)}}function Ch(){if(Nf)return kf;return Nf=1,kf=function(t,n){if(("constructor"!==n||"function"!=typeof t[n])&&"__proto__"!=n)return t[n]}}function Ah(){if(zf)return If;zf=1;var t=Sh(),n=tc(),e=vc(),r=nc(),o=yc(),i=Rn(),u=Dn(),a=ms(),c=te(),s=jn(),f=En(),h=function(){if(jf)return Ef;jf=1;var t=xn(),n=uc(),e=Fn(),r=Function.prototype,o=Object.prototype,i=r.toString,u=o.hasOwnProperty,a=i.call(Object);return Ef=function(r){if(!e(r)||"[object Object]"!=t(r))return!1;var o=n(r);if(null===o)return!0;var c=u.call(o,"constructor")&&o.constructor;return"function"==typeof c&&c instanceof c&&i.call(c)==a}}(),d=Ae(),l=Ch(),v=function(){if(Mf)return Of;Mf=1;var t=Bn(),n=De();return Of=function(e){return t(e,n(e))}}();return If=function(p,g,y,m,b,w,_){var x=l(p,y),E=l(g,y),j=_.get(E);if(j)t(p,y,j);else{var k=w?w(x,E,y+"",p,g,_):void 0,N=void 0===k;if(N){var O=u(E),M=!O&&c(E),I=!O&&!M&&d(E);k=E,O||M||I?u(x)?k=x:a(x)?k=r(x):M?(N=!1,k=n(E,!0)):I?(N=!1,k=e(E,!0)):k=[]:h(E)||i(E)?(k=x,i(x)?k=v(x):f(x)&&!s(x)||(k=o(E))):N=!1}N&&(_.set(E,k),b(k,E,m,w,_),_.delete(E)),t(p,y,k)}}}function Lh(){if(Bf)return Pf;return Bf=1,Pf=function(t,n){return t<n}}function Th(){if(Yf)return Wf;Yf=1;var t=Wc(),n=function(){if(qf)return Vf;qf=1;var t=Pn(),n=Vc(),e=ne(),r=En(),o=qc();return Vf=function(i,u,a,c){if(!r(i))return i;for(var s=-1,f=(u=n(u,i)).length,h=f-1,d=i;null!=d&&++s<f;){var l=o(u[s]),v=a;if("__proto__"===l||"constructor"===l||"prototype"===l)return i;if(s!=h){var p=d[l];void 0===(v=c?c(p,l,d):void 0)&&(v=r(p)?p:e(u[s+1])?[]:{})}t(d,l,v),d=d[l]}return i}}(),e=Vc();return Wf=function(r,o,i){for(var u=-1,a=o.length,c={};++u<a;){var s=o[u],f=t(r,s);i(f,s)&&n(c,e(s,r),f)}return c}}function $h(){if(oh)return rh;oh=1;var t=function(){if(eh)return nh;eh=1;var t=Math.ceil,n=Math.max;return nh=function(e,r,o,i){for(var u=-1,a=n(t((r-e)/(o||1)),0),c=Array(a);a--;)c[i?a:++u]=e,e+=o;return c}}(),n=kh(),e=Oh();return rh=function(r){return function(o,i,u){return u&&"number"!=typeof u&&n(o,i,u)&&(i=u=void 0),o=e(o),void 0===i?(i=o,o=0):i=e(i),u=void 0===u?o<i?1:-1:e(u),t(o,i,u,r)}}}function Ph(){if(dh)return hh;dh=1;var t=function(){if(fh)return sh;fh=1;var t=Rc();return sh=function(n,e){if(n!==e){var r=void 0!==n,o=null===n,i=n==n,u=t(n),a=void 0!==e,c=null===e,s=e==e,f=t(e);if(!c&&!f&&!u&&n>e||u&&a&&s&&!c&&!f||o&&a&&s||!r&&s||!i)return 1;if(!o&&!u&&!f&&n<e||f&&r&&i&&!o&&!u||c&&r&&i||!a&&i||!s)return-1}return 0}}();return hh=function(n,e,r){for(var o=-1,i=n.criteria,u=e.criteria,a=i.length,c=r.length;++o<a;){var s=t(i[o],u[o]);if(s)return o>=c?s:s*("desc"==r[o]?-1:1)}return n.index-e.index}}function Bh(){if(vh)return lh;vh=1;var t=Uc(),n=Wc(),e=Qc(),r=os(),o=ch?ah:(ch=1,ah=function(t,n){var e=t.length;for(t.sort(n);e--;)t[e]=t[e].value;return t}),i=re(),u=Ph(),a=Nc(),c=Dn();return lh=function(s,f,h){f=f.length?t(f,(function(t){return c(t)?function(e){return n(e,1===t.length?t[0]:t)}:t})):[a];var d=-1;f=t(f,i(e));var l=r(s,(function(n,e,r){return{criteria:t(f,(function(t){return t(n)})),index:++d,value:n}}));return o(l,(function(t,n){return u(t,n,h)}))}}try{Eh={cloneDeep:function(){if(Fs)return Bs;Fs=1;var t=wc();return Bs=function(n){return t(n,5)}}(),constant:xc(),defaults:function(){if(Us)return Gs;Us=1;var t=ls(),n=gn(),e=kh(),r=De(),o=Object.prototype,i=o.hasOwnProperty,u=t((function(t,u){t=Object(t);var a=-1,c=u.length,s=c>2?u[2]:void 0;for(s&&e(u[0],u[1],s)&&(c=1);++a<c;)for(var f=u[a],h=r(f),d=-1,l=h.length;++d<l;){var v=h[d],p=t[v];(void 0===p||n(p,o[v])&&!i.call(t,v))&&(t[v]=f[v])}return t}));return Gs=u}(),each:Ic(),filter:ts(),find:function(){if(uf)return of;uf=1;var t=function(){if(Vs)return Hs;Vs=1;var t=Qc(),n=Be(),e=Fe();return Hs=function(r){return function(o,i,u){var a=Object(o);if(!n(o)){var c=t(i,3);o=e(o),i=function(t){return c(a[t],t,a)}}var s=r(o,i,u);return s>-1?a[c?o[s]:s]:void 0}}}()(Mh());return of=t}(),flatten:Ih(),forEach:Mc(),forIn:function(){if(ff)return sf;ff=1;var t=Ec(),n=Oc(),e=De();return sf=function(r,o){return null==r?r:t(r,n(o),e)}}(),has:ns(),isUndefined:rs(),last:df?hf:(df=1,hf=function(t){var n=null==t?0:t.length;return n?t[n-1]:void 0}),map:is(),mapValues:function(){if(vf)return lf;vf=1;var t=$n(),n=jc(),e=Qc();return lf=function(r,o){var i={};return o=e(o,3),n(r,(function(n,e,r){t(i,e,o(n,e,r))})),i}}(),max:function(){if(wf)return bf;wf=1;var t=zh(),n=mf?yf:(mf=1,yf=function(t,n){return t>n}),e=Nc();return bf=function(r){return r&&r.length?t(r,e,n):void 0}}(),merge:function(){if($f)return Tf;$f=1;var t=function(){if(Cf)return Sf;Cf=1;var t=An(),n=Sh(),e=Ec(),r=Ah(),o=En(),i=De(),u=Ch();return Sf=function a(c,s,f,h,d){c!==s&&e(s,(function(e,i){if(d||(d=new t),o(e))r(c,s,i,f,a,h,d);else{var l=h?h(u(c,i),e,i+"",c,s,d):void 0;void 0===l&&(l=e),n(c,i,l)}}),i)},Sf}(),n=function(){if(Lf)return Af;Lf=1;var t=ls(),n=kh();return Af=function(e){return t((function(t,r){var o=-1,i=r.length,u=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(u=e.length>3&&"function"==typeof u?(i--,u):void 0,a&&n(r[0],r[1],a)&&(u=i<3?void 0:u,i=1),t=Object(t);++o<i;){var c=r[o];c&&e(t,c,o,u)}return t}))}}()((function(n,e,r){t(n,e,r)}));return Tf=n}(),min:function(){if(Rf)return Ff;Rf=1;var t=zh(),n=Lh(),e=Nc();return Ff=function(r){return r&&r.length?t(r,e,n):void 0}}(),minBy:function(){if(Gf)return Df;Gf=1;var t=zh(),n=Qc(),e=Lh();return Df=function(r,o){return r&&r.length?t(r,n(o,2),e):void 0}}(),now:function(){if(Hf)return Uf;Hf=1;var t=wn();return Uf=function(){return t.Date.now()}}(),pick:function(){if(th)return Qf;th=1;var t=function(){if(Kf)return Zf;Kf=1;var t=Th(),n=Zc();return Zf=function(e,r){return t(e,r,(function(t,r){return n(e,r)}))}}(),n=function(){if(Jf)return Xf;Jf=1;var t=Ih(),n=hs(),e=ds();return Xf=function(r){return e(n(r,void 0,t),r+"")}}()((function(n,e){return null==n?{}:t(n,e)}));return Qf=n}(),range:function(){if(uh)return ih;uh=1;var t=$h()();return ih=t}(),reduce:us(),sortBy:function(){if(gh)return ph;gh=1;var t=fs(),n=Bh(),e=ls(),r=kh(),o=e((function(e,o){if(null==e)return[];var i=o.length;return i>1&&r(e,o[0],o[1])?o=[]:i>2&&r(o[0],o[1],o[2])&&(o=[o[0]]),n(e,t(o,1),[])}));return ph=o}(),uniqueId:function(){if(mh)return yh;mh=1;var t=Hc(),n=0;return yh=function(e){var r=++n;return t(e)+r}}(),values:ws(),zipObject:function(){if(xh)return _h;xh=1;var t=Pn(),n=wh?bh:(wh=1,bh=function(t,n,e){for(var r=-1,o=t.length,i=n.length,u={};++r<o;){var a=r<i?n[r]:void 0;e(u,t[r],a)}return u});return _h=function(e,r){return n(e||[],r||[],t)}}()}}catch(t){}Eh||(Eh=window._);var Fh=Eh,Rh=Dh;function Dh(){var t={};t._next=t._prev=t,this._sentinel=t}function Gh(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function Uh(t,n){if("_next"!==t&&"_prev"!==t)return n}Dh.prototype.dequeue=function(){var t=this._sentinel,n=t._prev;if(n!==t)return Gh(n),n},Dh.prototype.enqueue=function(t){var n=this._sentinel;t._prev&&t._next&&Gh(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n},Dh.prototype.toString=function(){for(var t=[],n=this._sentinel,e=n._prev;e!==n;)t.push(JSON.stringify(e,Uh)),e=e._prev;return"["+t.join(", ")+"]"};var Hh=Fh,Vh=jh.Graph,qh=Rh,Wh=function(t,n){if(t.nodeCount()<=1)return[];var e=function(t,n){var e=new Vh,r=0,o=0;Hh.forEach(t.nodes(),(function(t){e.setNode(t,{v:t,in:0,out:0})})),Hh.forEach(t.edges(),(function(t){var i=e.edge(t.v,t.w)||0,u=n(t),a=i+u;e.setEdge(t.v,t.w,a),o=Math.max(o,e.node(t.v).out+=u),r=Math.max(r,e.node(t.w).in+=u)}));var i=Hh.range(o+r+3).map((function(){return new qh})),u=r+1;return Hh.forEach(e.nodes(),(function(t){Kh(i,u,e.node(t))})),{graph:e,buckets:i,zeroIdx:u}}(t,n||Yh),r=function(t,n,e){var r,o=[],i=n[n.length-1],u=n[0];for(;t.nodeCount();){for(;r=u.dequeue();)Zh(t,n,e,r);for(;r=i.dequeue();)Zh(t,n,e,r);if(t.nodeCount())for(var a=n.length-2;a>0;--a)if(r=n[a].dequeue()){o=o.concat(Zh(t,n,e,r,!0));break}}return o}(e.graph,e.buckets,e.zeroIdx);return Hh.flatten(Hh.map(r,(function(n){return t.outEdges(n.v,n.w)})),!0)},Yh=Hh.constant(1);function Zh(t,n,e,r,o){var i=o?[]:void 0;return Hh.forEach(t.inEdges(r.v),(function(r){var u=t.edge(r),a=t.node(r.v);o&&i.push({v:r.v,w:r.w}),a.out-=u,Kh(n,e,a)})),Hh.forEach(t.outEdges(r.v),(function(r){var o=t.edge(r),i=r.w,u=t.node(i);u.in-=o,Kh(n,e,u)})),t.removeNode(r.v),i}function Kh(t,n,e){e.out?e.in?t[e.out-e.in+n].enqueue(e):t[t.length-1].enqueue(e):t[0].enqueue(e)}var Xh=Fh,Jh=Wh,Qh={run:function(t){var n="greedy"===t.graph().acyclicer?Jh(t,function(t){return function(n){return t.edge(n).weight}}(t)):function(t){var n=[],e={},r={};function o(i){Xh.has(r,i)||(r[i]=!0,e[i]=!0,Xh.forEach(t.outEdges(i),(function(t){Xh.has(e,t.w)?n.push(t):o(t.w)})),delete e[i])}return Xh.forEach(t.nodes(),o),n}(t);Xh.forEach(n,(function(n){var e=t.edge(n);t.removeEdge(n),e.forwardName=n.name,e.reversed=!0,t.setEdge(n.w,n.v,e,Xh.uniqueId("rev"))}))},undo:function(t){Xh.forEach(t.edges(),(function(n){var e=t.edge(n);if(e.reversed){t.removeEdge(n);var r=e.forwardName;delete e.reversed,delete e.forwardName,t.setEdge(n.w,n.v,e,r)}}))}};var td=Fh,nd=jh.Graph,ed={addDummyNode:rd,simplify:function(t){var n=(new nd).setGraph(t.graph());return td.forEach(t.nodes(),(function(e){n.setNode(e,t.node(e))})),td.forEach(t.edges(),(function(e){var r=n.edge(e.v,e.w)||{weight:0,minlen:1},o=t.edge(e);n.setEdge(e.v,e.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})})),n},asNonCompoundGraph:function(t){var n=new nd({multigraph:t.isMultigraph()}).setGraph(t.graph());return td.forEach(t.nodes(),(function(e){t.children(e).length||n.setNode(e,t.node(e))})),td.forEach(t.edges(),(function(e){n.setEdge(e,t.edge(e))})),n},successorWeights:function(t){var n=td.map(t.nodes(),(function(n){var e={};return td.forEach(t.outEdges(n),(function(n){e[n.w]=(e[n.w]||0)+t.edge(n).weight})),e}));return td.zipObject(t.nodes(),n)},predecessorWeights:function(t){var n=td.map(t.nodes(),(function(n){var e={};return td.forEach(t.inEdges(n),(function(n){e[n.v]=(e[n.v]||0)+t.edge(n).weight})),e}));return td.zipObject(t.nodes(),n)},intersectRect:function(t,n){var e,r,o=t.x,i=t.y,u=n.x-o,a=n.y-i,c=t.width/2,s=t.height/2;if(!u&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*c>Math.abs(u)*s?(a<0&&(s=-s),e=s*u/a,r=s):(u<0&&(c=-c),e=c,r=c*a/u);return{x:o+e,y:i+r}},buildLayerMatrix:function(t){var n=td.map(td.range(od(t)+1),(function(){return[]}));return td.forEach(t.nodes(),(function(e){var r=t.node(e),o=r.rank;td.isUndefined(o)||(n[o][r.order]=e)})),n},normalizeRanks:function(t){var n=td.min(td.map(t.nodes(),(function(n){return t.node(n).rank})));td.forEach(t.nodes(),(function(e){var r=t.node(e);td.has(r,"rank")&&(r.rank-=n)}))},removeEmptyRanks:function(t){var n=td.min(td.map(t.nodes(),(function(n){return t.node(n).rank}))),e=[];td.forEach(t.nodes(),(function(r){var o=t.node(r).rank-n;e[o]||(e[o]=[]),e[o].push(r)}));var r=0,o=t.graph().nodeRankFactor;td.forEach(e,(function(n,e){td.isUndefined(n)&&e%o!=0?--r:r&&td.forEach(n,(function(n){t.node(n).rank+=r}))}))},addBorderNode:function(t,n,e,r){var o={width:0,height:0};arguments.length>=4&&(o.rank=e,o.order=r);return rd(t,"border",o,n)},maxRank:od,partition:function(t,n){var e={lhs:[],rhs:[]};return td.forEach(t,(function(t){n(t)?e.lhs.push(t):e.rhs.push(t)})),e},time:function(t,n){var e=td.now();try{return n()}finally{console.log(t+" time: "+(td.now()-e)+"ms")}},notime:function(t,n){return n()}};function rd(t,n,e,r){var o;do{o=td.uniqueId(r)}while(t.hasNode(o));return e.dummy=n,t.setNode(o,e),o}function od(t){return td.max(td.map(t.nodes(),(function(n){var e=t.node(n).rank;if(!td.isUndefined(e))return e})))}var id=Fh,ud=ed,ad={run:function(t){t.graph().dummyChains=[],id.forEach(t.edges(),(function(n){!function(t,n){var e,r,o,i=n.v,u=t.node(i).rank,a=n.w,c=t.node(a).rank,s=n.name,f=t.edge(n),h=f.labelRank;if(c===u+1)return;for(t.removeEdge(n),o=0,++u;u<c;++o,++u)f.points=[],r={width:0,height:0,edgeLabel:f,edgeObj:n,rank:u},e=ud.addDummyNode(t,"edge",r,"_d"),u===h&&(r.width=f.width,r.height=f.height,r.dummy="edge-label",r.labelpos=f.labelpos),t.setEdge(i,e,{weight:f.weight},s),0===o&&t.graph().dummyChains.push(e),i=e;t.setEdge(i,a,{weight:f.weight},s)}(t,n)}))},undo:function(t){id.forEach(t.graph().dummyChains,(function(n){var e,r=t.node(n),o=r.edgeLabel;for(t.setEdge(r.edgeObj,o);r.dummy;)e=t.successors(n)[0],t.removeNode(n),o.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(o.x=r.x,o.y=r.y,o.width=r.width,o.height=r.height),n=e,r=t.node(n)}))}};var cd=Fh,sd={longestPath:function(t){var n={};cd.forEach(t.sources(),(function e(r){var o=t.node(r);if(cd.has(n,r))return o.rank;n[r]=!0;var i=cd.min(cd.map(t.outEdges(r),(function(n){return e(n.w)-t.edge(n).minlen})));return i!==Number.POSITIVE_INFINITY&&null!=i||(i=0),o.rank=i}))},slack:function(t,n){return t.node(n.w).rank-t.node(n.v).rank-t.edge(n).minlen}};var fd=Fh,hd=jh.Graph,dd=sd.slack,ld=function(t){var n,e,r=new hd({directed:!1}),o=t.nodes()[0],i=t.nodeCount();r.setNode(o,{});for(;vd(r,t)<i;)n=pd(r,t),e=r.hasNode(n.v)?dd(t,n):-dd(t,n),gd(r,t,e);return r};function vd(t,n){return fd.forEach(t.nodes(),(function e(r){fd.forEach(n.nodeEdges(r),(function(o){var i=o.v,u=r===i?o.w:i;t.hasNode(u)||dd(n,o)||(t.setNode(u,{}),t.setEdge(r,u,{}),e(u))}))})),t.nodeCount()}function pd(t,n){return fd.minBy(n.edges(),(function(e){if(t.hasNode(e.v)!==t.hasNode(e.w))return dd(n,e)}))}function gd(t,n,e){fd.forEach(t.nodes(),(function(t){n.node(t).rank+=e}))}var yd=Fh,md=ld,bd=sd.slack,wd=sd.longestPath,_d=jh.alg.preorder,xd=jh.alg.postorder,Ed=ed.simplify,jd=kd;function kd(t){t=Ed(t),wd(t);var n,e=md(t);for(Md(e),Nd(e,t);n=zd(e);)Cd(e,t,n,Sd(e,t,n))}function Nd(t,n){var e=xd(t,t.nodes());e=e.slice(0,e.length-1),yd.forEach(e,(function(e){!function(t,n,e){var r=t.node(e),o=r.parent;t.edge(e,o).cutvalue=Od(t,n,e)}(t,n,e)}))}function Od(t,n,e){var r=t.node(e).parent,o=!0,i=n.edge(e,r),u=0;return i||(o=!1,i=n.edge(r,e)),u=i.weight,yd.forEach(n.nodeEdges(e),(function(i){var a,c,s=i.v===e,f=s?i.w:i.v;if(f!==r){var h=s===o,d=n.edge(i).weight;if(u+=h?d:-d,a=e,c=f,t.hasEdge(a,c)){var l=t.edge(e,f).cutvalue;u+=h?-l:l}}})),u}function Md(t,n){arguments.length<2&&(n=t.nodes()[0]),Id(t,{},1,n)}function Id(t,n,e,r,o){var i=e,u=t.node(r);return n[r]=!0,yd.forEach(t.neighbors(r),(function(o){yd.has(n,o)||(e=Id(t,n,e,o,r))})),u.low=i,u.lim=e++,o?u.parent=o:delete u.parent,e}function zd(t){return yd.find(t.edges(),(function(n){return t.edge(n).cutvalue<0}))}function Sd(t,n,e){var r=e.v,o=e.w;n.hasEdge(r,o)||(r=e.w,o=e.v);var i=t.node(r),u=t.node(o),a=i,c=!1;i.lim>u.lim&&(a=u,c=!0);var s=yd.filter(n.edges(),(function(n){return c===Ad(t,t.node(n.v),a)&&c!==Ad(t,t.node(n.w),a)}));return yd.minBy(s,(function(t){return bd(n,t)}))}function Cd(t,n,e,r){var o=e.v,i=e.w;t.removeEdge(o,i),t.setEdge(r.v,r.w,{}),Md(t),Nd(t,n),function(t,n){var e=yd.find(t.nodes(),(function(t){return!n.node(t).parent})),r=_d(t,e);r=r.slice(1),yd.forEach(r,(function(e){var r=t.node(e).parent,o=n.edge(e,r),i=!1;o||(o=n.edge(r,e),i=!0),n.node(e).rank=n.node(r).rank+(i?o.minlen:-o.minlen)}))}(t,n)}function Ad(t,n,e){return e.low<=n.lim&&n.lim<=e.lim}kd.initLowLimValues=Md,kd.initCutValues=Nd,kd.calcCutValue=Od,kd.leaveEdge=zd,kd.enterEdge=Sd,kd.exchangeEdges=Cd;var Ld=sd.longestPath,Td=ld,$d=jd,Pd=function(t){switch(t.graph().ranker){case"network-simplex":default:Fd(t);break;case"tight-tree":!function(t){Ld(t),Td(t)}(t);break;case"longest-path":Bd(t)}};var Bd=Ld;function Fd(t){$d(t)}var Rd=Fh,Dd=function(t){var n=function(t){var n={},e=0;function r(o){var i=e;Rd.forEach(t.children(o),r),n[o]={low:i,lim:e++}}return Rd.forEach(t.children(),r),n}(t);Rd.forEach(t.graph().dummyChains,(function(e){for(var r=t.node(e),o=r.edgeObj,i=function(t,n,e,r){var o,i,u=[],a=[],c=Math.min(n[e].low,n[r].low),s=Math.max(n[e].lim,n[r].lim);o=e;do{o=t.parent(o),u.push(o)}while(o&&(n[o].low>c||s>n[o].lim));i=o,o=r;for(;(o=t.parent(o))!==i;)a.push(o);return{path:u.concat(a.reverse()),lca:i}}(t,n,o.v,o.w),u=i.path,a=i.lca,c=0,s=u[c],f=!0;e!==o.w;){if(r=t.node(e),f){for(;(s=u[c])!==a&&t.node(s).maxRank<r.rank;)c++;s===a&&(f=!1)}if(!f){for(;c<u.length-1&&t.node(s=u[c+1]).minRank<=r.rank;)c++;s=u[c]}t.setParent(e,s),e=t.successors(e)[0]}}))};var Gd=Fh,Ud=ed,Hd={run:function(t){var n=Ud.addDummyNode(t,"root",{},"_root"),e=function(t){var n={};function e(r,o){var i=t.children(r);i&&i.length&&Gd.forEach(i,(function(t){e(t,o+1)})),n[r]=o}return Gd.forEach(t.children(),(function(t){e(t,1)})),n}(t),r=Gd.max(Gd.values(e))-1,o=2*r+1;t.graph().nestingRoot=n,Gd.forEach(t.edges(),(function(n){t.edge(n).minlen*=o}));var i=function(t){return Gd.reduce(t.edges(),(function(n,e){return n+t.edge(e).weight}),0)}(t)+1;Gd.forEach(t.children(),(function(u){Vd(t,n,o,i,r,e,u)})),t.graph().nodeRankFactor=o},cleanup:function(t){var n=t.graph();t.removeNode(n.nestingRoot),delete n.nestingRoot,Gd.forEach(t.edges(),(function(n){t.edge(n).nestingEdge&&t.removeEdge(n)}))}};function Vd(t,n,e,r,o,i,u){var a=t.children(u);if(a.length){var c=Ud.addBorderNode(t,"_bt"),s=Ud.addBorderNode(t,"_bb"),f=t.node(u);t.setParent(c,u),f.borderTop=c,t.setParent(s,u),f.borderBottom=s,Gd.forEach(a,(function(a){Vd(t,n,e,r,o,i,a);var f=t.node(a),h=f.borderTop?f.borderTop:a,d=f.borderBottom?f.borderBottom:a,l=f.borderTop?r:2*r,v=h!==d?1:o-i[u]+1;t.setEdge(c,h,{weight:l,minlen:v,nestingEdge:!0}),t.setEdge(d,s,{weight:l,minlen:v,nestingEdge:!0})})),t.parent(u)||t.setEdge(n,c,{weight:0,minlen:o+i[u]})}else u!==n&&t.setEdge(n,u,{weight:0,minlen:e})}var qd=Fh,Wd=ed,Yd=function(t){qd.forEach(t.children(),(function n(e){var r=t.children(e),o=t.node(e);if(r.length&&qd.forEach(r,n),qd.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,u=o.maxRank+1;i<u;++i)Zd(t,"borderLeft","_bl",e,o,i),Zd(t,"borderRight","_br",e,o,i)}}))};function Zd(t,n,e,r,o,i){var u={width:0,height:0,rank:i,borderType:n},a=o[n][i-1],c=Wd.addDummyNode(t,"border",u,e);o[n][i]=c,t.setParent(c,r),a&&t.setEdge(a,c,{weight:1})}var Kd=Fh,Xd={adjust:function(t){var n=t.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||Jd(t)},undo:function(t){var n=t.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||function(t){Kd.forEach(t.nodes(),(function(n){tl(t.node(n))})),Kd.forEach(t.edges(),(function(n){var e=t.edge(n);Kd.forEach(e.points,tl),Kd.has(e,"y")&&tl(e)}))}(t);"lr"!==n&&"rl"!==n||(!function(t){Kd.forEach(t.nodes(),(function(n){nl(t.node(n))})),Kd.forEach(t.edges(),(function(n){var e=t.edge(n);Kd.forEach(e.points,nl),Kd.has(e,"x")&&nl(e)}))}(t),Jd(t))}};function Jd(t){Kd.forEach(t.nodes(),(function(n){Qd(t.node(n))})),Kd.forEach(t.edges(),(function(n){Qd(t.edge(n))}))}function Qd(t){var n=t.width;t.width=t.height,t.height=n}function tl(t){t.y=-t.y}function nl(t){var n=t.x;t.x=t.y,t.y=n}var el=Fh,rl=function(t){var n={},e=el.filter(t.nodes(),(function(n){return!t.children(n).length})),r=el.max(el.map(e,(function(n){return t.node(n).rank}))),o=el.map(el.range(r+1),(function(){return[]}));function i(e){if(!el.has(n,e)){n[e]=!0;var r=t.node(e);o[r.rank].push(e),el.forEach(t.successors(e),i)}}var u=el.sortBy(e,(function(n){return t.node(n).rank}));return el.forEach(u,i),o};var ol=Fh,il=function(t,n){for(var e=0,r=1;r<n.length;++r)e+=ul(t,n[r-1],n[r]);return e};function ul(t,n,e){for(var r=ol.zipObject(e,ol.map(e,(function(t,n){return n}))),o=ol.flatten(ol.map(n,(function(n){return ol.sortBy(ol.map(t.outEdges(n),(function(n){return{pos:r[n.w],weight:t.edge(n).weight}})),"pos")})),!0),i=1;i<e.length;)i<<=1;var u=2*i-1;i-=1;var a=ol.map(new Array(u),(function(){return 0})),c=0;return ol.forEach(o.forEach((function(t){var n=t.pos+i;a[n]+=t.weight;for(var e=0;n>0;)n%2&&(e+=a[n+1]),a[n=n-1>>1]+=t.weight;c+=t.weight*e}))),c}var al=Fh;var cl=Fh;var sl=Fh,fl=ed;function hl(t,n,e){for(var r;n.length&&(r=sl.last(n)).i<=e;)n.pop(),t.push(r.vs),e++;return e}var dl=Fh,ll=function(t,n){return al.map(n,(function(n){var e=t.inEdges(n);if(e.length){var r=al.reduce(e,(function(n,e){var r=t.edge(e),o=t.node(e.v);return{sum:n.sum+r.weight*o.order,weight:n.weight+r.weight}}),{sum:0,weight:0});return{v:n,barycenter:r.sum/r.weight,weight:r.weight}}return{v:n}}))},vl=function(t,n){var e={};return cl.forEach(t,(function(t,n){var r=e[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:n};cl.isUndefined(t.barycenter)||(r.barycenter=t.barycenter,r.weight=t.weight)})),cl.forEach(n.edges(),(function(t){var n=e[t.v],r=e[t.w];cl.isUndefined(n)||cl.isUndefined(r)||(r.indegree++,n.out.push(e[t.w]))})),function(t){var n=[];function e(t){return function(n){n.merged||(cl.isUndefined(n.barycenter)||cl.isUndefined(t.barycenter)||n.barycenter>=t.barycenter)&&function(t,n){var e=0,r=0;t.weight&&(e+=t.barycenter*t.weight,r+=t.weight);n.weight&&(e+=n.barycenter*n.weight,r+=n.weight);t.vs=n.vs.concat(t.vs),t.barycenter=e/r,t.weight=r,t.i=Math.min(n.i,t.i),n.merged=!0}(t,n)}}function r(n){return function(e){e.in.push(n),0==--e.indegree&&t.push(e)}}for(;t.length;){var o=t.pop();n.push(o),cl.forEach(o.in.reverse(),e(o)),cl.forEach(o.out,r(o))}return cl.map(cl.filter(n,(function(t){return!t.merged})),(function(t){return cl.pick(t,["vs","i","barycenter","weight"])}))}(cl.filter(e,(function(t){return!t.indegree})))},pl=function(t,n){var e=fl.partition(t,(function(t){return sl.has(t,"barycenter")})),r=e.lhs,o=sl.sortBy(e.rhs,(function(t){return-t.i})),i=[],u=0,a=0,c=0;r.sort((s=!!n,function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:s?n.i-t.i:t.i-n.i})),c=hl(i,o,c),sl.forEach(r,(function(t){c+=t.vs.length,i.push(t.vs),u+=t.barycenter*t.weight,a+=t.weight,c=hl(i,o,c)}));var s;var f={vs:sl.flatten(i,!0)};a&&(f.barycenter=u/a,f.weight=a);return f},gl=function t(n,e,r,o){var i=n.children(e),u=n.node(e),a=u?u.borderLeft:void 0,c=u?u.borderRight:void 0,s={};a&&(i=dl.filter(i,(function(t){return t!==a&&t!==c})));var f=ll(n,i);dl.forEach(f,(function(e){if(n.children(e.v).length){var i=t(n,e.v,r,o);s[e.v]=i,dl.has(i,"barycenter")&&(u=e,a=i,dl.isUndefined(u.barycenter)?(u.barycenter=a.barycenter,u.weight=a.weight):(u.barycenter=(u.barycenter*u.weight+a.barycenter*a.weight)/(u.weight+a.weight),u.weight+=a.weight))}var u,a}));var h=vl(f,r);!function(t,n){dl.forEach(t,(function(t){t.vs=dl.flatten(t.vs.map((function(t){return n[t]?n[t].vs:t})),!0)}))}(h,s);var d=pl(h,o);if(a&&(d.vs=dl.flatten([a,d.vs,c],!0),n.predecessors(a).length)){var l=n.node(n.predecessors(a)[0]),v=n.node(n.predecessors(c)[0]);dl.has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+l.order+v.order)/(d.weight+2),d.weight+=2}return d};var yl=Fh,ml=jh.Graph,bl=function(t,n,e){var r=function(t){var n;for(;t.hasNode(n=yl.uniqueId("_root")););return n}(t),o=new ml({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((function(n){return t.node(n)}));return yl.forEach(t.nodes(),(function(i){var u=t.node(i),a=t.parent(i);(u.rank===n||u.minRank<=n&&n<=u.maxRank)&&(o.setNode(i),o.setParent(i,a||r),yl.forEach(t[e](i),(function(n){var e=n.v===i?n.w:n.v,r=o.edge(e,i),u=yl.isUndefined(r)?0:r.weight;o.setEdge(e,i,{weight:t.edge(n).weight+u})})),yl.has(u,"minRank")&&o.setNode(i,{borderLeft:u.borderLeft[n],borderRight:u.borderRight[n]}))})),o};var wl=Fh;var _l=Fh,xl=rl,El=il,jl=gl,kl=bl,Nl=function(t,n,e){var r,o={};wl.forEach(e,(function(e){for(var i,u,a=t.parent(e);a;){if((i=t.parent(a))?(u=o[i],o[i]=a):(u=r,r=a),u&&u!==a)return void n.setEdge(u,a);a=i}}))},Ol=jh.Graph,Ml=ed,Il=function(t){var n=Ml.maxRank(t),e=zl(t,_l.range(1,n+1),"inEdges"),r=zl(t,_l.range(n-1,-1,-1),"outEdges"),o=xl(t);Cl(t,o);for(var i,u=Number.POSITIVE_INFINITY,a=0,c=0;c<4;++a,++c){Sl(a%2?e:r,a%4>=2),o=Ml.buildLayerMatrix(t);var s=El(t,o);s<u&&(c=0,i=_l.cloneDeep(o),u=s)}Cl(t,i)};function zl(t,n,e){return _l.map(n,(function(n){return kl(t,n,e)}))}function Sl(t,n){var e=new Ol;_l.forEach(t,(function(t){var r=t.graph().root,o=jl(t,r,e,n);_l.forEach(o.vs,(function(n,e){t.node(n).order=e})),Nl(t,e,o.vs)}))}function Cl(t,n){_l.forEach(n,(function(n){_l.forEach(n,(function(n,e){t.node(n).order=e}))}))}var Al=Fh,Ll=jh.Graph,Tl=ed,$l=function(t){var n,e=Tl.buildLayerMatrix(t),r=Al.merge(Pl(t,e),Bl(t,e)),o={};Al.forEach(["u","d"],(function(i){n="u"===i?e:Al.values(e).reverse(),Al.forEach(["l","r"],(function(e){"r"===e&&(n=Al.map(n,(function(t){return Al.values(t).reverse()})));var u=("u"===i?t.predecessors:t.successors).bind(t),a=Dl(t,n,r,u),c=Gl(t,n,a.root,a.align,"r"===e);"r"===e&&(c=Al.mapValues(c,(function(t){return-t}))),o[i+e]=c}))}));var i=Ul(t,o);return Hl(o,i),Vl(o,t.graph().align)};function Pl(t,n){var e={};return Al.reduce(n,(function(n,r){var o=0,i=0,u=n.length,a=Al.last(r);return Al.forEach(r,(function(n,c){var s=function(t,n){if(t.node(n).dummy)return Al.find(t.predecessors(n),(function(n){return t.node(n).dummy}))}(t,n),f=s?t.node(s).order:u;(s||n===a)&&(Al.forEach(r.slice(i,c+1),(function(n){Al.forEach(t.predecessors(n),(function(r){var i=t.node(r),u=i.order;!(u<o||f<u)||i.dummy&&t.node(n).dummy||Fl(e,r,n)}))})),i=c+1,o=f)})),r})),e}function Bl(t,n){var e={};function r(n,r,o,i,u){var a;Al.forEach(Al.range(r,o),(function(r){a=n[r],t.node(a).dummy&&Al.forEach(t.predecessors(a),(function(n){var r=t.node(n);r.dummy&&(r.order<i||r.order>u)&&Fl(e,n,a)}))}))}return Al.reduce(n,(function(n,e){var o,i=-1,u=0;return Al.forEach(e,(function(a,c){if("border"===t.node(a).dummy){var s=t.predecessors(a);s.length&&(o=t.node(s[0]).order,r(e,u,c,i,o),u=c,i=o)}r(e,u,e.length,o,n.length)})),e})),e}function Fl(t,n,e){if(n>e){var r=n;n=e,e=r}var o=t[n];o||(t[n]=o={}),o[e]=!0}function Rl(t,n,e){if(n>e){var r=n;n=e,e=r}return Al.has(t[n],e)}function Dl(t,n,e,r){var o={},i={},u={};return Al.forEach(n,(function(t){Al.forEach(t,(function(t,n){o[t]=t,i[t]=t,u[t]=n}))})),Al.forEach(n,(function(t){var n=-1;Al.forEach(t,(function(t){var a=r(t);if(a.length){a=Al.sortBy(a,(function(t){return u[t]}));for(var c=(a.length-1)/2,s=Math.floor(c),f=Math.ceil(c);s<=f;++s){var h=a[s];i[t]===t&&n<u[h]&&!Rl(e,t,h)&&(i[h]=t,i[t]=o[t]=o[h],n=u[h])}}}))})),{root:o,align:i}}function Gl(t,n,e,r,o){var i={},u=function(t,n,e,r){var o=new Ll,i=t.graph(),u=function(t,n,e){return function(r,o,i){var u,a=r.node(o),c=r.node(i),s=0;if(s+=a.width/2,Al.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":u=-a.width/2;break;case"r":u=a.width/2}if(u&&(s+=e?u:-u),u=0,s+=(a.dummy?n:t)/2,s+=(c.dummy?n:t)/2,s+=c.width/2,Al.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":u=c.width/2;break;case"r":u=-c.width/2}return u&&(s+=e?u:-u),u=0,s}}(i.nodesep,i.edgesep,r);return Al.forEach(n,(function(n){var r;Al.forEach(n,(function(n){var i=e[n];if(o.setNode(i),r){var a=e[r],c=o.edge(a,i);o.setEdge(a,i,Math.max(u(t,n,r),c||0))}r=n}))})),o}(t,n,e,o),a=o?"borderLeft":"borderRight";function c(t,n){for(var e=u.nodes(),r=e.pop(),o={};r;)o[r]?t(r):(o[r]=!0,e.push(r),e=e.concat(n(r))),r=e.pop()}return c((function(t){i[t]=u.inEdges(t).reduce((function(t,n){return Math.max(t,i[n.v]+u.edge(n))}),0)}),u.predecessors.bind(u)),c((function(n){var e=u.outEdges(n).reduce((function(t,n){return Math.min(t,i[n.w]-u.edge(n))}),Number.POSITIVE_INFINITY),r=t.node(n);e!==Number.POSITIVE_INFINITY&&r.borderType!==a&&(i[n]=Math.max(i[n],e))}),u.successors.bind(u)),Al.forEach(r,(function(t){i[t]=i[e[t]]})),i}function Ul(t,n){return Al.minBy(Al.values(n),(function(n){var e=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return Al.forIn(n,(function(n,o){var i=function(t,n){return t.node(n).width}(t,o)/2;e=Math.max(n+i,e),r=Math.min(n-i,r)})),e-r}))}function Hl(t,n){var e=Al.values(n),r=Al.min(e),o=Al.max(e);Al.forEach(["u","d"],(function(e){Al.forEach(["l","r"],(function(i){var u,a=e+i,c=t[a];if(c!==n){var s=Al.values(c);(u="l"===i?r-Al.min(s):o-Al.max(s))&&(t[a]=Al.mapValues(c,(function(t){return t+u})))}}))}))}function Vl(t,n){return Al.mapValues(t.ul,(function(e,r){if(n)return t[n.toLowerCase()][r];var o=Al.sortBy(Al.map(t,r));return(o[1]+o[2])/2}))}var ql=Fh,Wl=ed,Yl=$l;var Zl=Fh,Kl=Qh,Xl=ad,Jl=Pd,Ql=ed.normalizeRanks,tv=Dd,nv=ed.removeEmptyRanks,ev=Hd,rv=Yd,ov=Xd,iv=Il,uv=function(t){(function(t){var n=Wl.buildLayerMatrix(t),e=t.graph().ranksep,r=0;ql.forEach(n,(function(n){var o=ql.max(ql.map(n,(function(n){return t.node(n).height})));ql.forEach(n,(function(n){t.node(n).y=r+o/2})),r+=o+e}))})(t=Wl.asNonCompoundGraph(t)),ql.forEach(Yl(t),(function(n,e){t.node(e).x=n}))},av=ed,cv=jh.Graph,sv=function(t,n){var e=n&&n.debugTiming?av.time:av.notime;e("layout",(function(){var n=e("  buildLayoutGraph",(function(){return function(t){var n=new cv({multigraph:!0,compound:!0}),e=bv(t.graph());return n.setGraph(Zl.merge({},hv,mv(e,fv),Zl.pick(e,dv))),Zl.forEach(t.nodes(),(function(e){var r=bv(t.node(e));n.setNode(e,Zl.defaults(mv(r,lv),vv)),n.setParent(e,t.parent(e))})),Zl.forEach(t.edges(),(function(e){var r=bv(t.edge(e));n.setEdge(e,Zl.merge({},gv,mv(r,pv),Zl.pick(r,yv)))})),n}(t)}));e("  runLayout",(function(){!function(t,n){n("    makeSpaceForEdgeLabels",(function(){!function(t){var n=t.graph();n.ranksep/=2,Zl.forEach(t.edges(),(function(e){var r=t.edge(e);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(t)})),n("    removeSelfEdges",(function(){!function(t){Zl.forEach(t.edges(),(function(n){if(n.v===n.w){var e=t.node(n.v);e.selfEdges||(e.selfEdges=[]),e.selfEdges.push({e:n,label:t.edge(n)}),t.removeEdge(n)}}))}(t)})),n("    acyclic",(function(){Kl.run(t)})),n("    nestingGraph.run",(function(){ev.run(t)})),n("    rank",(function(){Jl(av.asNonCompoundGraph(t))})),n("    injectEdgeLabelProxies",(function(){!function(t){Zl.forEach(t.edges(),(function(n){var e=t.edge(n);if(e.width&&e.height){var r=t.node(n.v),o={rank:(t.node(n.w).rank-r.rank)/2+r.rank,e:n};av.addDummyNode(t,"edge-proxy",o,"_ep")}}))}(t)})),n("    removeEmptyRanks",(function(){nv(t)})),n("    nestingGraph.cleanup",(function(){ev.cleanup(t)})),n("    normalizeRanks",(function(){Ql(t)})),n("    assignRankMinMax",(function(){!function(t){var n=0;Zl.forEach(t.nodes(),(function(e){var r=t.node(e);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,n=Zl.max(n,r.maxRank))})),t.graph().maxRank=n}(t)})),n("    removeEdgeLabelProxies",(function(){!function(t){Zl.forEach(t.nodes(),(function(n){var e=t.node(n);"edge-proxy"===e.dummy&&(t.edge(e.e).labelRank=e.rank,t.removeNode(n))}))}(t)})),n("    normalize.run",(function(){Xl.run(t)})),n("    parentDummyChains",(function(){tv(t)})),n("    addBorderSegments",(function(){rv(t)})),n("    order",(function(){iv(t)})),n("    insertSelfEdges",(function(){!function(t){var n=av.buildLayerMatrix(t);Zl.forEach(n,(function(n){var e=0;Zl.forEach(n,(function(n,r){var o=t.node(n);o.order=r+e,Zl.forEach(o.selfEdges,(function(n){av.addDummyNode(t,"selfedge",{width:n.label.width,height:n.label.height,rank:o.rank,order:r+ ++e,e:n.e,label:n.label},"_se")})),delete o.selfEdges}))}))}(t)})),n("    adjustCoordinateSystem",(function(){ov.adjust(t)})),n("    position",(function(){uv(t)})),n("    positionSelfEdges",(function(){!function(t){Zl.forEach(t.nodes(),(function(n){var e=t.node(n);if("selfedge"===e.dummy){var r=t.node(e.e.v),o=r.x+r.width/2,i=r.y,u=e.x-o,a=r.height/2;t.setEdge(e.e,e.label),t.removeNode(n),e.label.points=[{x:o+2*u/3,y:i-a},{x:o+5*u/6,y:i-a},{x:o+u,y:i},{x:o+5*u/6,y:i+a},{x:o+2*u/3,y:i+a}],e.label.x=e.x,e.label.y=e.y}}))}(t)})),n("    removeBorderNodes",(function(){!function(t){Zl.forEach(t.nodes(),(function(n){if(t.children(n).length){var e=t.node(n),r=t.node(e.borderTop),o=t.node(e.borderBottom),i=t.node(Zl.last(e.borderLeft)),u=t.node(Zl.last(e.borderRight));e.width=Math.abs(u.x-i.x),e.height=Math.abs(o.y-r.y),e.x=i.x+e.width/2,e.y=r.y+e.height/2}})),Zl.forEach(t.nodes(),(function(n){"border"===t.node(n).dummy&&t.removeNode(n)}))}(t)})),n("    normalize.undo",(function(){Xl.undo(t)})),n("    fixupEdgeLabelCoords",(function(){!function(t){Zl.forEach(t.edges(),(function(n){var e=t.edge(n);if(Zl.has(e,"x"))switch("l"!==e.labelpos&&"r"!==e.labelpos||(e.width-=e.labeloffset),e.labelpos){case"l":e.x-=e.width/2+e.labeloffset;break;case"r":e.x+=e.width/2+e.labeloffset}}))}(t)})),n("    undoCoordinateSystem",(function(){ov.undo(t)})),n("    translateGraph",(function(){!function(t){var n=Number.POSITIVE_INFINITY,e=0,r=Number.POSITIVE_INFINITY,o=0,i=t.graph(),u=i.marginx||0,a=i.marginy||0;function c(t){var i=t.x,u=t.y,a=t.width,c=t.height;n=Math.min(n,i-a/2),e=Math.max(e,i+a/2),r=Math.min(r,u-c/2),o=Math.max(o,u+c/2)}Zl.forEach(t.nodes(),(function(n){c(t.node(n))})),Zl.forEach(t.edges(),(function(n){var e=t.edge(n);Zl.has(e,"x")&&c(e)})),n-=u,r-=a,Zl.forEach(t.nodes(),(function(e){var o=t.node(e);o.x-=n,o.y-=r})),Zl.forEach(t.edges(),(function(e){var o=t.edge(e);Zl.forEach(o.points,(function(t){t.x-=n,t.y-=r})),Zl.has(o,"x")&&(o.x-=n),Zl.has(o,"y")&&(o.y-=r)})),i.width=e-n+u,i.height=o-r+a}(t)})),n("    assignNodeIntersects",(function(){!function(t){Zl.forEach(t.edges(),(function(n){var e,r,o=t.edge(n),i=t.node(n.v),u=t.node(n.w);o.points?(e=o.points[0],r=o.points[o.points.length-1]):(o.points=[],e=u,r=i),o.points.unshift(av.intersectRect(i,e)),o.points.push(av.intersectRect(u,r))}))}(t)})),n("    reversePoints",(function(){!function(t){Zl.forEach(t.edges(),(function(n){var e=t.edge(n);e.reversed&&e.points.reverse()}))}(t)})),n("    acyclic.undo",(function(){Kl.undo(t)}))}(n,e)})),e("  updateInputGraph",(function(){!function(t,n){Zl.forEach(t.nodes(),(function(e){var r=t.node(e),o=n.node(e);r&&(r.x=o.x,r.y=o.y,n.children(e).length&&(r.width=o.width,r.height=o.height))})),Zl.forEach(t.edges(),(function(e){var r=t.edge(e),o=n.edge(e);r.points=o.points,Zl.has(o,"x")&&(r.x=o.x,r.y=o.y)})),t.graph().width=n.graph().width,t.graph().height=n.graph().height}(t,n)}))}))};var fv=["nodesep","edgesep","ranksep","marginx","marginy"],hv={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},dv=["acyclicer","ranker","rankdir","align"],lv=["width","height"],vv={width:0,height:0},pv=["minlen","weight","width","height","labeloffset"],gv={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},yv=["labelpos"];function mv(t,n){return Zl.mapValues(Zl.pick(t,n),Number)}function bv(t){var n={};return Zl.forEach(t,(function(t,e){n[e.toLowerCase()]=t})),n}var wv=Fh,_v=ed,xv=jh.Graph;var Ev={graphlib:jh,layout:sv,debug:{debugOrdering:function(t){var n=_v.buildLayerMatrix(t),e=new xv({compound:!0,multigraph:!0}).setGraph({});return wv.forEach(t.nodes(),(function(n){e.setNode(n,{label:n}),e.setParent(n,"layer"+t.node(n).rank)})),wv.forEach(t.edges(),(function(t){e.setEdge(t.v,t.w,{},t.name)})),wv.forEach(n,(function(t,n){var r="layer"+n;e.setNode(r,{rank:"same"}),wv.reduce(t,(function(t,n){return e.setEdge(t,n,{style:"invis"}),n}))})),e}},util:{time:ed.time,notime:ed.notime},version:"0.8.5"};const jv=(t,n)=>({x:t.x-n.x,y:t.y-n.y}),kv=(t,n)=>({x:t.x+n.x,y:t.y+n.y}),Nv=(t,n)=>({x:n*t.x,y:n*t.y}),Ov=t=>Nv(t,1/(t=>Math.sqrt(t.x*t.x+t.y*t.y))(t)),Mv=t=>t.trim().split(/(?=[A-Z])/);class Iv{constructor(){this.listeners=new Map}on(t,n){!this.listeners.has(t)&&this.listeners.set(t,new Set),this.listeners.get(t).add(n)}emit(t,...n){this.listeners.has(t)&&this.listeners.get(t).forEach((t=>t(...n)))}}const zv=(t,n)=>{t.x=0,t.y=0,t.width=n.scale,t.height=n.scale},Sv=(t,n)=>{t.x=0,t.y=0,t.width=2*n.scale,t.height=n.scale},Cv=(t,n)=>{const e=2*n.padding,r=(t,n)=>{if(t.nodes.size){const o=new Ev.graphlib.Graph({multigraph:!0});o.setGraph({nodesep:n.margin,edgesep:n.margin,ranksep:n.margin,acyclicer:t.id&&"greedy",rankdir:"LR",ranker:"network-simplex"}),t.nodes.forEach((t=>t.color&&function(t){switch(t){case"context":return r;case"command":case"event":return zv;default:return Sv}}(t.visual)(t,n))),t.nodes.forEach((({id:t,width:n,height:e})=>n&&e&&o.setNode(t,{width:n,height:e}))),t.edges.forEach((({source:t,target:n},e)=>o.setEdge(t.id,n.id,{},e))),Ev.layout(o),t.nodes.forEach((t=>{const n=o.node(t.id);n&&(t.x=n.x,t.y=n.y)})),!t.id&&o.edges().forEach((n=>{const e=o.edge(n),r=t.edges.get(n.name);r.path=[r.source,...e.points,r.target].map((t=>({x:Math.floor(t.x),y:Math.floor(t.y)})))}));const{width:i=0,height:u=0}=o.graph();t.width=i+e,t.height=u+e}else t.width=Mv(t.id).join(" ").length*n.fontSize+e,t.height=n.fontSize+e};return r(t,n)};function Av(t){return"number"==typeof t?t.toFixed(0):(t??"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}class Lv{constructor(t,n,e,r){this.type=t,this.attrs=n,this.parent=e,this.text=r,this.children=[]}get group(){return this.parent}attr(t,n){return this.attrs[t]=n,this}append(t){return t.parent=this,this.children.push(t),t}serialize(){const t=function(t){return Object.entries(t).filter((([t,n])=>n)).map((([t,n])=>`${t}="${Av(n)}"`)).join(" ")}({...this.attrs}),n=this.children.map((t=>t.serialize())).join("")||Av(this.text);return`<${this.type} ${t}>${n}</${this.type}>`}}class Tv{_new(t,n,e){this.current.append(new Lv(t,n,this.current,e))}constructor(t){this.root=this.current=new Lv("g",{...t,"data-name":"root"})}group(t,n){const e=new Lv("g",{},this.current);return this.current.append(e),this.current=e,t&&(this.attr("id","g-"+t),this.attr("data-name",t)),n&&(n.class&&this.attr("class",n.class),(n.dx||n.dy)&&this.attr("transform",`translate(${n.dx}, ${n.dy})`)),this}ungroup(){this.current.group&&(this.current=this.current.group)}attr(t,n){return this.current.attr(t,n),this}rect(t,n,e,r,o){this._new("rect",{x:t,y:n,height:r,width:e,...o})}path(t,n,e){const r=t.map(((t,n)=>t.x&&t.y?(n?"L":"M")+t.x.toFixed(0)+" "+t.y.toFixed(0):t.dx?"h"+t.dx.toFixed(0):t.dy?"v"+t.dy.toFixed(0):"")).join(" ").concat(n?" Z":"");this._new("path",{...e,d:r})}text(t,n,e,r){this._new("text",{x:n,y:e,...r},t)}serialize(){return this.root.serialize()}}const $v="#aaaaaa",Pv="#555555",Bv=(t,n,e)=>{let r=((t,n)=>{const e=t.map((t=>t.length)).sort(((t,n)=>n-t)).at(0);return Math.floor(Math.min(Math.max(Math.ceil(n/e),8),24))})(t,n);for(;r>5;){const o=Math.ceil(n/r)-1,i=Math.floor(e/r)-1,u=[];let a=t[0],c=1;for(;c<t.length;){const n=t[c++];a.length+n.length>=o?(u.push(a),a=n):a=a.concat(a.length?" ":"",n)}if(u.push(a),c===t.length&&u.length<=i)return{lines:u,fontSize:r};r--}return{lines:[t.join(" ")],fontSize:r}},Fv=(t,n,e,r,o={fit:!0})=>{const i=o.w||n||0,u=o.h||e||0,{lines:a,fontSize:c}=o.fit?Bv(t,i,u):{lines:t,fontSize:o.fontSize||12};r.attr("font-size",c+"pt");const s=o.x||Math.floor(i/2),f=o.y||Math.floor(u/2),h=Math.floor(a.length/2),d=a.length%2?.3:.9;a.forEach(((t,n)=>{r.text(t,s,f,{fill:Pv,dy:`${(1.2*(n-h)+d).toFixed(2)}em`})}))},Rv=(t,n)=>{const e={fill:"none",stroke:t.arrow?t.color:t.target.color};if(t.arrow&&(e["stroke-width"]=3),n.path((t=>{if(t.path){const n=t.path.slice(1,-1),e=Ov(jv(n[n.length-2],n.at(-1))),r=n.length-1,o=n.map((t=>({x:t.x,y:t.y})));return o[r]=kv(o[r],Nv(e,1.5*(t.arrow?5:0))),o}const n=t.source.x+t.source.width/2,e=t.target.x-t.target.width/2,r=t.source.y,o=t.target.y;if(r===o)return[{x:n,y:r},{dx:e-n}];const i=Math.floor((e-n)/2);return[{x:n,y:r},{dx:i},{dy:Math.floor(o-r)},{dx:i}]})(t),!1,{...e}),t.arrow){const r=t.path[t.path.length-2],o=t.path.slice(1,-1),i=Ov(jv(o[o.length-2],o.at(-1))),u=t=>kv(r,Nv(i,1.5*t)),a=t=>{return Nv({x:(n=i).y,y:-n.x},1.5*t);var n};n.path([kv(u(10),a(4)),u(5),kv(u(10),a(-4)),r],!0,{...e,fill:t.color})}},Dv=(t,n,e,r,o,i)=>{i.group("").attr("fill",t.color),i.rect(n,e,r,o),Fv(Mv(t.id),r,o,i,{fit:!0,x:n+r/2,y:e+o/2,w:r,h:o}),i.ungroup()},Gv=(t,n,e,r,o,i,u)=>{Dv(n,e,r,o,i,u);const a=t.actors?.refs.get(n.id),c=Math.ceil(o/2),s=Math.ceil(i/2);a&&[...a].forEach(((t,n)=>Dv(t,e-c+4,r+n*(s+2)-4,c,s,u)))},Uv=(t,n,e)=>{t.refs.forEach(((r,o)=>{const i=t.nodes.get(o),u=Math.floor(i.x-i.width/2-.2*e.scale),a=Math.floor(i.y+.4*i.height),c=Math.floor(e.scale),s=Math.floor(e.scale/2);r.size>1?"command"===i.visual?((t,n,e,r,o,i,u)=>{const a=Math.floor(i/n.length);n.forEach(((n,i)=>Gv(t,n,e,r+i*(a+2),o,a,u)))})(t,[...r],u,a,c,s,n):((t,n,e,r,o,i)=>{const u=t.map((t=>`- ${Mv(t.id).join(" ")}`));i.group("").attr("fill",t[0].color).attr("text-align","left").attr("text-anchor","start"),i.rect(n,e,r,o),Fv(u,r,o,i,{fit:!0,x:n+4,y:e+o/2,w:r,h:o}),i.ungroup()})([...r],u,a,c,s,n):Gv(t,[...r][0],u,a,c,s,n)}))},Hv=(t,n,e)=>{if("nodes"in t){if(t.id){const r=Mv(t.id);n.text(r.join(" "),0,0,{fill:$v,stroke:$v,dy:-e.fontSize}),n.rect(0,0,t.width,t.height,{rx:25,ry:25})}n.group("",{dx:e.padding,dy:e.padding}),t.id&&n.attr("text-align","center").attr("text-anchor","middle").attr("stroke",Pv),t.edges.forEach((e=>e.color&&Rv({...e,source:t.nodes.get(e.source.id)},n))),t.nodes.forEach((t=>t.color&&qv(t,n,e))),Uv(t,n,e),n.ungroup()}},Vv=(t,n)=>{n.attr("fill",t.color),n.rect(0,0,t.width,t.height),Fv(Mv(t.id),t.width,t.height,n),t.schema&&n.text(`{${t.schema.size}}`,t.width-6,6,{"font-family":"monospace","font-size":"6pt",fill:Pv})},qv=(t,n,e)=>{const r=Math.floor(t.x-t.width/2),o=Math.floor(t.y-t.height/2),i="context"===t.visual?Hv:Vv;n.group(t.id,{class:t.visual,dx:r,dy:o}),i(t,n,e),n.ungroup()};class Wv extends Error{constructor(t,n,e){super(`Parser error at line ${t.from.line+1}: Expected ${n} but got ${e}`),this.source=t,this.expected=n,this.actual=e}}const Yv={monospace:"Monospace",inconsolata:"Inconsolata",caveat:"Caveat",handlee:"Handlee"},Zv="inconsolata",Kv=(t,a,c=Zv)=>{const v={scale:a,stroke:"#dedede",fill:"white",font:Yv[c.toLowerCase()]||Yv[Zv],fontSize:12,padding:30,margin:40};try{const a=(t=>{const r=new Map,i={ix:0,line:0,line_ix:0},u={ix:0,line:0,line_ix:0},a={ix:0,line:0,line_ix:0},c=()=>({from:{line:u.line,col:u.ix-u.line_ix},to:{line:a.line,col:a.ix-a.line_ix}}),f=(t,n)=>{throw new Wv(c(),t,n.length>30?n.substring(0,40)+"...":n)},h=(t,n)=>{[...e].includes(t)&&f(n,t)},d=["\t"," ","\n","\r"],l=()=>{for(Object.assign(a,i);i.ix<t.length;){let n=t.charAt(i.ix);if("\n"===n)i.line++,i.line_ix=++i.ix;else if(d.includes(n))i.ix++;else{if("#"!==n)break;do{i.ix++,n=t.charAt(i.ix)}while(i.ix<t.length&&"\n"!==n)}}},v=o.join("|"),p=new RegExp(`^(${v})`),g=()=>{l();const n=t.substring(i.ix,i.ix+10),e=p.exec(n);if(e&&e.length){const t=e[0];return i.ix+=t.length,t}const r=/^[A-Z][a-zA-Z0-9]+/.exec(t.substring(i.ix));if(r&&r.length){const t=r[0];return i.ix+=t.length,t}const o=t.slice(i.ix+1).search(/[^a-zA-Z\d]/);i.ix=o?o+i.ix+1:t.length,Object.assign(a,i),f(`${v} or schema`,n)},y=(n=!1)=>{l(),Object.assign(u,i),Object.assign(a,i);let e="",r="",o="";for(;i.ix<t.length;)if(o=t.charAt(i.ix),o>="a"&&o<="z"||o>="A"&&o<="Z"||e.length&&o>="0"&&o<="9")e+=o,r+=o,i.ix++;else if([",",":",...d].includes(o)){if(l(),i.ix<t.length)if(o=t.charAt(i.ix),":"===o)n?(i.ix++,r+=":"+g()):f("identifier",o);else{if(","!==o)break;e="",r+=o,i.ix++,l()}}else f("identifier",o);return{token:r,source:c()}},m=t=>{const{token:e,source:o}=y();!e&&f("name","nothing"),e.indexOf(",")>0&&f("name","names"),h(e,"name"),!r.has(e)&&r.set(e,{type:t.token,source:t.source,rels:new Map});const i=r.get(e);"schema"!==t.token&&i.type!==t.token&&f(i.type,t.token),i.source.to=o.to;let u=y();if(n.includes(u.token))return u;const a=s[t.token].grammar;for(;u.token in a;){const t=u.token,n="requires"===t||"optional"===t,e=a[t],{token:r,source:o}=y(n);!r&&f("names","nothing"),r.split(",").forEach((t=>h(t.trim(),"names"))),r.split(",").filter(Boolean).forEach((r=>i?.rels.set(r,{...e,action:t,schema:n}))),i.source.to=o.to,u=y()}return u};let b=y();for(;b.token.length;)n.includes(b.token)?b=m(b):b.token.length&&f("keyword",b.token);return r})(t),c=(t=>{const n=new Map,e=(t,e,o,i=!1)=>{const u=n.get(e);if(u)return u.visual!==o&&h(t,`${e} found as ${u.visual}`,o),!u.ctx&&i&&(u.ctx=t.context),u;const a={id:e,visual:o,color:r[o]};return i&&(a.ctx=t.context),n.set(e,a),a},a=(r,o)=>{const i=t.get(o);if(i&&!i.context){i.context=r.id;const n=e(i,o,i.type,!0);i.rels.forEach((({type:n,owns:r},o)=>{const u=t.get(o);u&&l.includes(u.type)&&h(i,"artifact",o),!n&&h(i,"artifact type","nested context"),e(i,o,n,r)})),r.nodes.set(o,n)}else{const t=n.get(o);t&&!t.ctx&&(t.ctx=r.id,r.nodes.set(o,t))}},c=new Map,f=(t,n,e)=>{n.rels.forEach(((r,a)=>{if(r.schema){let s;s=e?e.schema=e.schema||new u(t):c.get(t);const[f,d="string"]=a.split(":"),l="requires"===r.action;o.includes(d)?s.set(f,new i(f,l,d)):(c.has(d)||h(n,"defined schema",d),s.set(f,new i(f,l,c.get(d))))}}))},v=d(),p=d("actors",!0);v.nodes.set(p.id,p),t.forEach(((t,n)=>{if("actor"===t.type)a(p,n);else if("context"===t.type){const e=d(n);e.actors=p,t.context=e.ctx,t.rels.forEach(((t,n)=>a(e,n))),v.nodes.set(n,e)}}));const g=d("global");return t.forEach(((t,n)=>{"schema"===t.type?c.set(n,new u(n)):t.context||a(g,n)})),n.forEach((t=>{t.ctx||(t.ctx=g.id,g.nodes.set(t.id,t))})),g.nodes.size&&v.nodes.set(g.id,g),t.forEach(((t,e)=>{if("schema"===t.type)f(e,t,n.get(e));else if("context"!==t.type){const r=s[t.type],o=n.get(e);f(e,t,o);const i=v.nodes.get(o.ctx);t.rels.forEach(((t,e)=>{if(!t.schema){const t=n.get(e);if(i.color&&o.ctx!==t.ctx){const n=s.context.rel(o,t,v);if(n){const t=`${n.source.id}->${n.target.id}-${n.color||""}`;!v.edges.has(t)&&v.edges.set(t,n)}}const u=r.rel(o,t,v);if(u)if(u.edge)i.edges.set(`${u.source.id}->${u.target.id}`,u),i.nodes.set(u.source.id,u.source),i.nodes.set(u.target.id,u.target);else{const t=v.nodes.get(u.source.ctx);!t.refs.has(u.source.id)&&t.refs.set(u.source.id,new Set),t.refs.get(u.source.id)?.add(u.target)}}}))}})),v})(a);Cv(c,v);const f=((t,n)=>{const e=new Tv({fill:n.fill,"font-family":n.font,"font-size":n.fontSize+"pt","text-align":"left",stroke:n.stroke,"stroke-width":1});return Hv(t,e,n),e.serialize()})(c,v),p=[...c.nodes.values()].filter((t=>"actors"!==t.id)).flatMap((t=>[...t.nodes.values()]));return{svg:f,width:c.width,height:c.height,nodes:p.map((({id:t,visual:n,ctx:e,x:r,y:o,width:i,height:u,schema:a})=>({id:t,visual:n,ctx:e,x:r,y:o,width:i,height:u,fields:a?[...a.values()]:[]})))}}catch(t){if(t instanceof Wv)return{error:t};if(t instanceof f)return{error:t};if(t instanceof Error){const n=t.stack.split("\n").slice(0,2).join(" ");return{error:Error(n)}}return{error:Error(t)}}};t.Canvas=class extends Iv{constructor(t,n,e){super(),this.document=t,this.container=n,this.SCALE=80,this.WIDTH=100*this.SCALE,this.HEIGHT=100*this.SCALE,this.dragging=!1,this.dx=0,this.dy=0,this.zoom=1,this.x=0,this.y=0,this.w=0,this.h=0,this.tooltip=t.createElement("div"),this.tooltip.className="node-tooltip",this.container.appendChild(this.tooltip),e&&(this.SCALE=e.SCALE,this.WIDTH=e.WIDTH,this.HEIGHT=e.HEIGHT,this.coordsSpan=e.coordsSpan,this.zoomBtn=e.zoomBtn,this.zoomInBtn=e.zoomInBtn,this.zoomOutBtn=e.zoomOutBtn),this.svg=this.document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.svg.setAttribute("viewBox",`0 0 ${this.WIDTH} ${this.HEIGHT}`),this.svg.setAttribute("width",`${this.WIDTH}`),this.svg.setAttribute("height",`${this.HEIGHT}`),this.container.appendChild(this.svg),this.container.addEventListener("wheel",(t=>{t.preventDefault(),t.metaKey||t.ctrlKey?(this.fitZoom(this.zoom+-.01*t.deltaY),this.transform()):this.transform(t.deltaX,t.deltaY)}));const r=({clientX:t,clientY:n})=>{this.dragging=!0,this.dx=t,this.dy=n,this.container.style.cursor="grabbing"},o=()=>{this.dragging=!1,this.container.style.cursor="default"},i=({clientX:t,clientY:n})=>{this.dragging&&(this.transform(this.dx-t,this.dy-n),this.dx=t,this.dy=n)};this.container.addEventListener("mousedown",r),this.container.addEventListener("mouseup",o),this.container.addEventListener("mousemove",i),this.container.addEventListener("touchstart",(t=>r(t.touches[0]))),this.container.addEventListener("touchend",o),this.container.addEventListener("touchmove",(t=>i(t.touches[0]))),this.zoomBtn&&(this.zoomBtn.onclick=()=>this.fitToContainer.apply(this)),this.zoomInBtn&&(this.zoomInBtn.onclick=()=>this.zoomTo.apply(this,[.1])),this.zoomOutBtn&&(this.zoomOutBtn.onclick=()=>this.zoomTo.apply(this,[-.1]))}fitToContainer(){const t=Math.min(this.container.clientWidth,window.innerWidth),n=Math.min(this.container.clientHeight,window.innerHeight);this.w&&this.h&&t&&n&&(this.fitZoom(Math.min(t/this.w,n/this.h)),this.x=Math.floor((t-this.w*this.zoom)/2),this.y=Math.floor((n-this.h*this.zoom)/2),this.transform())}zoomTo(t){this.fitZoom(this.zoom+t),this.transform()}fitZoom(t){this.zoom=Math.round(100*Math.min(Math.max(.1,t),3))/100}transform(t=0,n=0){const e=this.svg.children[0];e&&(this.x=Math.floor(Math.min(Math.max(this.x-t,0-this.w*this.zoom),this.WIDTH)),this.y=Math.floor(Math.min(Math.max(this.y-n,0-this.h*this.zoom),this.HEIGHT)),this.coordsSpan&&(this.coordsSpan.innerText=`x:${this.x} y:${this.y} w:${this.w} h:${this.h}`),this.zoomBtn&&(this.zoomBtn.innerText=`${Math.floor(100*this.zoom)}%`),e.setAttribute("transform",`translate(${this.x}, ${this.y}) scale(${this.zoom})`),this.emit("transformed",{x:this.x,y:this.y,zoom:this.zoom}))}addNodes(t){const n=t=>{const n=t.target,e=n.dataset.name,r=this.document.getElementById("node-"+e);if(r){this.tooltip.innerHTML=r?.innerHTML,this.tooltip.className="node-tooltip-visible";const{left:t,top:e,width:o}=n.getBoundingClientRect(),i=t+(o-this.tooltip.offsetWidth)/2,u=e-this.tooltip.offsetHeight;this.tooltip.style.left=i+"px",this.tooltip.style.top=u+"px"}},e=()=>{this.tooltip.className="node-tooltip",this.tooltip.innerText=""};this.nodes&&this.container.removeChild(this.nodes),this.nodes=this.document.createElement("div"),this.container.appendChild(this.nodes),this.nodes.style.visibility="hidden",t&&t.filter((t=>t.fields.length)).map((t=>{const r=this.document.createElement("div");r.id="node-"+t.id,r.innerHTML=`<h6>${t.id}</h6>\n        <table class="table table-sm">\n          ${t.fields.slice(0,20).map((t=>{const n=t.name.length>10?t.name.substring(0,10)+"...":t.name,e=t.required?"th":"td";return`<tr><${e}>${n}</${e}><td>${t.type}</td></tr>`})).join("")}\n            ${t.fields.length>20?"<tr><td colspan='2'>...</td></tr>":""}\n        </table>\n        `,this.nodes?.appendChild(r);const o=this.document.getElementById("g-"+t.id);o&&(o.addEventListener("mouseenter",n),o.addEventListener("mouseleave",e))}))}render(t){const{error:n,svg:e,width:r,height:o,nodes:i}=Kv(t.code,this.SCALE,t.font);if(n)return n;this.svg.innerHTML=e,this.addNodes(i),this.w=Math.floor(r),this.h=Math.floor(o),t.zoom&&(this.x=t.x||0,this.y=t.y||0,this.zoom=t.zoom),this.transform()}},t.EventEmitter=Iv,t.Keywords=e,t.debounce=(t,n)=>{let e;return function(...r){clearTimeout(e),e=setTimeout((()=>{t.apply(this,r)}),n)}},t.esml=Kv}));

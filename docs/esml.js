!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).esml={})}(this,(function(t){"use strict";const n=["context","actor","aggregate","system","projector","policy","process"],r=[...n,"invokes","handles","emits","includes","reads"],e={context:"white",actor:"#ffc107",aggregate:"#fffabb",system:"#eca0c3",projector:"#d5f694",policy:"#c595cd",process:"#c595cd",command:"#7adcfb",event:"#ffaa61"},o={grammar:{handles:{visual:"event",owns:!1},invokes:{visual:"command",owns:!1},reads:{visual:"projector",owns:!1}},rel:(t,n)=>"event"===n.visual?{sourceId:n.id+"*",targetId:t.id,color:e.event,dashed:!0,arrow:!0}:"projector"===n.visual?{sourceId:t.id,target:n}:t.ctx===n.ctx?{sourceId:t.id,targetId:n.id,color:e.command,arrow:!0}:{sourceId:n.id,target:t}},i={grammar:{handles:{visual:"command",owns:!0},emits:{visual:"event",owns:!0}},rel:(t,n)=>"command"===n.visual?{sourceId:n.id,targetId:t.id}:{sourceId:t.id,targetId:n.id}},u={context:{grammar:{includes:{visual:"artifact",owns:!0}},rel:(t,n)=>"event"===n.visual?{sourceId:n.ctx,targetId:t.ctx,color:e.event,dashed:!0,arrow:!0}:"command"===n.visual&&"actor"!==t.visual?{sourceId:t.ctx,targetId:n.ctx,color:e.command,arrow:!0}:"projector"===n.visual?{sourceId:t.ctx,targetId:n.ctx,color:e.projector,arrow:!0}:void 0},actor:{grammar:{invokes:{visual:"command",owns:!1},reads:{visual:"projector",owns:!1}},rel:(t,n)=>"command"===n.visual?{sourceId:n.id,target:t}:{sourceId:t.id,target:n}},aggregate:i,system:i,policy:o,process:o,projector:{grammar:{handles:{visual:"event",owns:!1}},rel:(t,n)=>({sourceId:n.id,targetId:t.id,color:e.event,dashed:!0,arrow:!0})}};class a extends Error{constructor(t,n,r){super(`Compiler error at line ${t.from.line}: Expected ${n} but got ${r}`),this.source=t,this.expected=n,this.actual=r}}const c=(t,n,r)=>{throw new a(t.source,n,r)},f=(t="")=>({id:t,visual:"context",nodes:new Map,edges:new Map,refs:new Map,x:0,y:0});var s,h,d,l,v,p,g,y,m,b,w,_,E,x,j,k,I,N,O,M,S,A,z,C,L,T,P,$,F,R,D,B,G,U,V,H,q,Y,W,Z,K,X,J,Q,tt,nt,rt,et,ot,it,ut,at,ct,ft,st,ht,dt,lt,vt,pt,gt,yt,mt,bt,wt,_t,Et,xt,jt,kt,It,Nt,Ot,Mt,St,At,zt,Ct,Lt,Tt,Pt,$t,Ft,Rt,Dt,Bt,Gt,Ut,Vt,Ht,qt,Yt,Wt,Zt,Kt,Xt,Jt,Qt,tn,nn,rn,en,on,un,an,cn,fn,sn,hn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function dn(){if(l)return d;return l=1,d=function(t,n){return t===n||t!=t&&n!=n}}function ln(){if(p)return v;p=1;var t=dn();return v=function(n,r){for(var e=n.length;e--;)if(t(n[e][0],r))return e;return-1}}function vn(){if(k)return j;k=1;var t=h?s:(h=1,s=function(){this.__data__=[],this.size=0}),n=function(){if(y)return g;y=1;var t=ln(),n=Array.prototype.splice;return g=function(r){var e=this.__data__,o=t(e,r);return!(o<0||(o==e.length-1?e.pop():n.call(e,o,1),--this.size,0))}}(),r=function(){if(b)return m;b=1;var t=ln();return m=function(n){var r=this.__data__,e=t(r,n);return e<0?void 0:r[e][1]}}(),e=function(){if(_)return w;_=1;var t=ln();return w=function(n){return t(this.__data__,n)>-1}}(),o=function(){if(x)return E;x=1;var t=ln();return E=function(n,r){var e=this.__data__,o=t(e,n);return o<0?(++this.size,e.push([n,r])):e[o][1]=r,this}}();function i(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=e,i.prototype.set=o,j=i}function pn(){if(T)return L;T=1;var t="object"==typeof hn&&hn&&hn.Object===Object&&hn;return L=t}function gn(){if($)return P;$=1;var t=pn(),n="object"==typeof self&&self&&self.Object===Object&&self,r=t||n||Function("return this")();return P=r}function yn(){if(R)return F;R=1;var t=gn().Symbol;return F=t}function mn(){if(H)return V;H=1;var t=yn(),n=function(){if(B)return D;B=1;var t=yn(),n=Object.prototype,r=n.hasOwnProperty,e=n.toString,o=t?t.toStringTag:void 0;return D=function(t){var n=r.call(t,o),i=t[o];try{t[o]=void 0;var u=!0}catch(t){}var a=e.call(t);return u&&(n?t[o]=i:delete t[o]),a}}(),r=function(){if(U)return G;U=1;var t=Object.prototype.toString;return G=function(n){return t.call(n)}}(),e=t?t.toStringTag:void 0;return V=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":e&&e in Object(t)?n(t):r(t)}}function bn(){if(Y)return q;return Y=1,q=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}}function wn(){if(Z)return W;Z=1;var t=mn(),n=bn();return W=function(r){if(!n(r))return!1;var e=t(r);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}}function _n(){if(Q)return J;Q=1;var t,n=function(){if(X)return K;X=1;var t=gn()["__core-js_shared__"];return K=t}(),r=(t=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return J=function(t){return!!r&&r in t}}function En(){if(nt)return tt;nt=1;var t=Function.prototype.toString;return tt=function(n){if(null!=n){try{return t.call(n)}catch(t){}try{return n+""}catch(t){}}return""}}function xn(){if(at)return ut;at=1;var t=function(){if(et)return rt;et=1;var t=wn(),n=_n(),r=bn(),e=En(),o=/^\[object .+?Constructor\]$/,i=Function.prototype,u=Object.prototype,a=i.toString,c=u.hasOwnProperty,f=RegExp("^"+a.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return rt=function(i){return!(!r(i)||n(i))&&(t(i)?f:o).test(e(i))}}(),n=it?ot:(it=1,ot=function(t,n){return null==t?void 0:t[n]});return ut=function(r,e){var o=n(r,e);return t(o)?o:void 0}}function jn(){if(ft)return ct;ft=1;var t=xn()(gn(),"Map");return ct=t}function kn(){if(ht)return st;ht=1;var t=xn()(Object,"create");return st=t}function In(){if(xt)return Et;xt=1;var t=function(){if(lt)return dt;lt=1;var t=kn();return dt=function(){this.__data__=t?t(null):{},this.size=0}}(),n=pt?vt:(pt=1,vt=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}),r=function(){if(yt)return gt;yt=1;var t=kn(),n=Object.prototype.hasOwnProperty;return gt=function(r){var e=this.__data__;if(t){var o=e[r];return"__lodash_hash_undefined__"===o?void 0:o}return n.call(e,r)?e[r]:void 0}}(),e=function(){if(bt)return mt;bt=1;var t=kn(),n=Object.prototype.hasOwnProperty;return mt=function(r){var e=this.__data__;return t?void 0!==e[r]:n.call(e,r)}}(),o=function(){if(_t)return wt;_t=1;var t=kn();return wt=function(n,r){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=t&&void 0===r?"__lodash_hash_undefined__":r,this}}();function i(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=e,i.prototype.set=o,Et=i}function Nn(){if(Mt)return Ot;Mt=1;var t=Nt?It:(Nt=1,It=function(t){var n=typeof t;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t});return Ot=function(n,r){var e=n.__data__;return t(r)?e["string"==typeof r?"string":"hash"]:e.map}}function On(){if(Rt)return Ft;Rt=1;var t=function(){if(kt)return jt;kt=1;var t=In(),n=vn(),r=jn();return jt=function(){this.size=0,this.__data__={hash:new t,map:new(r||n),string:new t}}}(),n=function(){if(At)return St;At=1;var t=Nn();return St=function(n){var r=t(this,n).delete(n);return this.size-=r?1:0,r}}(),r=function(){if(Ct)return zt;Ct=1;var t=Nn();return zt=function(n){return t(this,n).get(n)}}(),e=function(){if(Tt)return Lt;Tt=1;var t=Nn();return Lt=function(n){return t(this,n).has(n)}}(),o=function(){if($t)return Pt;$t=1;var t=Nn();return Pt=function(n,r){var e=t(this,n),o=e.size;return e.set(n,r),this.size+=e.size==o?0:1,this}}();function i(t){var n=-1,r=null==t?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}return i.prototype.clear=t,i.prototype.delete=n,i.prototype.get=r,i.prototype.has=e,i.prototype.set=o,Ft=i}function Mn(){if(Ut)return Gt;Ut=1;var t=vn(),n=function(){if(N)return I;N=1;var t=vn();return I=function(){this.__data__=new t,this.size=0}}(),r=M?O:(M=1,O=function(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}),e=A?S:(A=1,S=function(t){return this.__data__.get(t)}),o=C?z:(C=1,z=function(t){return this.__data__.has(t)}),i=function(){if(Bt)return Dt;Bt=1;var t=vn(),n=jn(),r=On();return Dt=function(e,o){var i=this.__data__;if(i instanceof t){var u=i.__data__;if(!n||u.length<199)return u.push([e,o]),this.size=++i.size,this;i=this.__data__=new r(u)}return i.set(e,o),this.size=i.size,this}}();function u(n){var r=this.__data__=new t(n);this.size=r.size}return u.prototype.clear=n,u.prototype.delete=r,u.prototype.get=e,u.prototype.has=o,u.prototype.set=i,Gt=u}function Sn(){if(Ht)return Vt;return Ht=1,Vt=function(t,n){for(var r=-1,e=null==t?0:t.length;++r<e&&!1!==n(t[r],r,t););return t}}function An(){if(Yt)return qt;Yt=1;var t=xn(),n=function(){try{var n=t(Object,"defineProperty");return n({},"",{}),n}catch(t){}}();return qt=n}function zn(){if(Zt)return Wt;Zt=1;var t=An();return Wt=function(n,r,e){"__proto__"==r&&t?t(n,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):n[r]=e}}function Cn(){if(Xt)return Kt;Xt=1;var t=zn(),n=dn(),r=Object.prototype.hasOwnProperty;return Kt=function(e,o,i){var u=e[o];r.call(e,o)&&n(u,i)&&(void 0!==i||o in e)||t(e,o,i)}}function Ln(){if(Qt)return Jt;Qt=1;var t=Cn(),n=zn();return Jt=function(r,e,o,i){var u=!o;o||(o={});for(var a=-1,c=e.length;++a<c;){var f=e[a],s=i?i(o[f],r[f],f,o,r):void 0;void 0===s&&(s=r[f]),u?n(o,f,s):t(o,f,s)}return o}}function Tn(){if(en)return rn;return en=1,rn=function(t){return null!=t&&"object"==typeof t}}function Pn(){if(cn)return an;cn=1;var t=function(){if(un)return on;un=1;var t=mn(),n=Tn();return on=function(r){return n(r)&&"[object Arguments]"==t(r)}}(),n=Tn(),r=Object.prototype,e=r.hasOwnProperty,o=r.propertyIsEnumerable,i=t(function(){return arguments}())?t:function(t){return n(t)&&e.call(t,"callee")&&!o.call(t,"callee")};return an=i}function $n(){if(sn)return fn;sn=1;var t=Array.isArray;return fn=t}var Fn,Rn,Dn,Bn,Gn,Un,Vn,Hn,qn,Yn,Wn,Zn={exports:{}};function Kn(){return Dn||(Dn=1,function(t,n){var r=gn(),e=Rn?Fn:(Rn=1,Fn=function(){return!1}),o=n&&!n.nodeType&&n,i=o&&t&&!t.nodeType&&t,u=i&&i.exports===o?r.Buffer:void 0,a=(u?u.isBuffer:void 0)||e;t.exports=a}(Zn,Zn.exports)),Zn.exports}function Xn(){if(Gn)return Bn;Gn=1;var t=/^(?:0|[1-9]\d*)$/;return Bn=function(n,r){var e=typeof n;return!!(r=null==r?9007199254740991:r)&&("number"==e||"symbol"!=e&&t.test(n))&&n>-1&&n%1==0&&n<r}}function Jn(){if(Vn)return Un;Vn=1;return Un=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function Qn(){if(Wn)return Yn;return Wn=1,Yn=function(t){return function(n){return t(n)}}}Zn.exports;var tr,nr,rr,er,or,ir,ur,ar,cr,fr,sr,hr,dr,lr,vr,pr,gr,yr,mr,br,wr,_r,Er,xr,jr,kr,Ir,Nr={exports:{}};function Or(){return tr||(tr=1,function(t,n){var r=pn(),e=n&&!n.nodeType&&n,o=e&&t&&!t.nodeType&&t,i=o&&o.exports===e&&r.process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}(Nr,Nr.exports)),Nr.exports}function Mr(){if(rr)return nr;rr=1;var t=function(){if(qn)return Hn;qn=1;var t=mn(),n=Jn(),r=Tn(),e={};return e["[object Float32Array]"]=e["[object Float64Array]"]=e["[object Int8Array]"]=e["[object Int16Array]"]=e["[object Int32Array]"]=e["[object Uint8Array]"]=e["[object Uint8ClampedArray]"]=e["[object Uint16Array]"]=e["[object Uint32Array]"]=!0,e["[object Arguments]"]=e["[object Array]"]=e["[object ArrayBuffer]"]=e["[object Boolean]"]=e["[object DataView]"]=e["[object Date]"]=e["[object Error]"]=e["[object Function]"]=e["[object Map]"]=e["[object Number]"]=e["[object Object]"]=e["[object RegExp]"]=e["[object Set]"]=e["[object String]"]=e["[object WeakMap]"]=!1,Hn=function(o){return r(o)&&n(o.length)&&!!e[t(o)]}}(),n=Qn(),r=Or(),e=r&&r.isTypedArray,o=e?n(e):t;return nr=o}function Sr(){if(or)return er;or=1;var t=nn?tn:(nn=1,tn=function(t,n){for(var r=-1,e=Array(t);++r<t;)e[r]=n(r);return e}),n=Pn(),r=$n(),e=Kn(),o=Xn(),i=Mr(),u=Object.prototype.hasOwnProperty;return er=function(a,c){var f=r(a),s=!f&&n(a),h=!f&&!s&&e(a),d=!f&&!s&&!h&&i(a),l=f||s||h||d,v=l?t(a.length,String):[],p=v.length;for(var g in a)!c&&!u.call(a,g)||l&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||o(g,p))||v.push(g);return v}}function Ar(){if(ur)return ir;ur=1;var t=Object.prototype;return ir=function(n){var r=n&&n.constructor;return n===("function"==typeof r&&r.prototype||t)}}function zr(){if(cr)return ar;return cr=1,ar=function(t,n){return function(r){return t(n(r))}}}function Cr(){if(dr)return hr;dr=1;var t=Ar(),n=function(){if(sr)return fr;sr=1;var t=zr()(Object.keys,Object);return fr=t}(),r=Object.prototype.hasOwnProperty;return hr=function(e){if(!t(e))return n(e);var o=[];for(var i in Object(e))r.call(e,i)&&"constructor"!=i&&o.push(i);return o}}function Lr(){if(vr)return lr;vr=1;var t=wn(),n=Jn();return lr=function(r){return null!=r&&n(r.length)&&!t(r)}}function Tr(){if(gr)return pr;gr=1;var t=Sr(),n=Cr(),r=Lr();return pr=function(e){return r(e)?t(e):n(e)}}function Pr(){if(Er)return _r;Er=1;var t=bn(),n=Ar(),r=wr?br:(wr=1,br=function(t){var n=[];if(null!=t)for(var r in Object(t))n.push(r);return n}),e=Object.prototype.hasOwnProperty;return _r=function(o){if(!t(o))return r(o);var i=n(o),u=[];for(var a in o)("constructor"!=a||!i&&e.call(o,a))&&u.push(a);return u}}function $r(){if(jr)return xr;jr=1;var t=Sr(),n=Pr(),r=Lr();return xr=function(e){return r(e)?t(e,!0):n(e)}}Nr.exports;var Fr,Rr,Dr,Br,Gr,Ur,Vr,Hr,qr,Yr,Wr,Zr,Kr,Xr,Jr,Qr,te,ne,re,ee,oe,ie,ue,ae,ce,fe,se,he,de,le,ve,pe,ge,ye,me,be,we,_e,Ee,xe,je,ke,Ie,Ne,Oe,Me,Se,Ae,ze,Ce,Le,Te,Pe,$e,Fe,Re,De,Be,Ge,Ue,Ve,He,qe,Ye,We,Ze,Ke,Xe,Je,Qe,to,no,ro,eo,oo,io,uo,ao,co,fo,so,ho,lo,vo,po,go,yo,mo,bo,wo,_o,Eo,xo,jo,ko,Io,No,Oo,Mo,So,Ao,zo,Co,Lo,To,Po,$o,Fo,Ro,Do,Bo,Go,Uo,Vo,Ho,qo,Yo,Wo,Zo,Ko,Xo,Jo,Qo,ti,ni,ri,ei,oi,ii,ui,ai,ci,fi,si,hi,di,li,vi,pi,gi,yi,mi,bi,wi,_i,Ei,xi,ji,ki,Ii,Ni,Oi,Mi,Si,Ai,zi,Ci,Li,Ti,Pi,$i,Fi,Ri,Di,Bi,Gi,Ui,Vi,Hi,qi,Yi,Wi,Zi,Ki,Xi,Ji,Qi,tu,nu,ru,eu,ou,iu,uu,au,cu,fu,su,hu,du,lu,vu,pu,gu,yu,mu,bu,wu,_u,Eu,xu,ju,ku,Iu,Nu,Ou,Mu,Su,Au,zu,Cu,Lu,Tu,Pu,$u,Fu,Ru,Du,Bu,Gu,Uu,Vu,Hu,qu,Yu,Wu,Zu,Ku,Xu,Ju,Qu,ta,na,ra,ea,oa,ia,ua,aa,ca,fa,sa,ha,da,la,va,pa,ga,ya,ma,ba,wa,_a,Ea,xa,ja,ka,Ia,Na,Oa,Ma,Sa,Aa,za,Ca,La,Ta,Pa,$a,Fa,Ra,Da,Ba,Ga,Ua,Va,Ha,qa,Ya,Wa,Za={exports:{}};function Ka(){return Fr||(Fr=1,function(t,n){var r=gn(),e=n&&!n.nodeType&&n,o=e&&t&&!t.nodeType&&t,i=o&&o.exports===e?r.Buffer:void 0,u=i?i.allocUnsafe:void 0;t.exports=function(t,n){if(n)return t.slice();var r=t.length,e=u?u(r):new t.constructor(r);return t.copy(e),e}}(Za,Za.exports)),Za.exports}function Xa(){if(Dr)return Rr;return Dr=1,Rr=function(t,n){var r=-1,e=t.length;for(n||(n=Array(e));++r<e;)n[r]=t[r];return n}}function Ja(){if(Gr)return Br;return Gr=1,Br=function(t,n){for(var r=-1,e=null==t?0:t.length,o=0,i=[];++r<e;){var u=t[r];n(u,r,t)&&(i[o++]=u)}return i}}function Qa(){if(Vr)return Ur;return Vr=1,Ur=function(){return[]}}function tc(){if(qr)return Hr;qr=1;var t=Ja(),n=Qa(),r=Object.prototype.propertyIsEnumerable,e=Object.getOwnPropertySymbols;return Hr=e?function(n){return null==n?[]:(n=Object(n),t(e(n),(function(t){return r.call(n,t)})))}:n}function nc(){if(Kr)return Zr;return Kr=1,Zr=function(t,n){for(var r=-1,e=n.length,o=t.length;++r<e;)t[o+r]=n[r];return t}}function rc(){if(Jr)return Xr;Jr=1;var t=zr()(Object.getPrototypeOf,Object);return Xr=t}function ec(){if(te)return Qr;te=1;var t=nc(),n=rc(),r=tc(),e=Qa(),o=Object.getOwnPropertySymbols;return Qr=o?function(e){for(var o=[];e;)t(o,r(e)),e=n(e);return o}:e}function oc(){if(oe)return ee;oe=1;var t=nc(),n=$n();return ee=function(r,e,o){var i=e(r);return n(r)?i:t(i,o(r))}}function ic(){if(ue)return ie;ue=1;var t=oc(),n=tc(),r=Tr();return ie=function(e){return t(e,r,n)}}function uc(){if(ve)return le;ve=1;var t=xn()(gn(),"Set");return le=t}function ac(){if(me)return ye;me=1;var t=function(){if(se)return fe;se=1;var t=xn()(gn(),"DataView");return fe=t}(),n=jn(),r=function(){if(de)return he;de=1;var t=xn()(gn(),"Promise");return he=t}(),e=uc(),o=function(){if(ge)return pe;ge=1;var t=xn()(gn(),"WeakMap");return pe=t}(),i=mn(),u=En(),a="[object Map]",c="[object Promise]",f="[object Set]",s="[object WeakMap]",h="[object DataView]",d=u(t),l=u(n),v=u(r),p=u(e),g=u(o),y=i;return(t&&y(new t(new ArrayBuffer(1)))!=h||n&&y(new n)!=a||r&&y(r.resolve())!=c||e&&y(new e)!=f||o&&y(new o)!=s)&&(y=function(t){var n=i(t),r="[object Object]"==n?t.constructor:void 0,e=r?u(r):"";if(e)switch(e){case d:return h;case l:return a;case v:return c;case p:return f;case g:return s}return n}),ye=y}function cc(){if(Ee)return _e;Ee=1;var t=gn().Uint8Array;return _e=t}function fc(){if(je)return xe;je=1;var t=cc();return xe=function(n){var r=new n.constructor(n.byteLength);return new t(r).set(new t(n)),r}}function sc(){if(ze)return Ae;ze=1;var t=fc();return Ae=function(n,r){var e=r?t(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.length)}}function hc(){if(Le)return Ce;Le=1;var t=fc(),n=function(){if(Ie)return ke;Ie=1;var t=fc();return ke=function(n,r){var e=r?t(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.byteLength)}}(),r=function(){if(Oe)return Ne;Oe=1;var t=/\w*$/;return Ne=function(n){var r=new n.constructor(n.source,t.exec(n));return r.lastIndex=n.lastIndex,r}}(),e=function(){if(Se)return Me;Se=1;var t=yn(),n=t?t.prototype:void 0,r=n?n.valueOf:void 0;return Me=function(t){return r?Object(r.call(t)):{}}}(),o=sc();return Ce=function(i,u,a){var c=i.constructor;switch(u){case"[object ArrayBuffer]":return t(i);case"[object Boolean]":case"[object Date]":return new c(+i);case"[object DataView]":return n(i,a);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return o(i,a);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(i);case"[object RegExp]":return r(i);case"[object Symbol]":return e(i)}}}function dc(){if(Pe)return Te;Pe=1;var t=bn(),n=Object.create,r=function(){function r(){}return function(e){if(!t(e))return{};if(n)return n(e);r.prototype=e;var o=new r;return r.prototype=void 0,o}}();return Te=r}function lc(){if(Fe)return $e;Fe=1;var t=dc(),n=rc(),r=Ar();return $e=function(e){return"function"!=typeof e.constructor||r(e)?{}:t(n(e))}}function vc(){if(Ge)return Be;Ge=1;var t=function(){if(De)return Re;De=1;var t=ac(),n=Tn();return Re=function(r){return n(r)&&"[object Map]"==t(r)}}(),n=Qn(),r=Or(),e=r&&r.isMap,o=e?n(e):t;return Be=o}function pc(){if(qe)return He;qe=1;var t=function(){if(Ve)return Ue;Ve=1;var t=ac(),n=Tn();return Ue=function(r){return n(r)&&"[object Set]"==t(r)}}(),n=Qn(),r=Or(),e=r&&r.isSet,o=e?n(e):t;return He=o}function gc(){if(We)return Ye;We=1;var t=Mn(),n=Sn(),r=Cn(),e=function(){if(mr)return yr;mr=1;var t=Ln(),n=Tr();return yr=function(r,e){return r&&t(e,n(e),r)}}(),o=function(){if(Ir)return kr;Ir=1;var t=Ln(),n=$r();return kr=function(r,e){return r&&t(e,n(e),r)}}(),i=Ka(),u=Xa(),a=function(){if(Wr)return Yr;Wr=1;var t=Ln(),n=tc();return Yr=function(r,e){return t(r,n(r),e)}}(),c=function(){if(re)return ne;re=1;var t=Ln(),n=ec();return ne=function(r,e){return t(r,n(r),e)}}(),f=ic(),s=function(){if(ce)return ae;ce=1;var t=oc(),n=ec(),r=$r();return ae=function(e){return t(e,r,n)}}(),h=ac(),d=function(){if(we)return be;we=1;var t=Object.prototype.hasOwnProperty;return be=function(n){var r=n.length,e=new n.constructor(r);return r&&"string"==typeof n[0]&&t.call(n,"index")&&(e.index=n.index,e.input=n.input),e}}(),l=hc(),v=lc(),p=$n(),g=Kn(),y=vc(),m=bn(),b=pc(),w=Tr(),_=$r(),E="[object Arguments]",x="[object Function]",j="[object Object]",k={};return k[E]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k[j]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k[x]=k["[object WeakMap]"]=!1,Ye=function I(N,O,M,S,A,z){var C,L=1&O,T=2&O,P=4&O;if(M&&(C=A?M(N,S,A,z):M(N)),void 0!==C)return C;if(!m(N))return N;var $=p(N);if($){if(C=d(N),!L)return u(N,C)}else{var F=h(N),R=F==x||"[object GeneratorFunction]"==F;if(g(N))return i(N,L);if(F==j||F==E||R&&!A){if(C=T||R?{}:v(N),!L)return T?c(N,o(C,N)):a(N,e(C,N))}else{if(!k[F])return A?N:{};C=l(N,F,L)}}z||(z=new t);var D=z.get(N);if(D)return D;z.set(N,C),b(N)?N.forEach((function(t){C.add(I(t,O,M,t,N,z))})):y(N)&&N.forEach((function(t,n){C.set(n,I(t,O,M,n,N,z))}));var B=$?void 0:(P?T?s:f:T?_:w)(N);return n(B||N,(function(t,n){B&&(t=N[n=t]),r(C,n,I(t,O,M,n,N,z))})),C},Ye}function yc(){if(Ke)return Ze;Ke=1;var t=gc();return Ze=function(n){return t(n,4)}}function mc(){if(Je)return Xe;return Je=1,Xe=function(t){return function(){return t}}}function bc(){if(ro)return no;ro=1;var t=(to?Qe:(to=1,Qe=function(t){return function(n,r,e){for(var o=-1,i=Object(n),u=e(n),a=u.length;a--;){var c=u[t?a:++o];if(!1===r(i[c],c,i))break}return n}}))();return no=t}function wc(){if(oo)return eo;oo=1;var t=bc(),n=Tr();return eo=function(r,e){return r&&t(r,e,n)}}function _c(){if(co)return ao;co=1;var t=wc(),n=function(){if(uo)return io;uo=1;var t=Lr();return io=function(n,r){return function(e,o){if(null==e)return e;if(!t(e))return n(e,o);for(var i=e.length,u=r?i:-1,a=Object(e);(r?u--:++u<i)&&!1!==o(a[u],u,a););return e}}}()(t);return ao=n}function Ec(){if(so)return fo;return so=1,fo=function(t){return t}}function xc(){if(lo)return ho;lo=1;var t=Ec();return ho=function(n){return"function"==typeof n?n:t}}function jc(){if(po)return vo;po=1;var t=Sn(),n=_c(),r=xc(),e=$n();return vo=function(o,i){return(e(o)?t:n)(o,r(i))}}function kc(){return yo?go:(yo=1,go=jc())}function Ic(){if(ko)return jo;ko=1;var t=On(),n=_o?wo:(_o=1,wo=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),r=xo?Eo:(xo=1,Eo=function(t){return this.__data__.has(t)});function e(n){var r=-1,e=null==n?0:n.length;for(this.__data__=new t;++r<e;)this.add(n[r])}return e.prototype.add=e.prototype.push=n,e.prototype.has=r,jo=e}function Nc(){if(Mo)return Oo;return Mo=1,Oo=function(t,n){return t.has(n)}}function Oc(){if(Ao)return So;Ao=1;var t=Ic(),n=No?Io:(No=1,Io=function(t,n){for(var r=-1,e=null==t?0:t.length;++r<e;)if(n(t[r],r,t))return!0;return!1}),r=Nc();return So=function(e,o,i,u,a,c){var f=1&i,s=e.length,h=o.length;if(s!=h&&!(f&&h>s))return!1;var d=c.get(e),l=c.get(o);if(d&&l)return d==o&&l==e;var v=-1,p=!0,g=2&i?new t:void 0;for(c.set(e,o),c.set(o,e);++v<s;){var y=e[v],m=o[v];if(u)var b=f?u(m,y,v,o,e,c):u(y,m,v,e,o,c);if(void 0!==b){if(b)continue;p=!1;break}if(g){if(!n(o,(function(t,n){if(!r(g,n)&&(y===t||a(y,t,i,u,c)))return g.push(n)}))){p=!1;break}}else if(y!==m&&!a(y,m,i,u,c)){p=!1;break}}return c.delete(e),c.delete(o),p}}function Mc(){if(To)return Lo;return To=1,Lo=function(t){var n=-1,r=Array(t.size);return t.forEach((function(t){r[++n]=t})),r}}function Sc(){if($o)return Po;$o=1;var t=yn(),n=cc(),r=dn(),e=Oc(),o=Co?zo:(Co=1,zo=function(t){var n=-1,r=Array(t.size);return t.forEach((function(t,e){r[++n]=[e,t]})),r}),i=Mc(),u=t?t.prototype:void 0,a=u?u.valueOf:void 0;return Po=function(t,u,c,f,s,h,d){switch(c){case"[object DataView]":if(t.byteLength!=u.byteLength||t.byteOffset!=u.byteOffset)return!1;t=t.buffer,u=u.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=u.byteLength||!h(new n(t),new n(u)));case"[object Boolean]":case"[object Date]":case"[object Number]":return r(+t,+u);case"[object Error]":return t.name==u.name&&t.message==u.message;case"[object RegExp]":case"[object String]":return t==u+"";case"[object Map]":var l=o;case"[object Set]":var v=1&f;if(l||(l=i),t.size!=u.size&&!v)return!1;var p=d.get(t);if(p)return p==u;f|=2,d.set(t,u);var g=e(l(t),l(u),f,s,h,d);return d.delete(t),g;case"[object Symbol]":if(a)return a.call(t)==a.call(u)}return!1}}function Ac(){if(Bo)return Do;Bo=1;var t=Mn(),n=Oc(),r=Sc(),e=function(){if(Ro)return Fo;Ro=1;var t=ic(),n=Object.prototype.hasOwnProperty;return Fo=function(r,e,o,i,u,a){var c=1&o,f=t(r),s=f.length;if(s!=t(e).length&&!c)return!1;for(var h=s;h--;){var d=f[h];if(!(c?d in e:n.call(e,d)))return!1}var l=a.get(r),v=a.get(e);if(l&&v)return l==e&&v==r;var p=!0;a.set(r,e),a.set(e,r);for(var g=c;++h<s;){var y=r[d=f[h]],m=e[d];if(i)var b=c?i(m,y,d,e,r,a):i(y,m,d,r,e,a);if(!(void 0===b?y===m||u(y,m,o,i,a):b)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var w=r.constructor,_=e.constructor;w==_||!("constructor"in r)||!("constructor"in e)||"function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _||(p=!1)}return a.delete(r),a.delete(e),p}}(),o=ac(),i=$n(),u=Kn(),a=Mr(),c="[object Arguments]",f="[object Array]",s="[object Object]",h=Object.prototype.hasOwnProperty;return Do=function(d,l,v,p,g,y){var m=i(d),b=i(l),w=m?f:o(d),_=b?f:o(l),E=(w=w==c?s:w)==s,x=(_=_==c?s:_)==s,j=w==_;if(j&&u(d)){if(!u(l))return!1;m=!0,E=!1}if(j&&!E)return y||(y=new t),m||a(d)?n(d,l,v,p,g,y):r(d,l,w,v,p,g,y);if(!(1&v)){var k=E&&h.call(d,"__wrapped__"),I=x&&h.call(l,"__wrapped__");if(k||I){var N=k?d.value():d,O=I?l.value():l;return y||(y=new t),g(N,O,v,p,y)}}return!!j&&(y||(y=new t),e(d,l,v,p,g,y))}}function zc(){if(Uo)return Go;Uo=1;var t=Ac(),n=Tn();return Go=function r(e,o,i,u,a){return e===o||(null==e||null==o||!n(e)&&!n(o)?e!=e&&o!=o:t(e,o,i,u,r,a))},Go}function Cc(){if(Yo)return qo;Yo=1;var t=bn();return qo=function(n){return n==n&&!t(n)}}function Lc(){if(Xo)return Ko;return Xo=1,Ko=function(t,n){return function(r){return null!=r&&(r[t]===n&&(void 0!==n||t in Object(r)))}}}function Tc(){if(Qo)return Jo;Qo=1;var t=function(){if(Ho)return Vo;Ho=1;var t=Mn(),n=zc();return Vo=function(r,e,o,i){var u=o.length,a=u,c=!i;if(null==r)return!a;for(r=Object(r);u--;){var f=o[u];if(c&&f[2]?f[1]!==r[f[0]]:!(f[0]in r))return!1}for(;++u<a;){var s=(f=o[u])[0],h=r[s],d=f[1];if(c&&f[2]){if(void 0===h&&!(s in r))return!1}else{var l=new t;if(i)var v=i(h,d,s,r,e,l);if(!(void 0===v?n(d,h,3,i,l):v))return!1}}return!0}}(),n=function(){if(Zo)return Wo;Zo=1;var t=Cc(),n=Tr();return Wo=function(r){for(var e=n(r),o=e.length;o--;){var i=e[o],u=r[i];e[o]=[i,u,t(u)]}return e}}(),r=Lc();return Jo=function(e){var o=n(e);return 1==o.length&&o[0][2]?r(o[0][0],o[0][1]):function(n){return n===e||t(n,e,o)}}}function Pc(){if(ni)return ti;ni=1;var t=mn(),n=Tn();return ti=function(r){return"symbol"==typeof r||n(r)&&"[object Symbol]"==t(r)}}function $c(){if(ei)return ri;ei=1;var t=$n(),n=Pc(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,e=/^\w*$/;return ri=function(o,i){if(t(o))return!1;var u=typeof o;return!("number"!=u&&"symbol"!=u&&"boolean"!=u&&null!=o&&!n(o))||(e.test(o)||!r.test(o)||null!=i&&o in Object(i))}}function Fc(){if(ai)return ui;ai=1;var t=function(){if(ii)return oi;ii=1;var t=On();function n(r,e){if("function"!=typeof r||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var o=function(){var t=arguments,n=e?e.apply(this,t):t[0],i=o.cache;if(i.has(n))return i.get(n);var u=r.apply(this,t);return o.cache=i.set(n,u)||i,u};return o.cache=new(n.Cache||t),o}return n.Cache=t,oi=n}();return ui=function(n){var r=t(n,(function(t){return 500===e.size&&e.clear(),t})),e=r.cache;return r}}function Rc(){if(hi)return si;return hi=1,si=function(t,n){for(var r=-1,e=null==t?0:t.length,o=Array(e);++r<e;)o[r]=n(t[r],r,t);return o}}function Dc(){if(pi)return vi;pi=1;var t=function(){if(li)return di;li=1;var t=yn(),n=Rc(),r=$n(),e=Pc(),o=t?t.prototype:void 0,i=o?o.toString:void 0;return di=function t(o){if("string"==typeof o)return o;if(r(o))return n(o,t)+"";if(e(o))return i?i.call(o):"";var u=o+"";return"0"==u&&1/o==-1/0?"-0":u},di}();return vi=function(n){return null==n?"":t(n)}}function Bc(){if(yi)return gi;yi=1;var t=$n(),n=$c(),r=function(){if(fi)return ci;fi=1;var t=Fc(),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,e=t((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,(function(t,n,o,i){e.push(o?i.replace(r,"$1"):n||t)})),e}));return ci=e}(),e=Dc();return gi=function(o,i){return t(o)?o:n(o,i)?[o]:r(e(o))}}function Gc(){if(bi)return mi;bi=1;var t=Pc();return mi=function(n){if("string"==typeof n||t(n))return n;var r=n+"";return"0"==r&&1/n==-Infinity?"-0":r}}function Uc(){if(_i)return wi;_i=1;var t=Bc(),n=Gc();return wi=function(r,e){for(var o=0,i=(e=t(e,r)).length;null!=r&&o<i;)r=r[n(e[o++])];return o&&o==i?r:void 0}}function Vc(){if(Ni)return Ii;Ni=1;var t=Bc(),n=Pn(),r=$n(),e=Xn(),o=Jn(),i=Gc();return Ii=function(u,a,c){for(var f=-1,s=(a=t(a,u)).length,h=!1;++f<s;){var d=i(a[f]);if(!(h=null!=u&&c(u,d)))break;u=u[d]}return h||++f!=s?h:!!(s=null==u?0:u.length)&&o(s)&&e(d,s)&&(r(u)||n(u))}}function Hc(){if(Mi)return Oi;Mi=1;var t=ki?ji:(ki=1,ji=function(t,n){return null!=t&&n in Object(t)}),n=Vc();return Oi=function(r,e){return null!=r&&n(r,e,t)}}function qc(){if(Ai)return Si;Ai=1;var t=zc(),n=function(){if(xi)return Ei;xi=1;var t=Uc();return Ei=function(n,r,e){var o=null==n?void 0:t(n,r);return void 0===o?e:o}}(),r=Hc(),e=$c(),o=Cc(),i=Lc(),u=Gc();return Si=function(a,c){return e(a)&&o(c)?i(u(a),c):function(e){var o=n(e,a);return void 0===o&&o===c?r(e,a):t(c,o,3)}}}function Yc(){if(Ci)return zi;return Ci=1,zi=function(t){return function(n){return null==n?void 0:n[t]}}}function Wc(){if($i)return Pi;$i=1;var t=Yc(),n=function(){if(Ti)return Li;Ti=1;var t=Uc();return Li=function(n){return function(r){return t(r,n)}}}(),r=$c(),e=Gc();return Pi=function(o){return r(o)?t(e(o)):n(o)}}function Zc(){if(Ri)return Fi;Ri=1;var t=Tc(),n=qc(),r=Ec(),e=$n(),o=Wc();return Fi=function(i){return"function"==typeof i?i:null==i?r:"object"==typeof i?e(i)?n(i[0],i[1]):t(i):o(i)}}function Kc(){if(Bi)return Di;Bi=1;var t=Ja(),n=function(){if(bo)return mo;bo=1;var t=_c();return mo=function(n,r){var e=[];return t(n,(function(t,n,o){r(t,n,o)&&e.push(t)})),e}}(),r=Zc(),e=$n();return Di=function(o,i){return(e(o)?t:n)(o,r(i,3))}}function Xc(){if(Hi)return Vi;Hi=1;var t=function(){if(Ui)return Gi;Ui=1;var t=Object.prototype.hasOwnProperty;return Gi=function(n,r){return null!=n&&t.call(n,r)}}(),n=Vc();return Vi=function(r,e){return null!=r&&n(r,e,t)}}function Jc(){if(Yi)return qi;Yi=1;var t=Cr(),n=ac(),r=Pn(),e=$n(),o=Lr(),i=Kn(),u=Ar(),a=Mr(),c=Object.prototype.hasOwnProperty;return qi=function(f){if(null==f)return!0;if(o(f)&&(e(f)||"string"==typeof f||"function"==typeof f.splice||i(f)||a(f)||r(f)))return!f.length;var s=n(f);if("[object Map]"==s||"[object Set]"==s)return!f.size;if(u(f))return!t(f).length;for(var h in f)if(c.call(f,h))return!1;return!0}}function Qc(){if(Zi)return Wi;return Zi=1,Wi=function(t){return void 0===t}}function tf(){if(Xi)return Ki;Xi=1;var t=_c(),n=Lr();return Ki=function(r,e){var o=-1,i=n(r)?Array(r.length):[];return t(r,(function(t,n,r){i[++o]=e(t,n,r)})),i}}function nf(){if(Qi)return Ji;Qi=1;var t=Rc(),n=Zc(),r=tf(),e=$n();return Ji=function(o,i){return(e(o)?t:r)(o,n(i,3))}}function rf(){if(iu)return ou;iu=1;var t=nu?tu:(nu=1,tu=function(t,n,r,e){var o=-1,i=null==t?0:t.length;for(e&&i&&(r=t[++o]);++o<i;)r=n(r,t[o],o,t);return r}),n=_c(),r=Zc(),e=eu?ru:(eu=1,ru=function(t,n,r,e,o){return o(t,(function(t,o,i){r=e?(e=!1,t):n(r,t,o,i)})),r}),o=$n();return ou=function(i,u,a){var c=o(i)?t:e,f=arguments.length<3;return c(i,r(u,4),a,f,n)},ou}function ef(){if(pu)return vu;pu=1;var t=function(){if(fu)return cu;fu=1;var t=Yc()("length");return cu=t}(),n=function(){if(hu)return su;hu=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return su=function(n){return t.test(n)}}(),r=function(){if(lu)return du;lu=1;var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",e="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",i="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",a="(?:"+r+"|"+e+")?",c="[\\ufe0e\\ufe0f]?",f=c+a+"(?:\\u200d(?:"+[o,i,u].join("|")+")"+c+a+")*",s="(?:"+[o+r+"?",r,i,u,n].join("|")+")",h=RegExp(e+"(?="+e+")|"+s+f,"g");return du=function(t){for(var n=h.lastIndex=0;h.test(t);)++n;return n}}();return vu=function(e){return n(e)?r(e):t(e)}}function of(){if(yu)return gu;yu=1;var t=Cr(),n=ac(),r=Lr(),e=function(){if(au)return uu;au=1;var t=mn(),n=$n(),r=Tn();return uu=function(e){return"string"==typeof e||!n(e)&&r(e)&&"[object String]"==t(e)}}(),o=ef();return gu=function(i){if(null==i)return 0;if(r(i))return e(i)?o(i):i.length;var u=n(i);return"[object Map]"==u||"[object Set]"==u?i.size:t(i).length}}function uf(){if(bu)return mu;bu=1;var t=Sn(),n=dc(),r=wc(),e=Zc(),o=rc(),i=$n(),u=Kn(),a=wn(),c=bn(),f=Mr();return mu=function(s,h,d){var l=i(s),v=l||u(s)||f(s);if(h=e(h,4),null==d){var p=s&&s.constructor;d=v?l?new p:[]:c(s)&&a(p)?n(o(s)):{}}return(v?t:r)(s,(function(t,n,r){return h(d,t,n,r)})),d}}function af(){if(xu)return Eu;xu=1;var t=nc(),n=function(){if(_u)return wu;_u=1;var t=yn(),n=Pn(),r=$n(),e=t?t.isConcatSpreadable:void 0;return wu=function(t){return r(t)||n(t)||!!(e&&t&&t[e])}}();return Eu=function r(e,o,i,u,a){var c=-1,f=e.length;for(i||(i=n),a||(a=[]);++c<f;){var s=e[c];o>0&&i(s)?o>1?r(s,o-1,i,u,a):t(a,s):u||(a[a.length]=s)}return a},Eu}function cf(){if(Nu)return Iu;Nu=1;var t=ku?ju:(ku=1,ju=function(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}),n=Math.max;return Iu=function(r,e,o){return e=n(void 0===e?r.length-1:e,0),function(){for(var i=arguments,u=-1,a=n(i.length-e,0),c=Array(a);++u<a;)c[u]=i[e+u];u=-1;for(var f=Array(e+1);++u<e;)f[u]=i[u];return f[e]=o(c),t(r,this,f)}},Iu}function ff(){if(Cu)return zu;Cu=1;var t=function(){if(Mu)return Ou;Mu=1;var t=mc(),n=An(),r=Ec();return Ou=n?function(r,e){return n(r,"toString",{configurable:!0,enumerable:!1,value:t(e),writable:!0})}:r}(),n=function(){if(Au)return Su;Au=1;var t=Date.now;return Su=function(n){var r=0,e=0;return function(){var o=t(),i=16-(o-e);if(e=o,i>0){if(++r>=800)return arguments[0]}else r=0;return n.apply(void 0,arguments)}},Su}(),r=n(t);return zu=r}function sf(){if(Tu)return Lu;Tu=1;var t=Ec(),n=cf(),r=ff();return Lu=function(e,o){return r(n(e,o,t),e+"")}}function hf(){if($u)return Pu;return $u=1,Pu=function(t,n,r,e){for(var o=t.length,i=r+(e?1:-1);e?i--:++i<o;)if(n(t[i],i,t))return i;return-1}}function df(){if(Uu)return Gu;Uu=1;var t=hf(),n=Ru?Fu:(Ru=1,Fu=function(t){return t!=t}),r=Bu?Du:(Bu=1,Du=function(t,n,r){for(var e=r-1,o=t.length;++e<o;)if(t[e]===n)return e;return-1});return Gu=function(e,o,i){return o==o?r(e,o,i):t(e,n,i)}}function lf(){if(Xu)return Ku;Xu=1;var t=uc(),n=Zu?Wu:(Zu=1,Wu=function(){}),r=Mc(),e=t&&1/r(new t([,-0]))[1]==1/0?function(n){return new t(n)}:n;return Ku=e}function vf(){if(Qu)return Ju;Qu=1;var t=Ic(),n=function(){if(Hu)return Vu;Hu=1;var t=df();return Vu=function(n,r){return!(null==n||!n.length)&&t(n,r,0)>-1}}(),r=Yu?qu:(Yu=1,qu=function(t,n,r){for(var e=-1,o=null==t?0:t.length;++e<o;)if(r(n,t[e]))return!0;return!1}),e=Nc(),o=lf(),i=Mc();return Ju=function(u,a,c){var f=-1,s=n,h=u.length,d=!0,l=[],v=l;if(c)d=!1,s=r;else if(h>=200){var p=a?null:o(u);if(p)return i(p);d=!1,s=e,v=new t}else v=a?[]:l;t:for(;++f<h;){var g=u[f],y=a?a(g):g;if(g=c||0!==g?g:0,d&&y==y){for(var m=v.length;m--;)if(v[m]===y)continue t;a&&v.push(y),l.push(g)}else s(v,y,c)||(v!==l&&v.push(y),l.push(g))}return l}}function pf(){if(na)return ta;na=1;var t=Lr(),n=Tn();return ta=function(r){return n(r)&&t(r)}}function gf(){if(ea)return ra;ea=1;var t=af(),n=sf(),r=vf(),e=pf(),o=n((function(n){return r(t(n,1,e,!0))}));return ra=o}function yf(){if(aa)return ua;aa=1;var t=function(){if(ia)return oa;ia=1;var t=Rc();return oa=function(n,r){return t(r,(function(t){return n[t]}))}}(),n=Tr();return ua=function(r){return null==r?[]:t(r,n(r))}}function mf(){if(fa)return ca;var t;fa=1;try{t={clone:yc(),constant:mc(),each:kc(),filter:Kc(),has:Xc(),isArray:$n(),isEmpty:Jc(),isFunction:wn(),isUndefined:Qc(),keys:Tr(),map:nf(),reduce:rf(),size:of(),transform:uf(),union:gf(),values:yf()}}catch(t){}return t||(t=window._),ca=t}function bf(){if(ha)return sa;ha=1;var t=mf();sa=o;var n="\0",r="\0",e="";function o(n){this._isDirected=!t.has(n,"directed")||n.directed,this._isMultigraph=!!t.has(n,"multigraph")&&n.multigraph,this._isCompound=!!t.has(n,"compound")&&n.compound,this._label=void 0,this._defaultNodeLabelFn=t.constant(void 0),this._defaultEdgeLabelFn=t.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function i(t,n){t[n]?t[n]++:t[n]=1}function u(t,n){--t[n]||delete t[n]}function a(r,o,i,u){var a=""+o,c=""+i;if(!r&&a>c){var f=a;a=c,c=f}return a+e+c+e+(t.isUndefined(u)?n:u)}function c(t,n){return a(t,n.v,n.w,n.name)}return o.prototype._nodeCount=0,o.prototype._edgeCount=0,o.prototype.isDirected=function(){return this._isDirected},o.prototype.isMultigraph=function(){return this._isMultigraph},o.prototype.isCompound=function(){return this._isCompound},o.prototype.setGraph=function(t){return this._label=t,this},o.prototype.graph=function(){return this._label},o.prototype.setDefaultNodeLabel=function(n){return t.isFunction(n)||(n=t.constant(n)),this._defaultNodeLabelFn=n,this},o.prototype.nodeCount=function(){return this._nodeCount},o.prototype.nodes=function(){return t.keys(this._nodes)},o.prototype.sources=function(){var n=this;return t.filter(this.nodes(),(function(r){return t.isEmpty(n._in[r])}))},o.prototype.sinks=function(){var n=this;return t.filter(this.nodes(),(function(r){return t.isEmpty(n._out[r])}))},o.prototype.setNodes=function(n,r){var e=arguments,o=this;return t.each(n,(function(t){e.length>1?o.setNode(t,r):o.setNode(t)})),this},o.prototype.setNode=function(n,e){return t.has(this._nodes,n)?(arguments.length>1&&(this._nodes[n]=e),this):(this._nodes[n]=arguments.length>1?e:this._defaultNodeLabelFn(n),this._isCompound&&(this._parent[n]=r,this._children[n]={},this._children[r][n]=!0),this._in[n]={},this._preds[n]={},this._out[n]={},this._sucs[n]={},++this._nodeCount,this)},o.prototype.node=function(t){return this._nodes[t]},o.prototype.hasNode=function(n){return t.has(this._nodes,n)},o.prototype.removeNode=function(n){var r=this;if(t.has(this._nodes,n)){var e=function(t){r.removeEdge(r._edgeObjs[t])};delete this._nodes[n],this._isCompound&&(this._removeFromParentsChildList(n),delete this._parent[n],t.each(this.children(n),(function(t){r.setParent(t)})),delete this._children[n]),t.each(t.keys(this._in[n]),e),delete this._in[n],delete this._preds[n],t.each(t.keys(this._out[n]),e),delete this._out[n],delete this._sucs[n],--this._nodeCount}return this},o.prototype.setParent=function(n,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(t.isUndefined(e))e=r;else{for(var o=e+="";!t.isUndefined(o);o=this.parent(o))if(o===n)throw new Error("Setting "+e+" as parent of "+n+" would create a cycle");this.setNode(e)}return this.setNode(n),this._removeFromParentsChildList(n),this._parent[n]=e,this._children[e][n]=!0,this},o.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},o.prototype.parent=function(t){if(this._isCompound){var n=this._parent[t];if(n!==r)return n}},o.prototype.children=function(n){if(t.isUndefined(n)&&(n=r),this._isCompound){var e=this._children[n];if(e)return t.keys(e)}else{if(n===r)return this.nodes();if(this.hasNode(n))return[]}},o.prototype.predecessors=function(n){var r=this._preds[n];if(r)return t.keys(r)},o.prototype.successors=function(n){var r=this._sucs[n];if(r)return t.keys(r)},o.prototype.neighbors=function(n){var r=this.predecessors(n);if(r)return t.union(r,this.successors(n))},o.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},o.prototype.filterNodes=function(n){var r=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});r.setGraph(this.graph());var e=this;t.each(this._nodes,(function(t,e){n(e)&&r.setNode(e,t)})),t.each(this._edgeObjs,(function(t){r.hasNode(t.v)&&r.hasNode(t.w)&&r.setEdge(t,e.edge(t))}));var o={};function i(t){var n=e.parent(t);return void 0===n||r.hasNode(n)?(o[t]=n,n):n in o?o[n]:i(n)}return this._isCompound&&t.each(r.nodes(),(function(t){r.setParent(t,i(t))})),r},o.prototype.setDefaultEdgeLabel=function(n){return t.isFunction(n)||(n=t.constant(n)),this._defaultEdgeLabelFn=n,this},o.prototype.edgeCount=function(){return this._edgeCount},o.prototype.edges=function(){return t.values(this._edgeObjs)},o.prototype.setPath=function(n,r){var e=this,o=arguments;return t.reduce(n,(function(t,n){return o.length>1?e.setEdge(t,n,r):e.setEdge(t,n),n})),this},o.prototype.setEdge=function(){var n,r,e,o,u=!1,c=arguments[0];"object"==typeof c&&null!==c&&"v"in c?(n=c.v,r=c.w,e=c.name,2===arguments.length&&(o=arguments[1],u=!0)):(n=c,r=arguments[1],e=arguments[3],arguments.length>2&&(o=arguments[2],u=!0)),n=""+n,r=""+r,t.isUndefined(e)||(e=""+e);var f=a(this._isDirected,n,r,e);if(t.has(this._edgeLabels,f))return u&&(this._edgeLabels[f]=o),this;if(!t.isUndefined(e)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(n),this.setNode(r),this._edgeLabels[f]=u?o:this._defaultEdgeLabelFn(n,r,e);var s=function(t,n,r,e){var o=""+n,i=""+r;if(!t&&o>i){var u=o;o=i,i=u}var a={v:o,w:i};e&&(a.name=e);return a}(this._isDirected,n,r,e);return n=s.v,r=s.w,Object.freeze(s),this._edgeObjs[f]=s,i(this._preds[r],n),i(this._sucs[n],r),this._in[r][f]=s,this._out[n][f]=s,this._edgeCount++,this},o.prototype.edge=function(t,n,r){var e=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,t,n,r);return this._edgeLabels[e]},o.prototype.hasEdge=function(n,r,e){var o=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,n,r,e);return t.has(this._edgeLabels,o)},o.prototype.removeEdge=function(t,n,r){var e=1===arguments.length?c(this._isDirected,arguments[0]):a(this._isDirected,t,n,r),o=this._edgeObjs[e];return o&&(t=o.v,n=o.w,delete this._edgeLabels[e],delete this._edgeObjs[e],u(this._preds[n],t),u(this._sucs[t],n),delete this._in[n][e],delete this._out[t][e],this._edgeCount--),this},o.prototype.inEdges=function(n,r){var e=this._in[n];if(e){var o=t.values(e);return r?t.filter(o,(function(t){return t.v===r})):o}},o.prototype.outEdges=function(n,r){var e=this._out[n];if(e){var o=t.values(e);return r?t.filter(o,(function(t){return t.w===r})):o}},o.prototype.nodeEdges=function(t,n){var r=this.inEdges(t,n);if(r)return r.concat(this.outEdges(t,n))},sa}function wf(){return pa?va:(pa=1,va={Graph:bf(),version:la?da:(la=1,da="2.1.8")})}function _f(){if(ya)return ga;ya=1;var t=mf(),n=bf();function r(n){return t.map(n.nodes(),(function(r){var e=n.node(r),o=n.parent(r),i={v:r};return t.isUndefined(e)||(i.value=e),t.isUndefined(o)||(i.parent=o),i}))}function e(n){return t.map(n.edges(),(function(r){var e=n.edge(r),o={v:r.v,w:r.w};return t.isUndefined(r.name)||(o.name=r.name),t.isUndefined(e)||(o.value=e),o}))}return ga={write:function(n){var o={options:{directed:n.isDirected(),multigraph:n.isMultigraph(),compound:n.isCompound()},nodes:r(n),edges:e(n)};t.isUndefined(n.graph())||(o.value=t.clone(n.graph()));return o},read:function(r){var e=new n(r.options).setGraph(r.value);return t.each(r.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),t.each(r.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}}function Ef(){if(ba)return ma;ba=1;var t=mf();return ma=function(n){var r,e={},o=[];function i(o){t.has(e,o)||(e[o]=!0,r.push(o),t.each(n.successors(o),i),t.each(n.predecessors(o),i))}return t.each(n.nodes(),(function(t){r=[],i(t),r.length&&o.push(r)})),o},ma}function xf(){if(_a)return wa;_a=1;var t=mf();function n(){this._arr=[],this._keyIndices={}}return wa=n,n.prototype.size=function(){return this._arr.length},n.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},n.prototype.has=function(n){return t.has(this._keyIndices,n)},n.prototype.priority=function(t){var n=this._keyIndices[t];if(void 0!==n)return this._arr[n].priority},n.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},n.prototype.add=function(n,r){var e=this._keyIndices;if(n=String(n),!t.has(e,n)){var o=this._arr,i=o.length;return e[n]=i,o.push({key:n,priority:r}),this._decrease(i),!0}return!1},n.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},n.prototype.decrease=function(t,n){var r=this._keyIndices[t];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)},n.prototype._heapify=function(t){var n=this._arr,r=2*t,e=r+1,o=t;r<n.length&&(o=n[r].priority<n[o].priority?r:o,e<n.length&&(o=n[e].priority<n[o].priority?e:o),o!==t&&(this._swap(t,o),this._heapify(o)))},n.prototype._decrease=function(t){for(var n,r=this._arr,e=r[t].priority;0!==t&&!(r[n=t>>1].priority<e);)this._swap(t,n),t=n},n.prototype._swap=function(t,n){var r=this._arr,e=this._keyIndices,o=r[t],i=r[n];r[t]=i,r[n]=o,e[i.key]=t,e[o.key]=n},wa}function jf(){if(xa)return Ea;xa=1;var t=mf(),n=xf();Ea=function(t,e,o,i){return function(t,r,e,o){var i,u,a={},c=new n,f=function(t){var n=t.v!==i?t.v:t.w,r=a[n],o=e(t),f=u.distance+o;if(o<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+o);f<r.distance&&(r.distance=f,r.predecessor=i,c.decrease(n,f))};t.nodes().forEach((function(t){var n=t===r?0:Number.POSITIVE_INFINITY;a[t]={distance:n},c.add(t,n)}));for(;c.size()>0&&(i=c.removeMin(),(u=a[i]).distance!==Number.POSITIVE_INFINITY);)o(i).forEach(f);return a}(t,String(e),o||r,i||function(n){return t.outEdges(n)})};var r=t.constant(1);return Ea}function kf(){if(ka)return ja;ka=1;var t=jf(),n=mf();return ja=function(r,e,o){return n.transform(r.nodes(),(function(n,i){n[i]=t(r,i,e,o)}),{})}}function If(){if(Na)return Ia;Na=1;var t=mf();return Ia=function(n){var r=0,e=[],o={},i=[];function u(a){var c=o[a]={onStack:!0,lowlink:r,index:r++};if(e.push(a),n.successors(a).forEach((function(n){t.has(o,n)?o[n].onStack&&(c.lowlink=Math.min(c.lowlink,o[n].index)):(u(n),c.lowlink=Math.min(c.lowlink,o[n].lowlink))})),c.lowlink===c.index){var f,s=[];do{f=e.pop(),o[f].onStack=!1,s.push(f)}while(a!==f);i.push(s)}}return n.nodes().forEach((function(n){t.has(o,n)||u(n)})),i},Ia}function Nf(){if(Ma)return Oa;Ma=1;var t=mf(),n=If();return Oa=function(r){return t.filter(n(r),(function(t){return t.length>1||1===t.length&&r.hasEdge(t[0],t[0])}))}}function Of(){if(Aa)return Sa;Aa=1;var t=mf();Sa=function(t,r,e){return function(t,n,r){var e={},o=t.nodes();return o.forEach((function(t){e[t]={},e[t][t]={distance:0},o.forEach((function(n){t!==n&&(e[t][n]={distance:Number.POSITIVE_INFINITY})})),r(t).forEach((function(r){var o=r.v===t?r.w:r.v,i=n(r);e[t][o]={distance:i,predecessor:t}}))})),o.forEach((function(t){var n=e[t];o.forEach((function(r){var i=e[r];o.forEach((function(r){var e=i[t],o=n[r],u=i[r],a=e.distance+o.distance;a<u.distance&&(u.distance=a,u.predecessor=o.predecessor)}))}))})),e}(t,r||n,e||function(n){return t.outEdges(n)})};var n=t.constant(1);return Sa}function Mf(){if(Ca)return za;Ca=1;var t=mf();function n(n){var e={},o={},i=[];if(t.each(n.sinks(),(function u(a){if(t.has(o,a))throw new r;t.has(e,a)||(o[a]=!0,e[a]=!0,t.each(n.predecessors(a),u),delete o[a],i.push(a))})),t.size(e)!==n.nodeCount())throw new r;return i}function r(){}return za=n,n.CycleException=r,r.prototype=new Error,za}function Sf(){if(Ta)return La;Ta=1;var t=Mf();return La=function(n){try{t(n)}catch(n){if(n instanceof t.CycleException)return!1;throw n}return!0}}function Af(){if($a)return Pa;$a=1;var t=mf();function n(r,e,o,i,u,a){t.has(i,e)||(i[e]=!0,o||a.push(e),t.each(u(e),(function(t){n(r,t,o,i,u,a)})),o&&a.push(e))}return Pa=function(r,e,o){t.isArray(e)||(e=[e]);var i=(r.isDirected()?r.successors:r.neighbors).bind(r),u=[],a={};return t.each(e,(function(t){if(!r.hasNode(t))throw new Error("Graph does not have node: "+t);n(r,t,"post"===o,a,i,u)})),u},Pa}function zf(){if(Ra)return Fa;Ra=1;var t=Af();return Fa=function(n,r){return t(n,r,"post")}}function Cf(){if(Ba)return Da;Ba=1;var t=Af();return Da=function(n,r){return t(n,r,"pre")}}function Lf(){if(Ua)return Ga;Ua=1;var t=mf(),n=bf(),r=xf();return Ga=function(e,o){var i,u=new n,a={},c=new r;function f(t){var n=t.v===i?t.w:t.v,r=c.priority(n);if(void 0!==r){var e=o(t);e<r&&(a[n]=i,c.decrease(n,e))}}if(0===e.nodeCount())return u;t.each(e.nodes(),(function(t){c.add(t,Number.POSITIVE_INFINITY),u.setNode(t)})),c.decrease(e.nodes()[0],0);var s=!1;for(;c.size()>0;){if(i=c.removeMin(),t.has(a,i))u.setEdge(i,a[i]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(i).forEach(f)}return u}}Za.exports;try{Wa=function(){if(Ya)return qa;Ya=1;var t=wf();return qa={Graph:t.Graph,json:_f(),alg:Ha?Va:(Ha=1,Va={components:Ef(),dijkstra:jf(),dijkstraAll:kf(),findCycles:Nf(),floydWarshall:Of(),isAcyclic:Sf(),postorder:zf(),preorder:Cf(),prim:Lf(),tarjan:If(),topsort:Mf()}),version:t.version}}()}catch(t){}Wa||(Wa=window.graphlib);var Tf,Pf,$f,Ff,Rf,Df,Bf,Gf,Uf,Vf,Hf,qf,Yf,Wf,Zf,Kf,Xf,Jf,Qf,ts,ns,rs,es,os,is,us,as,cs,fs,ss,hs,ds,ls,vs,ps,gs,ys,ms,bs,ws,_s,Es,xs,js,ks,Is,Ns,Os,Ms,Ss,As,zs,Cs,Ls,Ts,Ps,$s,Fs,Rs,Ds,Bs,Gs,Us,Vs,Hs,qs,Ys,Ws,Zs,Ks,Xs,Js,Qs,th,nh,rh,eh,oh,ih,uh,ah,ch,fh,sh,hh,dh,lh,vh,ph,gh,yh,mh,bh,wh=Wa;function _h(){if(Ff)return $f;Ff=1;var t=dn(),n=Lr(),r=Xn(),e=bn();return $f=function(o,i,u){if(!e(u))return!1;var a=typeof i;return!!("number"==a?n(u)&&r(i,u.length):"string"==a&&i in u)&&t(u[i],o)}}function Eh(){if(qf)return Hf;qf=1;var t=function(){if(Vf)return Uf;Vf=1;var t=/\s/;return Uf=function(n){for(var r=n.length;r--&&t.test(n.charAt(r)););return r}}(),n=/^\s+/;return Hf=function(r){return r?r.slice(0,t(r)+1).replace(n,""):r}}function xh(){if(Kf)return Zf;Kf=1;var t=function(){if(Wf)return Yf;Wf=1;var t=Eh(),n=bn(),r=Pc(),e=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,u=parseInt;return Yf=function(a){if("number"==typeof a)return a;if(r(a))return NaN;if(n(a)){var c="function"==typeof a.valueOf?a.valueOf():a;a=n(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=t(a);var f=o.test(a);return f||i.test(a)?u(a.slice(2),f?2:8):e.test(a)?NaN:+a}}(),n=1/0;return Zf=function(r){return r?(r=t(r))===n||r===-1/0?17976931348623157e292*(r<0?-1:1):r==r?r:0:0===r?r:0}}function jh(){if(ts)return Qf;ts=1;var t=hf(),n=Zc(),r=function(){if(Jf)return Xf;Jf=1;var t=xh();return Xf=function(n){var r=t(n),e=r%1;return r==r?e?r-e:r:0}}(),e=Math.max;return Qf=function(o,i,u){var a=null==o?0:o.length;if(!a)return-1;var c=null==u?0:r(u);return c<0&&(c=e(a+c,0)),t(o,n(i,3),c)}}function kh(){if(os)return es;os=1;var t=af();return es=function(n){return(null==n?0:n.length)?t(n,1):[]}}function Ih(){if(ds)return hs;ds=1;var t=Pc();return hs=function(n,r,e){for(var o=-1,i=n.length;++o<i;){var u=n[o],a=r(u);if(null!=a&&(void 0===c?a==a&&!t(a):e(a,c)))var c=a,f=u}return f}}function Nh(){if(ms)return ys;ms=1;var t=zn(),n=dn();return ys=function(r,e,o){(void 0!==o&&!n(r[e],o)||void 0===o&&!(e in r))&&t(r,e,o)}}function Oh(){if(Es)return _s;return Es=1,_s=function(t,n){if(("constructor"!==n||"function"!=typeof t[n])&&"__proto__"!=n)return t[n]}}function Mh(){if(Is)return ks;Is=1;var t=Nh(),n=Ka(),r=sc(),e=Xa(),o=lc(),i=Pn(),u=$n(),a=pf(),c=Kn(),f=wn(),s=bn(),h=function(){if(ws)return bs;ws=1;var t=mn(),n=rc(),r=Tn(),e=Function.prototype,o=Object.prototype,i=e.toString,u=o.hasOwnProperty,a=i.call(Object);return bs=function(e){if(!r(e)||"[object Object]"!=t(e))return!1;var o=n(e);if(null===o)return!0;var c=u.call(o,"constructor")&&o.constructor;return"function"==typeof c&&c instanceof c&&i.call(c)==a}}(),d=Mr(),l=Oh(),v=function(){if(js)return xs;js=1;var t=Ln(),n=$r();return xs=function(r){return t(r,n(r))}}();return ks=function(p,g,y,m,b,w,_){var E=l(p,y),x=l(g,y),j=_.get(x);if(j)t(p,y,j);else{var k=w?w(E,x,y+"",p,g,_):void 0,I=void 0===k;if(I){var N=u(x),O=!N&&c(x),M=!N&&!O&&d(x);k=x,N||O||M?u(E)?k=E:a(E)?k=e(E):O?(I=!1,k=n(x,!0)):M?(I=!1,k=r(x,!0)):k=[]:h(x)||i(x)?(k=E,i(E)?k=v(E):s(E)&&!f(E)||(k=o(x))):I=!1}I&&(_.set(x,k),b(k,x,m,w,_),_.delete(x)),t(p,y,k)}}}function Sh(){if(Ls)return Cs;return Ls=1,Cs=function(t,n){return t<n}}function Ah(){if(Vs)return Us;Vs=1;var t=Uc(),n=function(){if(Gs)return Bs;Gs=1;var t=Cn(),n=Bc(),r=Xn(),e=bn(),o=Gc();return Bs=function(i,u,a,c){if(!e(i))return i;for(var f=-1,s=(u=n(u,i)).length,h=s-1,d=i;null!=d&&++f<s;){var l=o(u[f]),v=a;if("__proto__"===l||"constructor"===l||"prototype"===l)return i;if(f!=h){var p=d[l];void 0===(v=c?c(p,l,d):void 0)&&(v=e(p)?p:r(u[f+1])?[]:{})}t(d,l,v),d=d[l]}return i}}(),r=Bc();return Us=function(e,o,i){for(var u=-1,a=o.length,c={};++u<a;){var f=o[u],s=t(e,f);i(s,f)&&n(c,r(f,e),s)}return c}}function zh(){if(th)return Qs;th=1;var t=function(){if(Js)return Xs;Js=1;var t=Math.ceil,n=Math.max;return Xs=function(r,e,o,i){for(var u=-1,a=n(t((e-r)/(o||1)),0),c=Array(a);a--;)c[i?a:++u]=r,r+=o;return c}}(),n=_h(),r=xh();return Qs=function(e){return function(o,i,u){return u&&"number"!=typeof u&&n(o,i,u)&&(i=u=void 0),o=r(o),void 0===i?(i=o,o=0):i=r(i),u=void 0===u?o<i?1:-1:r(u),t(o,i,u,e)}}}function Ch(){if(ch)return ah;ch=1;var t=function(){if(uh)return ih;uh=1;var t=Pc();return ih=function(n,r){if(n!==r){var e=void 0!==n,o=null===n,i=n==n,u=t(n),a=void 0!==r,c=null===r,f=r==r,s=t(r);if(!c&&!s&&!u&&n>r||u&&a&&f&&!c&&!s||o&&a&&f||!e&&f||!i)return 1;if(!o&&!u&&!s&&n<r||s&&e&&i&&!o&&!u||c&&e&&i||!a&&i||!f)return-1}return 0}}();return ah=function(n,r,e){for(var o=-1,i=n.criteria,u=r.criteria,a=i.length,c=e.length;++o<a;){var f=t(i[o],u[o]);if(f)return o>=c?f:f*("desc"==e[o]?-1:1)}return n.index-r.index}}function Lh(){if(sh)return fh;sh=1;var t=Rc(),n=Uc(),r=Zc(),e=tf(),o=oh?eh:(oh=1,eh=function(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}),i=Qn(),u=Ch(),a=Ec(),c=$n();return fh=function(f,s,h){s=s.length?t(s,(function(t){return c(t)?function(r){return n(r,1===t.length?t[0]:t)}:t})):[a];var d=-1;s=t(s,i(r));var l=e(f,(function(n,r,e){return{criteria:t(s,(function(t){return t(n)})),index:++d,value:n}}));return o(l,(function(t,n){return u(t,n,h)}))}}try{bh={cloneDeep:function(){if(Pf)return Tf;Pf=1;var t=gc();return Tf=function(n){return t(n,5)}}(),constant:mc(),defaults:function(){if(Df)return Rf;Df=1;var t=sf(),n=dn(),r=_h(),e=$r(),o=Object.prototype,i=o.hasOwnProperty,u=t((function(t,u){t=Object(t);var a=-1,c=u.length,f=c>2?u[2]:void 0;for(f&&r(u[0],u[1],f)&&(c=1);++a<c;)for(var s=u[a],h=e(s),d=-1,l=h.length;++d<l;){var v=h[d],p=t[v];(void 0===p||n(p,o[v])&&!i.call(t,v))&&(t[v]=s[v])}return t}));return Rf=u}(),each:kc(),filter:Kc(),find:function(){if(rs)return ns;rs=1;var t=function(){if(Gf)return Bf;Gf=1;var t=Zc(),n=Lr(),r=Tr();return Bf=function(e){return function(o,i,u){var a=Object(o);if(!n(o)){var c=t(i,3);o=r(o),i=function(t){return c(a[t],t,a)}}var f=e(o,i,u);return f>-1?a[c?o[f]:f]:void 0}}}()(jh());return ns=t}(),flatten:kh(),forEach:jc(),forIn:function(){if(us)return is;us=1;var t=bc(),n=xc(),r=$r();return is=function(e,o){return null==e?e:t(e,n(o),r)}}(),has:Xc(),isUndefined:Qc(),last:cs?as:(cs=1,as=function(t){var n=null==t?0:t.length;return n?t[n-1]:void 0}),map:nf(),mapValues:function(){if(ss)return fs;ss=1;var t=zn(),n=wc(),r=Zc();return fs=function(e,o){var i={};return o=r(o,3),n(e,(function(n,r,e){t(i,r,o(n,r,e))})),i}}(),max:function(){if(gs)return ps;gs=1;var t=Ih(),n=vs?ls:(vs=1,ls=function(t,n){return t>n}),r=Ec();return ps=function(e){return e&&e.length?t(e,r,n):void 0}}(),merge:function(){if(zs)return As;zs=1;var t=function(){if(Os)return Ns;Os=1;var t=Mn(),n=Nh(),r=bc(),e=Mh(),o=bn(),i=$r(),u=Oh();return Ns=function a(c,f,s,h,d){c!==f&&r(f,(function(r,i){if(d||(d=new t),o(r))e(c,f,i,s,a,h,d);else{var l=h?h(u(c,i),r,i+"",c,f,d):void 0;void 0===l&&(l=r),n(c,i,l)}}),i)},Ns}(),n=function(){if(Ss)return Ms;Ss=1;var t=sf(),n=_h();return Ms=function(r){return t((function(t,e){var o=-1,i=e.length,u=i>1?e[i-1]:void 0,a=i>2?e[2]:void 0;for(u=r.length>3&&"function"==typeof u?(i--,u):void 0,a&&n(e[0],e[1],a)&&(u=i<3?void 0:u,i=1),t=Object(t);++o<i;){var c=e[o];c&&r(t,c,o,u)}return t}))}}()((function(n,r,e){t(n,r,e)}));return As=n}(),min:function(){if(Ps)return Ts;Ps=1;var t=Ih(),n=Sh(),r=Ec();return Ts=function(e){return e&&e.length?t(e,r,n):void 0}}(),minBy:function(){if(Fs)return $s;Fs=1;var t=Ih(),n=Zc(),r=Sh();return $s=function(e,o){return e&&e.length?t(e,n(o,2),r):void 0}}(),now:function(){if(Ds)return Rs;Ds=1;var t=gn();return Rs=function(){return t.Date.now()}}(),pick:function(){if(Ks)return Zs;Ks=1;var t=function(){if(qs)return Hs;qs=1;var t=Ah(),n=Hc();return Hs=function(r,e){return t(r,e,(function(t,e){return n(r,e)}))}}(),n=function(){if(Ws)return Ys;Ws=1;var t=kh(),n=cf(),r=ff();return Ys=function(e){return r(n(e,void 0,t),e+"")}}()((function(n,r){return null==n?{}:t(n,r)}));return Zs=n}(),range:function(){if(rh)return nh;rh=1;var t=zh()();return nh=t}(),reduce:rf(),sortBy:function(){if(dh)return hh;dh=1;var t=af(),n=Lh(),r=sf(),e=_h(),o=r((function(r,o){if(null==r)return[];var i=o.length;return i>1&&e(r,o[0],o[1])?o=[]:i>2&&e(o[0],o[1],o[2])&&(o=[o[0]]),n(r,t(o,1),[])}));return hh=o}(),uniqueId:function(){if(vh)return lh;vh=1;var t=Dc(),n=0;return lh=function(r){var e=++n;return t(r)+e}}(),values:yf(),zipObject:function(){if(mh)return yh;mh=1;var t=Cn(),n=gh?ph:(gh=1,ph=function(t,n,r){for(var e=-1,o=t.length,i=n.length,u={};++e<o;){var a=e<i?n[e]:void 0;r(u,t[e],a)}return u});return yh=function(r,e){return n(r||[],e||[],t)}}()}}catch(t){}bh||(bh=window._);var Th=bh,Ph=$h;function $h(){var t={};t._next=t._prev=t,this._sentinel=t}function Fh(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function Rh(t,n){if("_next"!==t&&"_prev"!==t)return n}$h.prototype.dequeue=function(){var t=this._sentinel,n=t._prev;if(n!==t)return Fh(n),n},$h.prototype.enqueue=function(t){var n=this._sentinel;t._prev&&t._next&&Fh(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n},$h.prototype.toString=function(){for(var t=[],n=this._sentinel,r=n._prev;r!==n;)t.push(JSON.stringify(r,Rh)),r=r._prev;return"["+t.join(", ")+"]"};var Dh=Th,Bh=wh.Graph,Gh=Ph,Uh=function(t,n){if(t.nodeCount()<=1)return[];var r=function(t,n){var r=new Bh,e=0,o=0;Dh.forEach(t.nodes(),(function(t){r.setNode(t,{v:t,in:0,out:0})})),Dh.forEach(t.edges(),(function(t){var i=r.edge(t.v,t.w)||0,u=n(t),a=i+u;r.setEdge(t.v,t.w,a),o=Math.max(o,r.node(t.v).out+=u),e=Math.max(e,r.node(t.w).in+=u)}));var i=Dh.range(o+e+3).map((function(){return new Gh})),u=e+1;return Dh.forEach(r.nodes(),(function(t){qh(i,u,r.node(t))})),{graph:r,buckets:i,zeroIdx:u}}(t,n||Vh),e=function(t,n,r){var e,o=[],i=n[n.length-1],u=n[0];for(;t.nodeCount();){for(;e=u.dequeue();)Hh(t,n,r,e);for(;e=i.dequeue();)Hh(t,n,r,e);if(t.nodeCount())for(var a=n.length-2;a>0;--a)if(e=n[a].dequeue()){o=o.concat(Hh(t,n,r,e,!0));break}}return o}(r.graph,r.buckets,r.zeroIdx);return Dh.flatten(Dh.map(e,(function(n){return t.outEdges(n.v,n.w)})),!0)},Vh=Dh.constant(1);function Hh(t,n,r,e,o){var i=o?[]:void 0;return Dh.forEach(t.inEdges(e.v),(function(e){var u=t.edge(e),a=t.node(e.v);o&&i.push({v:e.v,w:e.w}),a.out-=u,qh(n,r,a)})),Dh.forEach(t.outEdges(e.v),(function(e){var o=t.edge(e),i=e.w,u=t.node(i);u.in-=o,qh(n,r,u)})),t.removeNode(e.v),i}function qh(t,n,r){r.out?r.in?t[r.out-r.in+n].enqueue(r):t[t.length-1].enqueue(r):t[0].enqueue(r)}var Yh=Th,Wh=Uh,Zh={run:function(t){var n="greedy"===t.graph().acyclicer?Wh(t,function(t){return function(n){return t.edge(n).weight}}(t)):function(t){var n=[],r={},e={};function o(i){Yh.has(e,i)||(e[i]=!0,r[i]=!0,Yh.forEach(t.outEdges(i),(function(t){Yh.has(r,t.w)?n.push(t):o(t.w)})),delete r[i])}return Yh.forEach(t.nodes(),o),n}(t);Yh.forEach(n,(function(n){var r=t.edge(n);t.removeEdge(n),r.forwardName=n.name,r.reversed=!0,t.setEdge(n.w,n.v,r,Yh.uniqueId("rev"))}))},undo:function(t){Yh.forEach(t.edges(),(function(n){var r=t.edge(n);if(r.reversed){t.removeEdge(n);var e=r.forwardName;delete r.reversed,delete r.forwardName,t.setEdge(n.w,n.v,r,e)}}))}};var Kh=Th,Xh=wh.Graph,Jh={addDummyNode:Qh,simplify:function(t){var n=(new Xh).setGraph(t.graph());return Kh.forEach(t.nodes(),(function(r){n.setNode(r,t.node(r))})),Kh.forEach(t.edges(),(function(r){var e=n.edge(r.v,r.w)||{weight:0,minlen:1},o=t.edge(r);n.setEdge(r.v,r.w,{weight:e.weight+o.weight,minlen:Math.max(e.minlen,o.minlen)})})),n},asNonCompoundGraph:function(t){var n=new Xh({multigraph:t.isMultigraph()}).setGraph(t.graph());return Kh.forEach(t.nodes(),(function(r){t.children(r).length||n.setNode(r,t.node(r))})),Kh.forEach(t.edges(),(function(r){n.setEdge(r,t.edge(r))})),n},successorWeights:function(t){var n=Kh.map(t.nodes(),(function(n){var r={};return Kh.forEach(t.outEdges(n),(function(n){r[n.w]=(r[n.w]||0)+t.edge(n).weight})),r}));return Kh.zipObject(t.nodes(),n)},predecessorWeights:function(t){var n=Kh.map(t.nodes(),(function(n){var r={};return Kh.forEach(t.inEdges(n),(function(n){r[n.v]=(r[n.v]||0)+t.edge(n).weight})),r}));return Kh.zipObject(t.nodes(),n)},intersectRect:function(t,n){var r,e,o=t.x,i=t.y,u=n.x-o,a=n.y-i,c=t.width/2,f=t.height/2;if(!u&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*c>Math.abs(u)*f?(a<0&&(f=-f),r=f*u/a,e=f):(u<0&&(c=-c),r=c,e=c*a/u);return{x:o+r,y:i+e}},buildLayerMatrix:function(t){var n=Kh.map(Kh.range(td(t)+1),(function(){return[]}));return Kh.forEach(t.nodes(),(function(r){var e=t.node(r),o=e.rank;Kh.isUndefined(o)||(n[o][e.order]=r)})),n},normalizeRanks:function(t){var n=Kh.min(Kh.map(t.nodes(),(function(n){return t.node(n).rank})));Kh.forEach(t.nodes(),(function(r){var e=t.node(r);Kh.has(e,"rank")&&(e.rank-=n)}))},removeEmptyRanks:function(t){var n=Kh.min(Kh.map(t.nodes(),(function(n){return t.node(n).rank}))),r=[];Kh.forEach(t.nodes(),(function(e){var o=t.node(e).rank-n;r[o]||(r[o]=[]),r[o].push(e)}));var e=0,o=t.graph().nodeRankFactor;Kh.forEach(r,(function(n,r){Kh.isUndefined(n)&&r%o!=0?--e:e&&Kh.forEach(n,(function(n){t.node(n).rank+=e}))}))},addBorderNode:function(t,n,r,e){var o={width:0,height:0};arguments.length>=4&&(o.rank=r,o.order=e);return Qh(t,"border",o,n)},maxRank:td,partition:function(t,n){var r={lhs:[],rhs:[]};return Kh.forEach(t,(function(t){n(t)?r.lhs.push(t):r.rhs.push(t)})),r},time:function(t,n){var r=Kh.now();try{return n()}finally{console.log(t+" time: "+(Kh.now()-r)+"ms")}},notime:function(t,n){return n()}};function Qh(t,n,r,e){var o;do{o=Kh.uniqueId(e)}while(t.hasNode(o));return r.dummy=n,t.setNode(o,r),o}function td(t){return Kh.max(Kh.map(t.nodes(),(function(n){var r=t.node(n).rank;if(!Kh.isUndefined(r))return r})))}var nd=Th,rd=Jh,ed={run:function(t){t.graph().dummyChains=[],nd.forEach(t.edges(),(function(n){!function(t,n){var r,e,o,i=n.v,u=t.node(i).rank,a=n.w,c=t.node(a).rank,f=n.name,s=t.edge(n),h=s.labelRank;if(c===u+1)return;for(t.removeEdge(n),o=0,++u;u<c;++o,++u)s.points=[],e={width:0,height:0,edgeLabel:s,edgeObj:n,rank:u},r=rd.addDummyNode(t,"edge",e,"_d"),u===h&&(e.width=s.width,e.height=s.height,e.dummy="edge-label",e.labelpos=s.labelpos),t.setEdge(i,r,{weight:s.weight},f),0===o&&t.graph().dummyChains.push(r),i=r;t.setEdge(i,a,{weight:s.weight},f)}(t,n)}))},undo:function(t){nd.forEach(t.graph().dummyChains,(function(n){var r,e=t.node(n),o=e.edgeLabel;for(t.setEdge(e.edgeObj,o);e.dummy;)r=t.successors(n)[0],t.removeNode(n),o.points.push({x:e.x,y:e.y}),"edge-label"===e.dummy&&(o.x=e.x,o.y=e.y,o.width=e.width,o.height=e.height),n=r,e=t.node(n)}))}};var od=Th,id={longestPath:function(t){var n={};od.forEach(t.sources(),(function r(e){var o=t.node(e);if(od.has(n,e))return o.rank;n[e]=!0;var i=od.min(od.map(t.outEdges(e),(function(n){return r(n.w)-t.edge(n).minlen})));return i!==Number.POSITIVE_INFINITY&&null!=i||(i=0),o.rank=i}))},slack:function(t,n){return t.node(n.w).rank-t.node(n.v).rank-t.edge(n).minlen}};var ud=Th,ad=wh.Graph,cd=id.slack,fd=function(t){var n,r,e=new ad({directed:!1}),o=t.nodes()[0],i=t.nodeCount();e.setNode(o,{});for(;sd(e,t)<i;)n=hd(e,t),r=e.hasNode(n.v)?cd(t,n):-cd(t,n),dd(e,t,r);return e};function sd(t,n){return ud.forEach(t.nodes(),(function r(e){ud.forEach(n.nodeEdges(e),(function(o){var i=o.v,u=e===i?o.w:i;t.hasNode(u)||cd(n,o)||(t.setNode(u,{}),t.setEdge(e,u,{}),r(u))}))})),t.nodeCount()}function hd(t,n){return ud.minBy(n.edges(),(function(r){if(t.hasNode(r.v)!==t.hasNode(r.w))return cd(n,r)}))}function dd(t,n,r){ud.forEach(t.nodes(),(function(t){n.node(t).rank+=r}))}var ld=Th,vd=fd,pd=id.slack,gd=id.longestPath,yd=wh.alg.preorder,md=wh.alg.postorder,bd=Jh.simplify,wd=_d;function _d(t){t=bd(t),gd(t);var n,r=vd(t);for(jd(r),Ed(r,t);n=Id(r);)Od(r,t,n,Nd(r,t,n))}function Ed(t,n){var r=md(t,t.nodes());r=r.slice(0,r.length-1),ld.forEach(r,(function(r){!function(t,n,r){var e=t.node(r),o=e.parent;t.edge(r,o).cutvalue=xd(t,n,r)}(t,n,r)}))}function xd(t,n,r){var e=t.node(r).parent,o=!0,i=n.edge(r,e),u=0;return i||(o=!1,i=n.edge(e,r)),u=i.weight,ld.forEach(n.nodeEdges(r),(function(i){var a,c,f=i.v===r,s=f?i.w:i.v;if(s!==e){var h=f===o,d=n.edge(i).weight;if(u+=h?d:-d,a=r,c=s,t.hasEdge(a,c)){var l=t.edge(r,s).cutvalue;u+=h?-l:l}}})),u}function jd(t,n){arguments.length<2&&(n=t.nodes()[0]),kd(t,{},1,n)}function kd(t,n,r,e,o){var i=r,u=t.node(e);return n[e]=!0,ld.forEach(t.neighbors(e),(function(o){ld.has(n,o)||(r=kd(t,n,r,o,e))})),u.low=i,u.lim=r++,o?u.parent=o:delete u.parent,r}function Id(t){return ld.find(t.edges(),(function(n){return t.edge(n).cutvalue<0}))}function Nd(t,n,r){var e=r.v,o=r.w;n.hasEdge(e,o)||(e=r.w,o=r.v);var i=t.node(e),u=t.node(o),a=i,c=!1;i.lim>u.lim&&(a=u,c=!0);var f=ld.filter(n.edges(),(function(n){return c===Md(t,t.node(n.v),a)&&c!==Md(t,t.node(n.w),a)}));return ld.minBy(f,(function(t){return pd(n,t)}))}function Od(t,n,r,e){var o=r.v,i=r.w;t.removeEdge(o,i),t.setEdge(e.v,e.w,{}),jd(t),Ed(t,n),function(t,n){var r=ld.find(t.nodes(),(function(t){return!n.node(t).parent})),e=yd(t,r);e=e.slice(1),ld.forEach(e,(function(r){var e=t.node(r).parent,o=n.edge(r,e),i=!1;o||(o=n.edge(e,r),i=!0),n.node(r).rank=n.node(e).rank+(i?o.minlen:-o.minlen)}))}(t,n)}function Md(t,n,r){return r.low<=n.lim&&n.lim<=r.lim}_d.initLowLimValues=jd,_d.initCutValues=Ed,_d.calcCutValue=xd,_d.leaveEdge=Id,_d.enterEdge=Nd,_d.exchangeEdges=Od;var Sd=id.longestPath,Ad=fd,zd=wd,Cd=function(t){switch(t.graph().ranker){case"network-simplex":default:Td(t);break;case"tight-tree":!function(t){Sd(t),Ad(t)}(t);break;case"longest-path":Ld(t)}};var Ld=Sd;function Td(t){zd(t)}var Pd=Th,$d=function(t){var n=function(t){var n={},r=0;function e(o){var i=r;Pd.forEach(t.children(o),e),n[o]={low:i,lim:r++}}return Pd.forEach(t.children(),e),n}(t);Pd.forEach(t.graph().dummyChains,(function(r){for(var e=t.node(r),o=e.edgeObj,i=function(t,n,r,e){var o,i,u=[],a=[],c=Math.min(n[r].low,n[e].low),f=Math.max(n[r].lim,n[e].lim);o=r;do{o=t.parent(o),u.push(o)}while(o&&(n[o].low>c||f>n[o].lim));i=o,o=e;for(;(o=t.parent(o))!==i;)a.push(o);return{path:u.concat(a.reverse()),lca:i}}(t,n,o.v,o.w),u=i.path,a=i.lca,c=0,f=u[c],s=!0;r!==o.w;){if(e=t.node(r),s){for(;(f=u[c])!==a&&t.node(f).maxRank<e.rank;)c++;f===a&&(s=!1)}if(!s){for(;c<u.length-1&&t.node(f=u[c+1]).minRank<=e.rank;)c++;f=u[c]}t.setParent(r,f),r=t.successors(r)[0]}}))};var Fd=Th,Rd=Jh,Dd={run:function(t){var n=Rd.addDummyNode(t,"root",{},"_root"),r=function(t){var n={};function r(e,o){var i=t.children(e);i&&i.length&&Fd.forEach(i,(function(t){r(t,o+1)})),n[e]=o}return Fd.forEach(t.children(),(function(t){r(t,1)})),n}(t),e=Fd.max(Fd.values(r))-1,o=2*e+1;t.graph().nestingRoot=n,Fd.forEach(t.edges(),(function(n){t.edge(n).minlen*=o}));var i=function(t){return Fd.reduce(t.edges(),(function(n,r){return n+t.edge(r).weight}),0)}(t)+1;Fd.forEach(t.children(),(function(u){Bd(t,n,o,i,e,r,u)})),t.graph().nodeRankFactor=o},cleanup:function(t){var n=t.graph();t.removeNode(n.nestingRoot),delete n.nestingRoot,Fd.forEach(t.edges(),(function(n){t.edge(n).nestingEdge&&t.removeEdge(n)}))}};function Bd(t,n,r,e,o,i,u){var a=t.children(u);if(a.length){var c=Rd.addBorderNode(t,"_bt"),f=Rd.addBorderNode(t,"_bb"),s=t.node(u);t.setParent(c,u),s.borderTop=c,t.setParent(f,u),s.borderBottom=f,Fd.forEach(a,(function(a){Bd(t,n,r,e,o,i,a);var s=t.node(a),h=s.borderTop?s.borderTop:a,d=s.borderBottom?s.borderBottom:a,l=s.borderTop?e:2*e,v=h!==d?1:o-i[u]+1;t.setEdge(c,h,{weight:l,minlen:v,nestingEdge:!0}),t.setEdge(d,f,{weight:l,minlen:v,nestingEdge:!0})})),t.parent(u)||t.setEdge(n,c,{weight:0,minlen:o+i[u]})}else u!==n&&t.setEdge(n,u,{weight:0,minlen:r})}var Gd=Th,Ud=Jh,Vd=function(t){Gd.forEach(t.children(),(function n(r){var e=t.children(r),o=t.node(r);if(e.length&&Gd.forEach(e,n),Gd.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var i=o.minRank,u=o.maxRank+1;i<u;++i)Hd(t,"borderLeft","_bl",r,o,i),Hd(t,"borderRight","_br",r,o,i)}}))};function Hd(t,n,r,e,o,i){var u={width:0,height:0,rank:i,borderType:n},a=o[n][i-1],c=Ud.addDummyNode(t,"border",u,r);o[n][i]=c,t.setParent(c,e),a&&t.setEdge(a,c,{weight:1})}var qd=Th,Yd={adjust:function(t){var n=t.graph().rankdir.toLowerCase();"lr"!==n&&"rl"!==n||Wd(t)},undo:function(t){var n=t.graph().rankdir.toLowerCase();"bt"!==n&&"rl"!==n||function(t){qd.forEach(t.nodes(),(function(n){Kd(t.node(n))})),qd.forEach(t.edges(),(function(n){var r=t.edge(n);qd.forEach(r.points,Kd),qd.has(r,"y")&&Kd(r)}))}(t);"lr"!==n&&"rl"!==n||(!function(t){qd.forEach(t.nodes(),(function(n){Xd(t.node(n))})),qd.forEach(t.edges(),(function(n){var r=t.edge(n);qd.forEach(r.points,Xd),qd.has(r,"x")&&Xd(r)}))}(t),Wd(t))}};function Wd(t){qd.forEach(t.nodes(),(function(n){Zd(t.node(n))})),qd.forEach(t.edges(),(function(n){Zd(t.edge(n))}))}function Zd(t){var n=t.width;t.width=t.height,t.height=n}function Kd(t){t.y=-t.y}function Xd(t){var n=t.x;t.x=t.y,t.y=n}var Jd=Th,Qd=function(t){var n={},r=Jd.filter(t.nodes(),(function(n){return!t.children(n).length})),e=Jd.max(Jd.map(r,(function(n){return t.node(n).rank}))),o=Jd.map(Jd.range(e+1),(function(){return[]}));function i(r){if(!Jd.has(n,r)){n[r]=!0;var e=t.node(r);o[e.rank].push(r),Jd.forEach(t.successors(r),i)}}var u=Jd.sortBy(r,(function(n){return t.node(n).rank}));return Jd.forEach(u,i),o};var tl=Th,nl=function(t,n){for(var r=0,e=1;e<n.length;++e)r+=rl(t,n[e-1],n[e]);return r};function rl(t,n,r){for(var e=tl.zipObject(r,tl.map(r,(function(t,n){return n}))),o=tl.flatten(tl.map(n,(function(n){return tl.sortBy(tl.map(t.outEdges(n),(function(n){return{pos:e[n.w],weight:t.edge(n).weight}})),"pos")})),!0),i=1;i<r.length;)i<<=1;var u=2*i-1;i-=1;var a=tl.map(new Array(u),(function(){return 0})),c=0;return tl.forEach(o.forEach((function(t){var n=t.pos+i;a[n]+=t.weight;for(var r=0;n>0;)n%2&&(r+=a[n+1]),a[n=n-1>>1]+=t.weight;c+=t.weight*r}))),c}var el=Th;var ol=Th;var il=Th,ul=Jh;function al(t,n,r){for(var e;n.length&&(e=il.last(n)).i<=r;)n.pop(),t.push(e.vs),r++;return r}var cl=Th,fl=function(t,n){return el.map(n,(function(n){var r=t.inEdges(n);if(r.length){var e=el.reduce(r,(function(n,r){var e=t.edge(r),o=t.node(r.v);return{sum:n.sum+e.weight*o.order,weight:n.weight+e.weight}}),{sum:0,weight:0});return{v:n,barycenter:e.sum/e.weight,weight:e.weight}}return{v:n}}))},sl=function(t,n){var r={};return ol.forEach(t,(function(t,n){var e=r[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:n};ol.isUndefined(t.barycenter)||(e.barycenter=t.barycenter,e.weight=t.weight)})),ol.forEach(n.edges(),(function(t){var n=r[t.v],e=r[t.w];ol.isUndefined(n)||ol.isUndefined(e)||(e.indegree++,n.out.push(r[t.w]))})),function(t){var n=[];function r(t){return function(n){n.merged||(ol.isUndefined(n.barycenter)||ol.isUndefined(t.barycenter)||n.barycenter>=t.barycenter)&&function(t,n){var r=0,e=0;t.weight&&(r+=t.barycenter*t.weight,e+=t.weight);n.weight&&(r+=n.barycenter*n.weight,e+=n.weight);t.vs=n.vs.concat(t.vs),t.barycenter=r/e,t.weight=e,t.i=Math.min(n.i,t.i),n.merged=!0}(t,n)}}function e(n){return function(r){r.in.push(n),0==--r.indegree&&t.push(r)}}for(;t.length;){var o=t.pop();n.push(o),ol.forEach(o.in.reverse(),r(o)),ol.forEach(o.out,e(o))}return ol.map(ol.filter(n,(function(t){return!t.merged})),(function(t){return ol.pick(t,["vs","i","barycenter","weight"])}))}(ol.filter(r,(function(t){return!t.indegree})))},hl=function(t,n){var r=ul.partition(t,(function(t){return il.has(t,"barycenter")})),e=r.lhs,o=il.sortBy(r.rhs,(function(t){return-t.i})),i=[],u=0,a=0,c=0;e.sort((f=!!n,function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:f?n.i-t.i:t.i-n.i})),c=al(i,o,c),il.forEach(e,(function(t){c+=t.vs.length,i.push(t.vs),u+=t.barycenter*t.weight,a+=t.weight,c=al(i,o,c)}));var f;var s={vs:il.flatten(i,!0)};a&&(s.barycenter=u/a,s.weight=a);return s},dl=function t(n,r,e,o){var i=n.children(r),u=n.node(r),a=u?u.borderLeft:void 0,c=u?u.borderRight:void 0,f={};a&&(i=cl.filter(i,(function(t){return t!==a&&t!==c})));var s=fl(n,i);cl.forEach(s,(function(r){if(n.children(r.v).length){var i=t(n,r.v,e,o);f[r.v]=i,cl.has(i,"barycenter")&&(u=r,a=i,cl.isUndefined(u.barycenter)?(u.barycenter=a.barycenter,u.weight=a.weight):(u.barycenter=(u.barycenter*u.weight+a.barycenter*a.weight)/(u.weight+a.weight),u.weight+=a.weight))}var u,a}));var h=sl(s,e);!function(t,n){cl.forEach(t,(function(t){t.vs=cl.flatten(t.vs.map((function(t){return n[t]?n[t].vs:t})),!0)}))}(h,f);var d=hl(h,o);if(a&&(d.vs=cl.flatten([a,d.vs,c],!0),n.predecessors(a).length)){var l=n.node(n.predecessors(a)[0]),v=n.node(n.predecessors(c)[0]);cl.has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+l.order+v.order)/(d.weight+2),d.weight+=2}return d};var ll=Th,vl=wh.Graph,pl=function(t,n,r){var e=function(t){var n;for(;t.hasNode(n=ll.uniqueId("_root")););return n}(t),o=new vl({compound:!0}).setGraph({root:e}).setDefaultNodeLabel((function(n){return t.node(n)}));return ll.forEach(t.nodes(),(function(i){var u=t.node(i),a=t.parent(i);(u.rank===n||u.minRank<=n&&n<=u.maxRank)&&(o.setNode(i),o.setParent(i,a||e),ll.forEach(t[r](i),(function(n){var r=n.v===i?n.w:n.v,e=o.edge(r,i),u=ll.isUndefined(e)?0:e.weight;o.setEdge(r,i,{weight:t.edge(n).weight+u})})),ll.has(u,"minRank")&&o.setNode(i,{borderLeft:u.borderLeft[n],borderRight:u.borderRight[n]}))})),o};var gl=Th;var yl=Th,ml=Qd,bl=nl,wl=dl,_l=pl,El=function(t,n,r){var e,o={};gl.forEach(r,(function(r){for(var i,u,a=t.parent(r);a;){if((i=t.parent(a))?(u=o[i],o[i]=a):(u=e,e=a),u&&u!==a)return void n.setEdge(u,a);a=i}}))},xl=wh.Graph,jl=Jh,kl=function(t){var n=jl.maxRank(t),r=Il(t,yl.range(1,n+1),"inEdges"),e=Il(t,yl.range(n-1,-1,-1),"outEdges"),o=ml(t);Ol(t,o);for(var i,u=Number.POSITIVE_INFINITY,a=0,c=0;c<4;++a,++c){Nl(a%2?r:e,a%4>=2),o=jl.buildLayerMatrix(t);var f=bl(t,o);f<u&&(c=0,i=yl.cloneDeep(o),u=f)}Ol(t,i)};function Il(t,n,r){return yl.map(n,(function(n){return _l(t,n,r)}))}function Nl(t,n){var r=new xl;yl.forEach(t,(function(t){var e=t.graph().root,o=wl(t,e,r,n);yl.forEach(o.vs,(function(n,r){t.node(n).order=r})),El(t,r,o.vs)}))}function Ol(t,n){yl.forEach(n,(function(n){yl.forEach(n,(function(n,r){t.node(n).order=r}))}))}var Ml=Th,Sl=wh.Graph,Al=Jh,zl=function(t){var n,r=Al.buildLayerMatrix(t),e=Ml.merge(Cl(t,r),Ll(t,r)),o={};Ml.forEach(["u","d"],(function(i){n="u"===i?r:Ml.values(r).reverse(),Ml.forEach(["l","r"],(function(r){"r"===r&&(n=Ml.map(n,(function(t){return Ml.values(t).reverse()})));var u=("u"===i?t.predecessors:t.successors).bind(t),a=$l(t,n,e,u),c=Fl(t,n,a.root,a.align,"r"===r);"r"===r&&(c=Ml.mapValues(c,(function(t){return-t}))),o[i+r]=c}))}));var i=Rl(t,o);return Dl(o,i),Bl(o,t.graph().align)};function Cl(t,n){var r={};return Ml.reduce(n,(function(n,e){var o=0,i=0,u=n.length,a=Ml.last(e);return Ml.forEach(e,(function(n,c){var f=function(t,n){if(t.node(n).dummy)return Ml.find(t.predecessors(n),(function(n){return t.node(n).dummy}))}(t,n),s=f?t.node(f).order:u;(f||n===a)&&(Ml.forEach(e.slice(i,c+1),(function(n){Ml.forEach(t.predecessors(n),(function(e){var i=t.node(e),u=i.order;!(u<o||s<u)||i.dummy&&t.node(n).dummy||Tl(r,e,n)}))})),i=c+1,o=s)})),e})),r}function Ll(t,n){var r={};function e(n,e,o,i,u){var a;Ml.forEach(Ml.range(e,o),(function(e){a=n[e],t.node(a).dummy&&Ml.forEach(t.predecessors(a),(function(n){var e=t.node(n);e.dummy&&(e.order<i||e.order>u)&&Tl(r,n,a)}))}))}return Ml.reduce(n,(function(n,r){var o,i=-1,u=0;return Ml.forEach(r,(function(a,c){if("border"===t.node(a).dummy){var f=t.predecessors(a);f.length&&(o=t.node(f[0]).order,e(r,u,c,i,o),u=c,i=o)}e(r,u,r.length,o,n.length)})),r})),r}function Tl(t,n,r){if(n>r){var e=n;n=r,r=e}var o=t[n];o||(t[n]=o={}),o[r]=!0}function Pl(t,n,r){if(n>r){var e=n;n=r,r=e}return Ml.has(t[n],r)}function $l(t,n,r,e){var o={},i={},u={};return Ml.forEach(n,(function(t){Ml.forEach(t,(function(t,n){o[t]=t,i[t]=t,u[t]=n}))})),Ml.forEach(n,(function(t){var n=-1;Ml.forEach(t,(function(t){var a=e(t);if(a.length){a=Ml.sortBy(a,(function(t){return u[t]}));for(var c=(a.length-1)/2,f=Math.floor(c),s=Math.ceil(c);f<=s;++f){var h=a[f];i[t]===t&&n<u[h]&&!Pl(r,t,h)&&(i[h]=t,i[t]=o[t]=o[h],n=u[h])}}}))})),{root:o,align:i}}function Fl(t,n,r,e,o){var i={},u=function(t,n,r,e){var o=new Sl,i=t.graph(),u=function(t,n,r){return function(e,o,i){var u,a=e.node(o),c=e.node(i),f=0;if(f+=a.width/2,Ml.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":u=-a.width/2;break;case"r":u=a.width/2}if(u&&(f+=r?u:-u),u=0,f+=(a.dummy?n:t)/2,f+=(c.dummy?n:t)/2,f+=c.width/2,Ml.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":u=c.width/2;break;case"r":u=-c.width/2}return u&&(f+=r?u:-u),u=0,f}}(i.nodesep,i.edgesep,e);return Ml.forEach(n,(function(n){var e;Ml.forEach(n,(function(n){var i=r[n];if(o.setNode(i),e){var a=r[e],c=o.edge(a,i);o.setEdge(a,i,Math.max(u(t,n,e),c||0))}e=n}))})),o}(t,n,r,o),a=o?"borderLeft":"borderRight";function c(t,n){for(var r=u.nodes(),e=r.pop(),o={};e;)o[e]?t(e):(o[e]=!0,r.push(e),r=r.concat(n(e))),e=r.pop()}return c((function(t){i[t]=u.inEdges(t).reduce((function(t,n){return Math.max(t,i[n.v]+u.edge(n))}),0)}),u.predecessors.bind(u)),c((function(n){var r=u.outEdges(n).reduce((function(t,n){return Math.min(t,i[n.w]-u.edge(n))}),Number.POSITIVE_INFINITY),e=t.node(n);r!==Number.POSITIVE_INFINITY&&e.borderType!==a&&(i[n]=Math.max(i[n],r))}),u.successors.bind(u)),Ml.forEach(e,(function(t){i[t]=i[r[t]]})),i}function Rl(t,n){return Ml.minBy(Ml.values(n),(function(n){var r=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY;return Ml.forIn(n,(function(n,o){var i=function(t,n){return t.node(n).width}(t,o)/2;r=Math.max(n+i,r),e=Math.min(n-i,e)})),r-e}))}function Dl(t,n){var r=Ml.values(n),e=Ml.min(r),o=Ml.max(r);Ml.forEach(["u","d"],(function(r){Ml.forEach(["l","r"],(function(i){var u,a=r+i,c=t[a];if(c!==n){var f=Ml.values(c);(u="l"===i?e-Ml.min(f):o-Ml.max(f))&&(t[a]=Ml.mapValues(c,(function(t){return t+u})))}}))}))}function Bl(t,n){return Ml.mapValues(t.ul,(function(r,e){if(n)return t[n.toLowerCase()][e];var o=Ml.sortBy(Ml.map(t,e));return(o[1]+o[2])/2}))}var Gl=Th,Ul=Jh,Vl=zl;var Hl=Th,ql=Zh,Yl=ed,Wl=Cd,Zl=Jh.normalizeRanks,Kl=$d,Xl=Jh.removeEmptyRanks,Jl=Dd,Ql=Vd,tv=Yd,nv=kl,rv=function(t){(function(t){var n=Ul.buildLayerMatrix(t),r=t.graph().ranksep,e=0;Gl.forEach(n,(function(n){var o=Gl.max(Gl.map(n,(function(n){return t.node(n).height})));Gl.forEach(n,(function(n){t.node(n).y=e+o/2})),e+=o+r}))})(t=Ul.asNonCompoundGraph(t)),Gl.forEach(Vl(t),(function(n,r){t.node(r).x=n}))},ev=Jh,ov=wh.Graph,iv=function(t,n){var r=n&&n.debugTiming?ev.time:ev.notime;r("layout",(function(){var n=r("  buildLayoutGraph",(function(){return function(t){var n=new ov({multigraph:!0,compound:!0}),r=pv(t.graph());return n.setGraph(Hl.merge({},av,vv(r,uv),Hl.pick(r,cv))),Hl.forEach(t.nodes(),(function(r){var e=pv(t.node(r));n.setNode(r,Hl.defaults(vv(e,fv),sv)),n.setParent(r,t.parent(r))})),Hl.forEach(t.edges(),(function(r){var e=pv(t.edge(r));n.setEdge(r,Hl.merge({},dv,vv(e,hv),Hl.pick(e,lv)))})),n}(t)}));r("  runLayout",(function(){!function(t,n){n("    makeSpaceForEdgeLabels",(function(){!function(t){var n=t.graph();n.ranksep/=2,Hl.forEach(t.edges(),(function(r){var e=t.edge(r);e.minlen*=2,"c"!==e.labelpos.toLowerCase()&&("TB"===n.rankdir||"BT"===n.rankdir?e.width+=e.labeloffset:e.height+=e.labeloffset)}))}(t)})),n("    removeSelfEdges",(function(){!function(t){Hl.forEach(t.edges(),(function(n){if(n.v===n.w){var r=t.node(n.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:n,label:t.edge(n)}),t.removeEdge(n)}}))}(t)})),n("    acyclic",(function(){ql.run(t)})),n("    nestingGraph.run",(function(){Jl.run(t)})),n("    rank",(function(){Wl(ev.asNonCompoundGraph(t))})),n("    injectEdgeLabelProxies",(function(){!function(t){Hl.forEach(t.edges(),(function(n){var r=t.edge(n);if(r.width&&r.height){var e=t.node(n.v),o={rank:(t.node(n.w).rank-e.rank)/2+e.rank,e:n};ev.addDummyNode(t,"edge-proxy",o,"_ep")}}))}(t)})),n("    removeEmptyRanks",(function(){Xl(t)})),n("    nestingGraph.cleanup",(function(){Jl.cleanup(t)})),n("    normalizeRanks",(function(){Zl(t)})),n("    assignRankMinMax",(function(){!function(t){var n=0;Hl.forEach(t.nodes(),(function(r){var e=t.node(r);e.borderTop&&(e.minRank=t.node(e.borderTop).rank,e.maxRank=t.node(e.borderBottom).rank,n=Hl.max(n,e.maxRank))})),t.graph().maxRank=n}(t)})),n("    removeEdgeLabelProxies",(function(){!function(t){Hl.forEach(t.nodes(),(function(n){var r=t.node(n);"edge-proxy"===r.dummy&&(t.edge(r.e).labelRank=r.rank,t.removeNode(n))}))}(t)})),n("    normalize.run",(function(){Yl.run(t)})),n("    parentDummyChains",(function(){Kl(t)})),n("    addBorderSegments",(function(){Ql(t)})),n("    order",(function(){nv(t)})),n("    insertSelfEdges",(function(){!function(t){var n=ev.buildLayerMatrix(t);Hl.forEach(n,(function(n){var r=0;Hl.forEach(n,(function(n,e){var o=t.node(n);o.order=e+r,Hl.forEach(o.selfEdges,(function(n){ev.addDummyNode(t,"selfedge",{width:n.label.width,height:n.label.height,rank:o.rank,order:e+ ++r,e:n.e,label:n.label},"_se")})),delete o.selfEdges}))}))}(t)})),n("    adjustCoordinateSystem",(function(){tv.adjust(t)})),n("    position",(function(){rv(t)})),n("    positionSelfEdges",(function(){!function(t){Hl.forEach(t.nodes(),(function(n){var r=t.node(n);if("selfedge"===r.dummy){var e=t.node(r.e.v),o=e.x+e.width/2,i=e.y,u=r.x-o,a=e.height/2;t.setEdge(r.e,r.label),t.removeNode(n),r.label.points=[{x:o+2*u/3,y:i-a},{x:o+5*u/6,y:i-a},{x:o+u,y:i},{x:o+5*u/6,y:i+a},{x:o+2*u/3,y:i+a}],r.label.x=r.x,r.label.y=r.y}}))}(t)})),n("    removeBorderNodes",(function(){!function(t){Hl.forEach(t.nodes(),(function(n){if(t.children(n).length){var r=t.node(n),e=t.node(r.borderTop),o=t.node(r.borderBottom),i=t.node(Hl.last(r.borderLeft)),u=t.node(Hl.last(r.borderRight));r.width=Math.abs(u.x-i.x),r.height=Math.abs(o.y-e.y),r.x=i.x+r.width/2,r.y=e.y+r.height/2}})),Hl.forEach(t.nodes(),(function(n){"border"===t.node(n).dummy&&t.removeNode(n)}))}(t)})),n("    normalize.undo",(function(){Yl.undo(t)})),n("    fixupEdgeLabelCoords",(function(){!function(t){Hl.forEach(t.edges(),(function(n){var r=t.edge(n);if(Hl.has(r,"x"))switch("l"!==r.labelpos&&"r"!==r.labelpos||(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset}}))}(t)})),n("    undoCoordinateSystem",(function(){tv.undo(t)})),n("    translateGraph",(function(){!function(t){var n=Number.POSITIVE_INFINITY,r=0,e=Number.POSITIVE_INFINITY,o=0,i=t.graph(),u=i.marginx||0,a=i.marginy||0;function c(t){var i=t.x,u=t.y,a=t.width,c=t.height;n=Math.min(n,i-a/2),r=Math.max(r,i+a/2),e=Math.min(e,u-c/2),o=Math.max(o,u+c/2)}Hl.forEach(t.nodes(),(function(n){c(t.node(n))})),Hl.forEach(t.edges(),(function(n){var r=t.edge(n);Hl.has(r,"x")&&c(r)})),n-=u,e-=a,Hl.forEach(t.nodes(),(function(r){var o=t.node(r);o.x-=n,o.y-=e})),Hl.forEach(t.edges(),(function(r){var o=t.edge(r);Hl.forEach(o.points,(function(t){t.x-=n,t.y-=e})),Hl.has(o,"x")&&(o.x-=n),Hl.has(o,"y")&&(o.y-=e)})),i.width=r-n+u,i.height=o-e+a}(t)})),n("    assignNodeIntersects",(function(){!function(t){Hl.forEach(t.edges(),(function(n){var r,e,o=t.edge(n),i=t.node(n.v),u=t.node(n.w);o.points?(r=o.points[0],e=o.points[o.points.length-1]):(o.points=[],r=u,e=i),o.points.unshift(ev.intersectRect(i,r)),o.points.push(ev.intersectRect(u,e))}))}(t)})),n("    reversePoints",(function(){!function(t){Hl.forEach(t.edges(),(function(n){var r=t.edge(n);r.reversed&&r.points.reverse()}))}(t)})),n("    acyclic.undo",(function(){ql.undo(t)}))}(n,r)})),r("  updateInputGraph",(function(){!function(t,n){Hl.forEach(t.nodes(),(function(r){var e=t.node(r),o=n.node(r);e&&(e.x=o.x,e.y=o.y,n.children(r).length&&(e.width=o.width,e.height=o.height))})),Hl.forEach(t.edges(),(function(r){var e=t.edge(r),o=n.edge(r);e.points=o.points,Hl.has(o,"x")&&(e.x=o.x,e.y=o.y)})),t.graph().width=n.graph().width,t.graph().height=n.graph().height}(t,n)}))}))};var uv=["nodesep","edgesep","ranksep","marginx","marginy"],av={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},cv=["acyclicer","ranker","rankdir","align"],fv=["width","height"],sv={width:0,height:0},hv=["minlen","weight","width","height","labeloffset"],dv={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},lv=["labelpos"];function vv(t,n){return Hl.mapValues(Hl.pick(t,n),Number)}function pv(t){var n={};return Hl.forEach(t,(function(t,r){n[r.toLowerCase()]=t})),n}var gv=Th,yv=Jh,mv=wh.Graph;var bv={graphlib:wh,layout:iv,debug:{debugOrdering:function(t){var n=yv.buildLayerMatrix(t),r=new mv({compound:!0,multigraph:!0}).setGraph({});return gv.forEach(t.nodes(),(function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+t.node(n).rank)})),gv.forEach(t.edges(),(function(t){r.setEdge(t.v,t.w,{},t.name)})),gv.forEach(n,(function(t,n){var e="layer"+n;r.setNode(e,{rank:"same"}),gv.reduce(t,(function(t,n){return r.setEdge(t,n,{style:"invis"}),n}))})),r}},util:{time:Jh.time,notime:Jh.notime},version:"0.8.5"};const wv=(t,n)=>({x:t.x-n.x,y:t.y-n.y}),_v=(t,n)=>({x:t.x+n.x,y:t.y+n.y}),Ev=(t,n)=>({x:n*t.x,y:n*t.y}),xv=t=>Ev(t,1/(t=>Math.sqrt(t.x*t.x+t.y*t.y))(t)),jv=t=>t.trim().split(/(?=[A-Z])/);class kv{constructor(){this.listeners=new Map}on(t,n){!this.listeners.has(t)&&this.listeners.set(t,new Set),this.listeners.get(t).add(n)}emit(t,...n){this.listeners.has(t)&&this.listeners.get(t).forEach((t=>t(...n)))}}const Iv=(t,n)=>{t.x=0,t.y=0,t.width=n.scale,t.height=n.scale},Nv=(t,n)=>{t.x=0,t.y=0,t.width=2*n.scale,t.height=n.scale},Ov=t=>{t.x=0,t.y=0,t.width=0,t.height=0},Mv=(t,n)=>{const r=(t,n)=>{if(t.nodes.size){const e=new bv.graphlib.Graph({multigraph:!0});e.setGraph({nodesep:n.margin,edgesep:n.margin,ranksep:n.margin,acyclicer:"greedy",rankdir:"LR",ranker:"network-simplex"}),t.nodes.forEach((t=>function(t){switch(t){case"context":return r;case"actor":return Ov;case"command":case"event":return Iv;default:return Nv}}(t.visual)(t,n))),t.nodes.forEach((({id:t,width:n,height:r})=>e.setNode(t,{width:n,height:r})));const o=[...t.edges.values()].map(((t,n)=>(e.setEdge(t.sourceId,t.targetId,{},`${n}`),t)));bv.layout(e),t.nodes.forEach((t=>{const n=e.node(t.id);t.x=n.x,t.y=n.y}));const i=[0,0,0,0];for(const n of e.edges()){const r=e.edge(n),u=o[parseInt(n.name)],a=t.nodes.get(n.v),c=t.nodes.get(n.w);u.path=[a,...r.points,c].map((t=>({x:t.x,y:t.y}))),r.points.forEach((({x:t,y:n})=>{i[0]=i[0]<t?i[0]:t,i[1]=i[1]>t?i[1]:t,i[2]=i[2]<n?i[2]:n,i[3]=i[3]<n?i[3]:n}))}const{width:u=0,height:a=0}=e.graph();t.width=Math.max(u,i[1]-i[0])+2*n.padding,t.height=Math.max(a,i[3]-i[2])+2*n.padding}else t.width=2*n.padding+jv(t.id).join(" ").length*n.fontSize,t.height=3*n.padding+n.fontSize};return r(t,n)};function Sv(t){return"number"==typeof t?t.toFixed(0):(t??"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}class Av{constructor(t,n,r,e){this.type=t,this.attrs=n,this.parent=r,this.text=e,this.children=[]}get group(){return this.parent}attr(t,n){return this.attrs[t]=n,this}append(t){return t.parent=this,this.children.push(t),t}serialize(){const t=function(t){return Object.entries(t).filter((([t,n])=>n)).map((([t,n])=>`${t}="${Sv(n)}"`)).join(" ")}({...this.attrs}),n=this.children.map((t=>t.serialize())).join("")||Sv(this.text);return`<${this.type} ${t}>${n}</${this.type}>`}}class zv{_new(t,n,r){this.current.append(new Av(t,n,this.current,r))}constructor(t){this.root=this.current=new Av("g",{...t,"data-name":"root"})}group(t,n){const r=new Av("g",{},this.current);return this.current.append(r),this.current=r,t&&this.attr("data-name",t),n&&(n.class&&this.attr("class",n.class),(n.dx||n.dy)&&this.attr("transform",`translate(${n.dx}, ${n.dy})`)),this}ungroup(){this.current.group&&(this.current=this.current.group)}attr(t,n){return this.current.attr(t,n),this}rect(t,n,r,e,o){this._new("rect",{x:t,y:n,height:e,width:r,...o})}path(t,n,r){const e=t.map(((t,n)=>(n?"L":"M")+t.x.toFixed(0)+" "+t.y.toFixed(0))).join(" ").concat(n?" Z":"");this._new("path",{...r,d:e})}text(t,n,r,e){this._new("text",{x:n,y:r,...e},t)}serialize(){return this.root.serialize()}}const Cv="#AAAAAA",Lv="#555555",Tv=(t,n,r)=>{let e=((t,n)=>{const r=t.map((t=>t.length)).sort(((t,n)=>n-t)).at(0);return Math.floor(Math.min(Math.max(Math.ceil(n/r),8),24))})(t,n);for(;e>5;){const o=Math.ceil(n/e)-1,i=Math.floor(r/e)-1,u=[];let a=t[0],c=1;for(;c<t.length;){const n=t[c++];a.length+n.length>=o?(u.push(a),a=n):a=a.concat(a.length?" ":"",n)}if(u.push(a),c===t.length&&u.length<=i)return{lines:u,fontSize:e};e--}return{lines:[t.join(" ")],fontSize:e}},Pv=(t,n,r,e,o={fit:!0})=>{const i=o.w||n||0,u=o.h||r||0,{lines:a,fontSize:c}=o.fit?Tv(t,i,u):{lines:t,fontSize:o.fontSize||12};e.attr("font-size",c+"pt");const f=o.x||Math.floor(i/2),s=o.y||Math.floor(u/2),h=Math.floor(a.length/2),d=a.length%2?.3:.9;a.forEach(((t,n)=>{e.text(t,f,s,{fill:Lv,dy:`${(1.2*(n-h)+d).toFixed(2)}em`})}))},$v=(t,n,r)=>{const e={fill:"none",stroke:t.color},o=t.dashed&&{"stroke-dasharray":"4 4"};if(n.path(((t,n)=>{const r=t.path.slice(1,-1),e=xv(wv(r[r.length-2],r.at(-1))),o=.5*n.margin/30,i=r.length-1,u=r.map((t=>({x:t.x,y:t.y})));return u[i]=_v(u[i],Ev(e,o*(t.arrow?5:0))),u})(t,r),!1,{...e,...o}),t.arrow){const o=t.path[t.path.length-2],i=t.path.slice(1,-1),u=.5*r.margin/30,a=xv(wv(i[i.length-2],i.at(-1))),c=t=>_v(o,Ev(a,t*u)),f=t=>{return Ev({x:(n=a).y,y:-n.x},t*u);var n};n.path([_v(c(10),f(4)),c(5),_v(c(10),f(-4)),o],!0,{...e,fill:t.color})}},Fv=(t,n,r,o,i,u)=>{u.group("").attr("fill",e[t.visual]),u.rect(n,r,o,i),Pv(jv(t.id),o,i,u,{fit:!0,x:n+o/2,y:r+i/2,w:o,h:i}),u.ungroup()},Rv=(t,n,r,e,o,i,u)=>{Fv(n,r,e,o,i,u);[...t.refs.values()].filter((t=>t.sourceId===n.id)).forEach(((t,n)=>Fv(t.target,r-.4*o,e+i*n-4,o/2,i/2,u)))},Dv=(t,n,r)=>{const o=new Map;t.refs.forEach((t=>{!o.has(t.sourceId)&&o.set(t.sourceId,[]),o.get(t.sourceId)?.push(t.target)})),o.forEach(((o,i)=>{const u=t.nodes.get(i);if("actor"!==u.visual){const i=Math.floor(u.x-u.width/2-.2*r.scale),a=Math.floor(u.y+.4*u.height),c=Math.floor(r.scale),f=Math.floor(r.scale/2);o.length>1?"command"===u.visual?((t,n,r,e,o,i,u)=>{const a=Math.floor(i/n.length);n.forEach(((n,i)=>Rv(t,n,r,e+i*(a+2),o,a,u)))})(t,o,i,a,c,f,n):((t,n,r,o,i,u)=>{const a=t.map((t=>`- ${jv(t.id).join(" ")}`));u.group("").attr("fill",e[t[0].visual]).attr("text-align","left").attr("text-anchor","start"),u.rect(n,r,o,i),Pv(a,o,i,u,{fit:!0,x:n+4,y:r+i/2,w:o,h:i}),u.ungroup()})(o,i,a,c,f,n):Rv(t,o[0],i,a,c,f,n)}}))},Bv=(t,n,r)=>{if("nodes"in t){if(t.id){const e=jv(t.id);n.text(e.join(" "),0,0,{fill:Cv,stroke:Cv,dy:-r.fontSize}),n.rect(0,0,t.width,t.height,{rx:25,ry:25})}n.group("",{dx:r.padding,dy:r.padding}),t.id&&n.attr("text-align","center").attr("text-anchor","middle").attr("stroke",Lv).attr("stroke-width",1),t.edges.forEach((t=>t.color&&$v(t,n,r))),t.nodes.forEach((t=>"actor"!==t.visual&&Gv(t,n,r))),Dv(t,n,r),n.ungroup()}},Gv=(t,n,r)=>{const o=Math.floor(t.x-t.width/2),i=Math.floor(t.y-t.height/2),u="context"===t.visual?Bv:(a=t.visual,(t,n,r)=>{n.attr("fill",e[a]),n.rect(0,0,t.width,t.height),Pv(jv(t.id),t.width,t.height,n)});var a;n.group(t.id,{class:t.visual,dx:o,dy:i}),u(t,n,r),n.ungroup()};class Uv extends Error{constructor(t,n,r){super(`Parser error at line ${t.from.line}: Expected ${n} but got ${r}`),this.source=t,this.expected=n,this.actual=r}}const Vv={monospace:"Monospace",inconsolata:"Inconsolata",caveat:"Caveat",handlee:"Handlee"},Hv="inconsolata",qv=(t,e,o=Hv)=>{const i={scale:e,stroke:"#dedede",fill:"white",font:Vv[o.toLowerCase()]||Vv[Hv],fontSize:12,padding:30,margin:40};try{const e=(t=>{const e=new Map,o={ix:0,line:0,line_ix:0},i={ix:0,line:0,line_ix:0},a={ix:0,line:0,line_ix:0},c=()=>({from:{line:i.line,col:i.ix-i.line_ix},to:{line:a.line,col:a.ix-a.line_ix}}),f=(t,n)=>{throw new Uv(c(),t,n.length>30?n.substring(0,40)+"...":n)},s=(t,n)=>{[...r].includes(t)&&f(n,t)},h=["\t"," ","\n"],d=()=>{for(Object.assign(a,o);o.ix<t.length;){let n=t.charAt(o.ix);if("\n"===n)o.line++,o.line_ix=++o.ix;else if(h.includes(n))o.ix++;else{if("#"!==n)break;do{o.ix++,n=t.charAt(o.ix)}while(o.ix<t.length&&"\n"!==n)}}},l=()=>{d();let n="",r="",e="";for(Object.assign(i,o),Object.assign(a,o);o.ix<t.length;)if(e=t.charAt(o.ix),e>="a"&&e<="z"||e>="A"&&e<="Z"||n.length&&e>="0"&&e<="9")n+=e,r+=e,o.ix++;else if([",",...h].includes(e)){if(d(),o.ix<t.length){if(e=t.charAt(o.ix),","!==e)break;n="",r+=e,o.ix++,d()}}else f("identifier",e);return{token:r,source:c()}},v=t=>{const{token:r,source:o}=l();!r&&f("name","nothing"),r.indexOf(",")>0&&f("name","names"),s(r,"name"),!e.has(r)&&e.set(r,{type:t.token,source:t.source,rels:new Map});const i=e.get(r);i.type!==t.token&&f(i.type,t.token),i.source.to=o.to;let a=l();if(n.includes(a.token))return a;const c=u[t.token].grammar;for(;a.token in c;){const t=c[a.token],{token:n,source:r}=l();!n&&f("names","nothing"),n.split(",").forEach((t=>s(t.trim(),"names"))),n.split(",").filter(Boolean).forEach((n=>i?.rels.set(n,t))),i.source.to=r.to,a=l()}return a};let p=l();for(;p.token.length;)n.includes(p.token)?p=v(p):p.token.length&&f("keyword",p.token);return e})(t),o=(t=>{const n=new Map,r=(t,r,e,o)=>{const i=n.get(r);if(i)return i.visual!==e&&c(t,`${r} as ${i.visual}`,e),!i.ctx&&o&&(i.ctx=t.context),i;const u={id:r,visual:e};return o&&(u.ctx=t.context),n.set(r,u),u},e=(e,o)=>{const i=t.get(o);if(i&&"context"!==i.type&&!i.context){i.context=e.id;const n=r(i,o,i.type,!0);i.rels.forEach((({visual:n,owns:e},o)=>{const u=t.get(o);"context"===u?.type&&c(i,"component",o),"artifact"===n?c(i,"valid relationship",n):r(i,o,n,e)})),e.nodes.set(o,n)}else{const t=n.get(o);t&&!t.ctx&&(t.ctx=e.id,e.nodes.set(o,t))}},o=f();t.forEach(((t,n)=>{if("context"===t.type){const r=f(n);t.rels.forEach(((t,n)=>e(r,n))),o.nodes.set(n,r)}}));const i=f("global");return t.forEach(((t,n)=>{"context"===t.type||t.context||e(i,n)})),n.forEach((t=>{t.ctx||(t.ctx=i.id,i.nodes.set(t.id,t))})),i.nodes.size&&o.nodes.set(i.id,i),t.forEach(((t,r)=>{if("context"!==t.type){const e=u[t.type],i=n.get(r),a=o.nodes.get(i.ctx);t.rels.forEach((({visual:t},r)=>{const c=n.get(r),f=o.nodes.get(c.ctx);if(i.ctx!==c.ctx){const t=u.context.rel(i,c);if(t){const n=`${t.sourceId}->${t.targetId}-${t.color||""}`;!o.edges.has(n)&&o.edges.set(n,t)}}const s=e.rel(i,c);s&&("targetId"in s?(a.edges.set(`${s.sourceId}->${s.targetId}`,s),s.targetId===i.id?a.nodes.set(s.sourceId,{...c,id:s.sourceId}):a.nodes.set(s.targetId,c)):("projector"===t?a:f).refs.set(`${s.sourceId}->${s.target.id}`,s))}))}})),o})(e);Mv(o,i);const a=((t,n)=>{const r=new zv({fill:n.fill,"font-family":n.font,"font-size":n.fontSize+"pt","text-align":"left",stroke:n.stroke,"stroke-width":1.5});return Bv(t,r,n),r.serialize()})(o,i);return{svg:a,width:o.width,height:o.height}}catch(t){if(t instanceof Uv)return{error:t};if(t instanceof a)return{error:t};if(t instanceof Error){const n=t.stack.split("\n").slice(0,2).join(" ");return{error:Error(n)}}return{error:Error(t)}}};t.Canvas=class extends kv{constructor(t,n,r){super(),this.document=t,this.container=n,this.SCALE=80,this.WIDTH=100*this.SCALE,this.HEIGHT=100*this.SCALE,this.dragging=!1,this.dx=0,this.dy=0,this.zoom=1,this.x=0,this.y=0,this.w=0,this.h=0,r&&(this.SCALE=r.SCALE,this.WIDTH=r.WIDTH,this.HEIGHT=r.HEIGHT,this.coordsSpan=r.coordsSpan,this.zoomSpan=r.zoomSpan,this.fitBtn=r.fitBtn),this.svg=this.document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.svg.setAttribute("viewBox",`0 0 ${this.WIDTH} ${this.HEIGHT}`),this.svg.setAttribute("width",`${this.WIDTH}`),this.svg.setAttribute("height",`${this.HEIGHT}`),this.container.appendChild(this.svg),this.container.addEventListener("wheel",(t=>{t.preventDefault(),t.metaKey||t.ctrlKey?(this.fitZoom(this.zoom+-.01*t.deltaY),this.transform()):this.transform(t.deltaX,t.deltaY)}));const e=({clientX:t,clientY:n})=>{this.dragging=!0,this.dx=t,this.dy=n,this.container.style.cursor="grabbing"},o=()=>{this.dragging=!1,this.container.style.cursor="default"},i=({clientX:t,clientY:n})=>{this.dragging&&(this.transform(this.dx-t,this.dy-n),this.dx=t,this.dy=n)};this.container.addEventListener("mousedown",e),this.container.addEventListener("mouseup",o),this.container.addEventListener("mousemove",i),this.container.addEventListener("touchstart",(t=>e(t.touches[0]))),this.container.addEventListener("touchend",o),this.container.addEventListener("touchmove",(t=>i(t.touches[0]))),this.fitBtn&&(this.fitBtn.onclick=()=>this.fitToContainer.apply(this))}fitToContainer(){const t=this.container.clientWidth,n=this.container.clientHeight;this.w&&this.h&&t&&n&&(this.fitZoom(Math.min(t/this.w,n/this.h)),this.x=Math.floor((t-this.w*this.zoom)/2),this.y=Math.floor((n-this.h*this.zoom)/2),this.transform())}fitZoom(t){this.zoom=Math.round(100*Math.min(Math.max(.1,t),3))/100}transform(t=0,n=0){const r=this.svg.children[0];r&&(this.x=Math.floor(Math.min(Math.max(this.x-t,0-this.w*this.zoom),this.WIDTH)),this.y=Math.floor(Math.min(Math.max(this.y-n,0-this.h*this.zoom),this.HEIGHT)),this.coordsSpan&&(this.coordsSpan.innerText=`x:${this.x} y:${this.y} w:${this.w} h:${this.h}`),this.zoomSpan&&(this.zoomSpan.innerText=`${Math.floor(100*this.zoom)}%`),r.setAttribute("transform",`translate(${this.x}, ${this.y}) scale(${this.zoom})`),this.emit("transformed",{x:this.x,y:this.y,zoom:this.zoom}))}render(t){const{error:n,svg:r,width:e,height:o}=qv(t.code,this.SCALE,t.font);if(n)return n;this.svg.innerHTML=r,this.w=Math.floor(e),this.h=Math.floor(o),t.zoom&&(this.x=t.x||0,this.y=t.y||0,this.zoom=t.zoom),this.transform()}},t.EventEmitter=kv,t.Keywords=r,t.debounce=(t,n)=>{let r;return function(...e){clearTimeout(r),r=setTimeout((()=>{t.apply(this,e)}),n)}},t.esml=qv}));
